{"version":3,"sources":["animations-browser.umd.js"],"names":["global","factory","exports","module","require","define","amd","ng","animations","browser","core","this","_angular_animations","_angular_core","__extends","d","b","__","constructor","extendStatics","prototype","Object","create","optimizeGroupPlayer","players","length","NoopAnimationPlayer","ɵAnimationGroupPlayer","normalizeKeyframes","driver","normalizer","element","keyframes","preStyles","postStyles","errors","normalizedKeyframes","previousOffset","previousKeyframe","forEach","kf","offset","isSameOffset","normalizedKeyframe","keys","prop","normalizedProp","normalizedValue","normalizePropertyName","ɵPRE_STYLE","AUTO_STYLE","normalizeStyleValue","push","Error","join","listenOnPlayer","player","eventName","event","callback","onStart","copyAnimationEvent","onDone","onDestroy","e","phaseName","totalTime","disabled","makeAnimationEvent","triggerName","fromState","toState","undefined","data","getOrSetAsInMap","map","key","defaultValue","value","Map","get","set","parseTimelineCommand","command","separatorPos","indexOf","substring","substr","containsVendorPrefix","validateStyleProperty","_CACHED_BODY","getBodyNode","_IS_WEBKIT","style","result","charAt","toUpperCase","document","body","resolveTimingValue","matches","match","_convertTimeValueToMS","parseFloat","unit","ONE_SECOND","resolveTiming","timings","allowNegativeValues","hasOwnProperty","parseTimeExpression","exp","duration","regex","delay","easing","delayMatch","Math","floor","easingVal","containsErrors","startIndex","splice","copyObj","obj","destination","normalizeStyles","styles","normalizedStyles","Array","isArray","copyStyles","readPrototype","setStyles","camelProp","dashCaseToCamelCase","eraseStyles","normalizeAnimationEntry","steps","sequence","validateStyleParams","options","params","extractStyleParams","varName","val","toString","PARAM_REGEX","exec","lastIndex","interpolateParams","original","str","replace","_","localVal","iteratorToArray","iterator","arr","item","next","done","input","DASH_CASE_REGEXP","m","_i","arguments","allowPreviousPlayerStylesMerge","balancePreviousStylesIntoKeyframes","previousStyles","previousStyleProps","startingKeyframe_1","missingStyleProps_1","i","computeStyle","visitDslNode","visitor","node","context","type","visitTrigger","visitState","visitTransition","visitSequence","visitGroup","visitAnimate","visitKeyframes","visitStyle","visitReference","visitAnimateChild","visitAnimateRef","visitQuery","visitStagger","window","getComputedStyle","parseTransitionExpr","transitionValue","expressions","split","parseInnerTransitionStr","eventStr","parseAnimationAlias","separator","makeLambdaFromStates","isFullAnyStateExpr","ANY_STATE","alias","lhs","rhs","LHS_MATCH_BOOLEAN","TRUE_BOOLEAN_VALUES","has","FALSE_BOOLEAN_VALUES","RHS_MATCH_BOOLEAN","lhsMatch","rhsMatch","buildAnimationAst","metadata","AnimationAstBuilderVisitor","build","normalizeSelector","selector","hasAmpersand","find","token","SELF_TOKEN","SELF_TOKEN_REGEX","NG_TRIGGER_SELECTOR","NG_ANIMATING_SELECTOR","normalizeParams","consumeOffset","styleTuple","isObject","constructTimingAst","makeTimingAst","strValue","some","v","ast","dynamic","normalizeAnimationOptions","createTimelineInstruction","preStyleProps","postStyleProps","subTimeline","buildAnimationTimelines","rootElement","enterClassName","leaveClassName","startingStyles","finalStyles","subInstructions","AnimationTimelineBuilderVisitor","buildKeyframes","roundOffset","decimalPoints","mult","pow","round","flattenStyles","allStyles","allProperties","createTransitionInstruction","isRemovalTransition","fromStyles","toStyles","timelines","queriedElements","oneOrMoreTransitionsMatch","matchFns","currentState","nextState","fn","buildTrigger","name","AnimationTrigger","createFallbackTransition","states","AnimationTransitionFactory","animation","matchers","queryCount","depCount","balanceProperties","key1","key2","deleteOrUnsetInMap","currentValues","index","delete","normalizeTriggerValue","isElementNode","isTriggerEventValid","cloakElement","oldValue","display","cloakAndComputeStyles","valuesMap","elements","elementPropsMap","defaultStyle","cloakVals","failedElements","props","REMOVAL_FLAG","NULL_REMOVED_QUERIED_STATE","buildRootMap","roots","nodes","getRoot","NULL_NODE","root","localRootMap","parent","parentNode","rootMap","nodeSet","Set","addClass","className","classList","add","classes","CLASSES_CACHE_KEY","removeClass","remove","removeNodesAfterAnimationDone","engine","processLeaveNode","flattenGroupPlayers","finalPlayers","_flattenGroupPlayersRecur","objEquals","a","k1","k2","replacePostStylesAsPre","allPreStyleElements","allPostStyleElements","postEntry","preEntry","playPauseAnimation","status","setAnimationStyle","findIndexForAnimation","applyKeyframeAnimation","anim","getAnimationStyle","trim","countChars","removeKeyframeAnimation","tokens","findMatchingTokenIndex","searchToken","addRemoveAnimationEvent","doRemove","removeEventListener","ANIMATIONEND_EVENT","addEventListener","ANIMATION_PROP","char","count","flattenKeyframesIntoStyles","flatKeyframes","hypenatePropsObject","object","newObj","newProp","removeElement","removeChild","supportsWebAnimations","getElementAnimateFn","Element","setPrototypeOf","__proto__","p","__assign","assign","t","s","n","call","_contains","elm1","elm2","_matches","_query","multi","contains","proto","fn_1","matchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","webkitMatchesSelector","apply","results","querySelectorAll","elm","querySelector","matchesElement","containsElement","invokeQuery","NoopAnimationDriver","query","animate","previousPlayers","scrubberAccessRequested","decorators","Injectable","ctorParameters","AnimationDriver","NOOP","RegExp","SUBSTITUTION_EXPR_START","_driver","AnimationAstBuilderContext","_resetContextStyleTimingState","currentQuerySelector","collectedStyles","currentTime","_this","transitions","definitions","def","stateDef_1","name_1","transition","styleAst","astParams","containsDynamicStyles","missingSubs_1","params_1","stylesObj_1","sub","size","missingSubsArr","values","expr","furthestTime","step","innerAst","max","timingAst","currentAnimateTimings","styleMetadata","styleMetadata_1","isEmpty","newStyleData","_styleAst","isEmptyStep","_makeStyleAst","_validateStyleAst","collectedEasing","styleData","styleMap","endTime","startTime","tuple","collectedEntry","updateCollectedStyle","totalKeyframesWithOffsets","offsets","offsetsOutOfOrder","keyframesOutOfRange","style$$1","offsetVal","generatedOffset","limit","animateDuration","durationUpToThisFrame","parentSelector","currentQuery","_a","includeSelf","optional","originalSelector","currentTransition","ElementInstructionMap","_map","consume","instructions","append","existingInstructions","clear","ENTER_TOKEN_REGEX","LEAVE_TOKEN_REGEX","AnimationTimelineContext","currentTimeline","filter","timeline","containsAnimation","tl","allowOnlyTimelineStyles","elementInstructions","innerContext","createSubContext","_visitSubInstructions","transformIntoNewTimeline","previousNode","instruction","instructionTimings","appendInstructionToTimeline","updateOptions","subContextCount","ctx","snapshotCurrentStyles","DEFAULT_NOOP_PREVIOUS_NODE","delayNextStep","applyStylesToKeyframe","innerTimelines","mergeTimelineCollectedStyles","_visitTiming","incrementTime","getCurrentStyleProperties","forwardFrame","applyEmptyStep","innerTimeline","forwardTime","elms","currentQueryTotal","sameElementTimeline","currentQueryIndex","parentContext","abs","maxTime","currentStaggerTime","startingTime","_enterClassName","_leaveClassName","initialTimeline","TimelineBuilder","defineProperty","enumerable","configurable","skipIfExists","newOptions","optionsToUpdate","newParams","paramsToUpdate_1","_copyOptions","oldParams_1","newTime","target","fork","updatedTimings","builder","SubTimelineBuilder","stretchStartingKeyframe","time","slice","_elementTimelineStylesLookup","_previousKeyframe","_currentKeyframe","_keyframes","_styleSummary","_pendingStyles","_backFill","_currentEmptyStepKeyframe","_localTimelineStyles","_globalTimelineStyles","_loadKeyframe","hasPreStyleStep","_updateStyle","getFinalKeyframe","properties","details0","details1","finalKeyframes","keyframe","finalKeyframe","preProps","postProps","kf0","kf1","_super","_stretchStartingKeyframe","newKeyframes","startingGap","newFirstKeyframe","oldFirstKeyframe","oldOffset","timeAtKeyframe","Animation","errorMessage","_animationAst","buildTimelines","destinationStyles","start","dest","AnimationStyleNormalizer","NoopAnimationStyleNormalizer","propertyName","userProvidedProperty","normalizedProperty","WebAnimationsStyleNormalizer","strVal","DIMENSIONAL_PROP_MAP","valAndSuffixMatch","EMPTY_OBJECT","_triggerName","_stateStyles","buildStyles","stateName","backupStateStyler","stateStyler","backupStyles","currentOptions","nextOptions","transitionAnimationParams","currentAnimationParams","currentStateStyles","nextAnimationParams","nextStateStyles","preStyleMap","postStyleMap","isRemoval","animationOptions","queriedElementsList","AnimationStateStyles","defaultParams","combinedParams","styleObj_1","transitionFactories","fallbackTransition","matchTransition","f","matchStyles","EMPTY_INSTRUCTION_MAP","TimelineAnimationEngine","_normalizer","_animations","_playersById","register","id","_buildPlayer","autoStylesMap","inst","destroy","_getPlayer","listen","baseEvent","args","play","pause","reset","restart","finish","init","setPosition","EMPTY_PLAYER_ARRAY","NULL_REMOVAL_STATE","namespaceId","setForRemoval","hasAnimation","removedBeforeQueried","StateValue","isObj","absorbOptions","DEFAULT_STATE_VALUE","DELETED_STATE_VALUE","AnimationTransitionNamespace","hostElement","_engine","_triggers","_queue","_elementListeners","_hostClassName","phase","listeners","triggersWithStates","statesByElement","NG_TRIGGER_CLASSNAME","afterFlush","_getTrigger","trigger","defaultToFallback","TransitionAnimationPlayer","playersOnElement","playersByElement","queued","isFallbackTransition","totalQueuedPlayers","index_1","fromStyles_1","toStyles_1","reportError","deregister","stateMap","entry","clearElementCache","elementPlayers","_signalRemovalForInnerTriggers","namespaces","fetchNamespacesByElement","ns","triggerLeaveAnimation","destroyAfterComplete","triggerStates","players_1","markElementAsRemoved","prepareLeaveAnimationListeners","visitedTriggers_1","listener","elementStates","removeNode","childElementCount","containsPotentialParentTransition","totalAnimations","currentPlayers","playersByQueriedElement","parent_1","triggers","destroyInnerAnimations","_onRemovalComplete","insertNode","drainQueuedTransitions","microtaskId","destroyed","markedForDestroy","sort","d0","d1","elementContainsData","containsData","TransitionAnimationEngine","newHostElements","disabledNodes","_namespaceLookup","_namespaceList","_flushFns","_whenQuietFns","namespacesByHostElement","collectedEnterElements","collectedLeaveElements","onRemovalComplete","createNamespace","_balanceNamespaceList","collectEnterElement","found","nextNamespace","registerTrigger","_fetchNamespace","afterFlushAnimationsDone","nsId","insertBefore","details","markElementAsDisabled","_buildInstruction","subTimelines","containerElement","destroyActiveAnimationsForElement","finishActiveQueriedAnimationOnElement","whenRenderingDone","Promise","resolve","flush","cleanupFns","_flushAnimations","quietFns_1","skippedPlayers","skippedPlayersMap","queuedInstructions","disabledElementsSet","nodesThatAreDisabled","i_1","bodyNode","allTriggerElements","from","enterNodeMap","enterNodeMapIds","allLeaveNodes","mergedLeaveNodes","leaveNodesWithoutAnimations","i_2","leaveNodeMapIds","leaveNodeMap","allPlayers","erroneousTransitions","i_3","stringMap","setVal_1","setVal","errors_1","error","allPreviousPlayersMap","animationElementMap","_beforeAnimationBuild","_getPreviousPlayers","prevPlayer","replaceNodes","postStylesMap","preStylesMap","post","pre","rootPlayers","subPlayers","NO_PARENT_ANIMATION_ELEMENT_DETECTED","overrideTotalTime","parentWithAnimation_1","parentsToAdd","detectedParent","innerPlayer","_buildAnimation","setRealPlayer","parentPlayers","parentPlayer","playersForElement","syncPlayerEvents","i_4","queriedPlayerResults","queriedInnerElements","j","queriedPlayers","activePlayers","isQueriedElement","toStateValue","queriedElementPlayers","isRemovalAnimation_1","targetNameSpaceId","targetTriggerName","this_1","timelineInstruction","realPlayer","getRealPlayer","beforeDestroy","allQueriedPlayers","allConsumedElements","allSubElements","allNewPlayers","pp","wrappedPlayer","_player","_containsRealPlayer","_queuedCallbacks","triggerCallback","_queueEvent","hasStarted","getPosition","AnimationEngine","_triggerCache","_transitionEngine","_timelineEngine","componentId","cacheKey","onInsert","onRemove","disableAnimations","disable","process","property","action","eventPhase","concat","ElementAnimationStyleHandler","_element","_name","_duration","_delay","_easing","_fillMode","_onDoneFn","_finished","_destroyed","_startTime","_position","_eventFn","_handleCallback","Date","now","resume","position","timestamp","_ngTestManualTimestamp","elapsedTime","toFixed","animationName","DEFAULT_EASING","AnimatorControlState","INITIALIZED","STARTED","FINISHED","DESTROYED","CssKeyframesPlayer","_finalStyles","_onDoneFns","_onStartFns","_onDestroyFns","_started","currentSnapshot","state","_buildStyler","_styler","_flushStartFns","_flushDoneFns","methods","finished_1","DirectStylePlayer","_styles","_startingStyles","__initialized","removeProperty","CssKeyframesDriver","_count","_head","_warningIssued","buildKeyframeElement","keyframeStr","tab","kfElm","createElement","innerHTML","_notifyFaultyScrubber","previousCssKeyframePlayers","appendChild","console","warn","WebAnimationsPlayer","_initialized","_onFinish","_preparePlayerBeforeStart","domPlayer","_triggerWebAnimation","_finalKeyframe","_resetDomPlayerState","cancel","WebAnimationsDriver","_isNativeImpl","test","_cssKeyframesDriver","overrideWebAnimationsSupport","supported","fill","playerOptions","previousWebAnimationPlayers","ɵAnimation","ɵAnimationStyleNormalizer","ɵNoopAnimationStyleNormalizer","ɵWebAnimationsStyleNormalizer","ɵAnimationDriver","ɵNoopAnimationDriver","ɵAnimationEngine","ɵCssKeyframesDriver","ɵCssKeyframesPlayer","ɵcontainsElement","ɵinvokeQuery","ɵmatchesElement","ɵvalidateStyleProperty","ɵWebAnimationsDriver","ɵsupportsWebAnimations","ɵWebAnimationsPlayer","ɵallowPreviousPlayerStylesMerge"],"mappings":"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","file":"animations-browser.umd.min.js","sourcesContent":["/**\n * @license Angular v6.0.0-beta.7-b5be18f\n * (c) 2010-2018 Google, Inc. https://angular.io/\n * License: MIT\n */\n(function (global, factory) {\n\ttypeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/animations'), require('@angular/core')) :\n\ttypeof define === 'function' && define.amd ? define('@angular/animations/browser', ['exports', '@angular/animations', '@angular/core'], factory) :\n\t(factory((global.ng = global.ng || {}, global.ng.animations = global.ng.animations || {}, global.ng.animations.browser = {}),global.ng.animations,global.ng.core));\n}(this, (function (exports,_angular_animations,_angular_core) { 'use strict';\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = Object.setPrototypeOf ||\r\n    ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n    function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = Object.assign || function __assign(t) {\r\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n        s = arguments[i];\r\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n    }\r\n    return t;\r\n};\n\n/**\n * @license Angular v6.0.0-beta.7-b5be18f\n * (c) 2010-2018 Google, Inc. https://angular.io/\n * License: MIT\n */\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @param {?} players\n * @return {?}\n */\nfunction optimizeGroupPlayer(players) {\n    switch (players.length) {\n        case 0:\n            return new _angular_animations.NoopAnimationPlayer();\n        case 1:\n            return players[0];\n        default:\n            return new _angular_animations.ɵAnimationGroupPlayer(players);\n    }\n}\n/**\n * @param {?} driver\n * @param {?} normalizer\n * @param {?} element\n * @param {?} keyframes\n * @param {?=} preStyles\n * @param {?=} postStyles\n * @return {?}\n */\nfunction normalizeKeyframes(driver, normalizer, element, keyframes, preStyles, postStyles) {\n    if (preStyles === void 0) { preStyles = {}; }\n    if (postStyles === void 0) { postStyles = {}; }\n    var /** @type {?} */ errors = [];\n    var /** @type {?} */ normalizedKeyframes = [];\n    var /** @type {?} */ previousOffset = -1;\n    var /** @type {?} */ previousKeyframe = null;\n    keyframes.forEach(function (kf) {\n        var /** @type {?} */ offset = /** @type {?} */ (kf['offset']);\n        var /** @type {?} */ isSameOffset = offset == previousOffset;\n        var /** @type {?} */ normalizedKeyframe = (isSameOffset && previousKeyframe) || {};\n        Object.keys(kf).forEach(function (prop) {\n            var /** @type {?} */ normalizedProp = prop;\n            var /** @type {?} */ normalizedValue = kf[prop];\n            if (prop !== 'offset') {\n                normalizedProp = normalizer.normalizePropertyName(normalizedProp, errors);\n                switch (normalizedValue) {\n                    case _angular_animations.ɵPRE_STYLE:\n                        normalizedValue = preStyles[prop];\n                        break;\n                    case _angular_animations.AUTO_STYLE:\n                        normalizedValue = postStyles[prop];\n                        break;\n                    default:\n                        normalizedValue =\n                            normalizer.normalizeStyleValue(prop, normalizedProp, normalizedValue, errors);\n                        break;\n                }\n            }\n            normalizedKeyframe[normalizedProp] = normalizedValue;\n        });\n        if (!isSameOffset) {\n            normalizedKeyframes.push(normalizedKeyframe);\n        }\n        previousKeyframe = normalizedKeyframe;\n        previousOffset = offset;\n    });\n    if (errors.length) {\n        var /** @type {?} */ LINE_START = '\\n - ';\n        throw new Error(\"Unable to animate due to the following errors:\" + LINE_START + errors.join(LINE_START));\n    }\n    return normalizedKeyframes;\n}\n/**\n * @param {?} player\n * @param {?} eventName\n * @param {?} event\n * @param {?} callback\n * @return {?}\n */\nfunction listenOnPlayer(player, eventName, event, callback) {\n    switch (eventName) {\n        case 'start':\n            player.onStart(function () { return callback(event && copyAnimationEvent(event, 'start', player)); });\n            break;\n        case 'done':\n            player.onDone(function () { return callback(event && copyAnimationEvent(event, 'done', player)); });\n            break;\n        case 'destroy':\n            player.onDestroy(function () { return callback(event && copyAnimationEvent(event, 'destroy', player)); });\n            break;\n    }\n}\n/**\n * @param {?} e\n * @param {?} phaseName\n * @param {?} player\n * @return {?}\n */\nfunction copyAnimationEvent(e, phaseName, player) {\n    var /** @type {?} */ totalTime = player.totalTime;\n    var /** @type {?} */ disabled = (/** @type {?} */ (player)).disabled ? true : false;\n    var /** @type {?} */ event = makeAnimationEvent(e.element, e.triggerName, e.fromState, e.toState, phaseName || e.phaseName, totalTime == undefined ? e.totalTime : totalTime, disabled);\n    var /** @type {?} */ data = (/** @type {?} */ (e))['_data'];\n    if (data != null) {\n        (/** @type {?} */ (event))['_data'] = data;\n    }\n    return event;\n}\n/**\n * @param {?} element\n * @param {?} triggerName\n * @param {?} fromState\n * @param {?} toState\n * @param {?=} phaseName\n * @param {?=} totalTime\n * @param {?=} disabled\n * @return {?}\n */\nfunction makeAnimationEvent(element, triggerName, fromState, toState, phaseName, totalTime, disabled) {\n    if (phaseName === void 0) { phaseName = ''; }\n    if (totalTime === void 0) { totalTime = 0; }\n    return { element: element, triggerName: triggerName, fromState: fromState, toState: toState, phaseName: phaseName, totalTime: totalTime, disabled: !!disabled };\n}\n/**\n * @param {?} map\n * @param {?} key\n * @param {?} defaultValue\n * @return {?}\n */\nfunction getOrSetAsInMap(map, key, defaultValue) {\n    var /** @type {?} */ value;\n    if (map instanceof Map) {\n        value = map.get(key);\n        if (!value) {\n            map.set(key, value = defaultValue);\n        }\n    }\n    else {\n        value = map[key];\n        if (!value) {\n            value = map[key] = defaultValue;\n        }\n    }\n    return value;\n}\n/**\n * @param {?} command\n * @return {?}\n */\nfunction parseTimelineCommand(command) {\n    var /** @type {?} */ separatorPos = command.indexOf(':');\n    var /** @type {?} */ id = command.substring(1, separatorPos);\n    var /** @type {?} */ action = command.substr(separatorPos + 1);\n    return [id, action];\n}\nvar _contains = function (elm1, elm2) { return false; };\nvar _matches = function (element, selector) {\n    return false;\n};\nvar _query = function (element, selector, multi) {\n    return [];\n};\nif (typeof Element != 'undefined') {\n    // this is well supported in all browsers\n    _contains = function (elm1, elm2) { return /** @type {?} */ (elm1.contains(elm2)); };\n    if (Element.prototype.matches) {\n        _matches = function (element, selector) { return element.matches(selector); };\n    }\n    else {\n        var /** @type {?} */ proto = /** @type {?} */ (Element.prototype);\n        var /** @type {?} */ fn_1 = proto.matchesSelector || proto.mozMatchesSelector || proto.msMatchesSelector ||\n            proto.oMatchesSelector || proto.webkitMatchesSelector;\n        if (fn_1) {\n            _matches = function (element, selector) { return fn_1.apply(element, [selector]); };\n        }\n    }\n    _query = function (element, selector, multi) {\n        var /** @type {?} */ results = [];\n        if (multi) {\n            results.push.apply(results, element.querySelectorAll(selector));\n        }\n        else {\n            var /** @type {?} */ elm = element.querySelector(selector);\n            if (elm) {\n                results.push(elm);\n            }\n        }\n        return results;\n    };\n}\n/**\n * @param {?} prop\n * @return {?}\n */\nfunction containsVendorPrefix(prop) {\n    // Webkit is the only real popular vendor prefix nowadays\n    // cc: http://shouldiprefix.com/\n    return prop.substring(1, 6) == 'ebkit'; // webkit or Webkit\n}\nvar _CACHED_BODY = null;\nvar _IS_WEBKIT = false;\n/**\n * @param {?} prop\n * @return {?}\n */\nfunction validateStyleProperty(prop) {\n    if (!_CACHED_BODY) {\n        _CACHED_BODY = getBodyNode() || {};\n        _IS_WEBKIT = /** @type {?} */ ((_CACHED_BODY)).style ? ('WebkitAppearance' in /** @type {?} */ ((_CACHED_BODY)).style) : false;\n    }\n    var /** @type {?} */ result = true;\n    if (/** @type {?} */ ((_CACHED_BODY)).style && !containsVendorPrefix(prop)) {\n        result = prop in /** @type {?} */ ((_CACHED_BODY)).style;\n        if (!result && _IS_WEBKIT) {\n            var /** @type {?} */ camelProp = 'Webkit' + prop.charAt(0).toUpperCase() + prop.substr(1);\n            result = camelProp in /** @type {?} */ ((_CACHED_BODY)).style;\n        }\n    }\n    return result;\n}\n/**\n * @return {?}\n */\nfunction getBodyNode() {\n    if (typeof document != 'undefined') {\n        return document.body;\n    }\n    return null;\n}\nvar matchesElement = _matches;\nvar containsElement = _contains;\nvar invokeQuery = _query;\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * \\@experimental\n */\nvar NoopAnimationDriver = /** @class */ (function () {\n    function NoopAnimationDriver() {\n    }\n    /**\n     * @param {?} prop\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.validateStyleProperty = /**\n     * @param {?} prop\n     * @return {?}\n     */\n    function (prop) { return validateStyleProperty(prop); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.matchesElement = /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    function (element, selector) {\n        return matchesElement(element, selector);\n    };\n    /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.containsElement = /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    function (elm1, elm2) { return containsElement(elm1, elm2); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.query = /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    function (element, selector, multi) {\n        return invokeQuery(element, selector, multi);\n    };\n    /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.computeStyle = /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    function (element, prop, defaultValue) {\n        return defaultValue || '';\n    };\n    /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @param {?=} scrubberAccessRequested\n     * @return {?}\n     */\n    NoopAnimationDriver.prototype.animate = /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @param {?=} scrubberAccessRequested\n     * @return {?}\n     */\n    function (element, keyframes, duration, delay, easing, previousPlayers, scrubberAccessRequested) {\n        if (previousPlayers === void 0) { previousPlayers = []; }\n        return new _angular_animations.NoopAnimationPlayer(duration, delay);\n    };\n    NoopAnimationDriver.decorators = [\n        { type: _angular_core.Injectable },\n    ];\n    /** @nocollapse */\n    NoopAnimationDriver.ctorParameters = function () { return []; };\n    return NoopAnimationDriver;\n}());\n/**\n * \\@experimental\n * @abstract\n */\nvar AnimationDriver = /** @class */ (function () {\n    function AnimationDriver() {\n    }\n    AnimationDriver.NOOP = new NoopAnimationDriver();\n    return AnimationDriver;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar ONE_SECOND = 1000;\nvar SUBSTITUTION_EXPR_START = '{{';\nvar SUBSTITUTION_EXPR_END = '}}';\nvar ENTER_CLASSNAME = 'ng-enter';\nvar LEAVE_CLASSNAME = 'ng-leave';\n\n\nvar NG_TRIGGER_CLASSNAME = 'ng-trigger';\nvar NG_TRIGGER_SELECTOR = '.ng-trigger';\nvar NG_ANIMATING_CLASSNAME = 'ng-animating';\nvar NG_ANIMATING_SELECTOR = '.ng-animating';\n/**\n * @param {?} value\n * @return {?}\n */\nfunction resolveTimingValue(value) {\n    if (typeof value == 'number')\n        return value;\n    var /** @type {?} */ matches = (/** @type {?} */ (value)).match(/^(-?[\\.\\d]+)(m?s)/);\n    if (!matches || matches.length < 2)\n        return 0;\n    return _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);\n}\n/**\n * @param {?} value\n * @param {?} unit\n * @return {?}\n */\nfunction _convertTimeValueToMS(value, unit) {\n    switch (unit) {\n        case 's':\n            return value * ONE_SECOND;\n        default:\n            // ms or something else\n            return value;\n    }\n}\n/**\n * @param {?} timings\n * @param {?} errors\n * @param {?=} allowNegativeValues\n * @return {?}\n */\nfunction resolveTiming(timings, errors, allowNegativeValues) {\n    return timings.hasOwnProperty('duration') ? /** @type {?} */ (timings) :\n        parseTimeExpression(/** @type {?} */ (timings), errors, allowNegativeValues);\n}\n/**\n * @param {?} exp\n * @param {?} errors\n * @param {?=} allowNegativeValues\n * @return {?}\n */\nfunction parseTimeExpression(exp, errors, allowNegativeValues) {\n    var /** @type {?} */ regex = /^(-?[\\.\\d]+)(m?s)(?:\\s+(-?[\\.\\d]+)(m?s))?(?:\\s+([-a-z]+(?:\\(.+?\\))?))?$/i;\n    var /** @type {?} */ duration;\n    var /** @type {?} */ delay = 0;\n    var /** @type {?} */ easing = '';\n    if (typeof exp === 'string') {\n        var /** @type {?} */ matches = exp.match(regex);\n        if (matches === null) {\n            errors.push(\"The provided timing value \\\"\" + exp + \"\\\" is invalid.\");\n            return { duration: 0, delay: 0, easing: '' };\n        }\n        duration = _convertTimeValueToMS(parseFloat(matches[1]), matches[2]);\n        var /** @type {?} */ delayMatch = matches[3];\n        if (delayMatch != null) {\n            delay = _convertTimeValueToMS(Math.floor(parseFloat(delayMatch)), matches[4]);\n        }\n        var /** @type {?} */ easingVal = matches[5];\n        if (easingVal) {\n            easing = easingVal;\n        }\n    }\n    else {\n        duration = /** @type {?} */ (exp);\n    }\n    if (!allowNegativeValues) {\n        var /** @type {?} */ containsErrors = false;\n        var /** @type {?} */ startIndex = errors.length;\n        if (duration < 0) {\n            errors.push(\"Duration values below 0 are not allowed for this animation step.\");\n            containsErrors = true;\n        }\n        if (delay < 0) {\n            errors.push(\"Delay values below 0 are not allowed for this animation step.\");\n            containsErrors = true;\n        }\n        if (containsErrors) {\n            errors.splice(startIndex, 0, \"The provided timing value \\\"\" + exp + \"\\\" is invalid.\");\n        }\n    }\n    return { duration: duration, delay: delay, easing: easing };\n}\n/**\n * @param {?} obj\n * @param {?=} destination\n * @return {?}\n */\nfunction copyObj(obj, destination) {\n    if (destination === void 0) { destination = {}; }\n    Object.keys(obj).forEach(function (prop) { destination[prop] = obj[prop]; });\n    return destination;\n}\n/**\n * @param {?} styles\n * @return {?}\n */\nfunction normalizeStyles(styles) {\n    var /** @type {?} */ normalizedStyles = {};\n    if (Array.isArray(styles)) {\n        styles.forEach(function (data) { return copyStyles(data, false, normalizedStyles); });\n    }\n    else {\n        copyStyles(styles, false, normalizedStyles);\n    }\n    return normalizedStyles;\n}\n/**\n * @param {?} styles\n * @param {?} readPrototype\n * @param {?=} destination\n * @return {?}\n */\nfunction copyStyles(styles, readPrototype, destination) {\n    if (destination === void 0) { destination = {}; }\n    if (readPrototype) {\n        // we make use of a for-in loop so that the\n        // prototypically inherited properties are\n        // revealed from the backFill map\n        for (var /** @type {?} */ prop in styles) {\n            destination[prop] = styles[prop];\n        }\n    }\n    else {\n        copyObj(styles, destination);\n    }\n    return destination;\n}\n/**\n * @param {?} element\n * @param {?} styles\n * @return {?}\n */\nfunction setStyles(element, styles) {\n    if (element['style']) {\n        Object.keys(styles).forEach(function (prop) {\n            var /** @type {?} */ camelProp = dashCaseToCamelCase(prop);\n            element.style[camelProp] = styles[prop];\n        });\n    }\n}\n/**\n * @param {?} element\n * @param {?} styles\n * @return {?}\n */\nfunction eraseStyles(element, styles) {\n    if (element['style']) {\n        Object.keys(styles).forEach(function (prop) {\n            var /** @type {?} */ camelProp = dashCaseToCamelCase(prop);\n            element.style[camelProp] = '';\n        });\n    }\n}\n/**\n * @param {?} steps\n * @return {?}\n */\nfunction normalizeAnimationEntry(steps) {\n    if (Array.isArray(steps)) {\n        if (steps.length == 1)\n            return steps[0];\n        return _angular_animations.sequence(steps);\n    }\n    return /** @type {?} */ (steps);\n}\n/**\n * @param {?} value\n * @param {?} options\n * @param {?} errors\n * @return {?}\n */\nfunction validateStyleParams(value, options, errors) {\n    var /** @type {?} */ params = options.params || {};\n    var /** @type {?} */ matches = extractStyleParams(value);\n    if (matches.length) {\n        matches.forEach(function (varName) {\n            if (!params.hasOwnProperty(varName)) {\n                errors.push(\"Unable to resolve the local animation param \" + varName + \" in the given list of values\");\n            }\n        });\n    }\n}\nvar PARAM_REGEX = new RegExp(SUBSTITUTION_EXPR_START + \"\\\\s*(.+?)\\\\s*\" + SUBSTITUTION_EXPR_END, 'g');\n/**\n * @param {?} value\n * @return {?}\n */\nfunction extractStyleParams(value) {\n    var /** @type {?} */ params = [];\n    if (typeof value === 'string') {\n        var /** @type {?} */ val = value.toString();\n        var /** @type {?} */ match = void 0;\n        while (match = PARAM_REGEX.exec(val)) {\n            params.push(/** @type {?} */ (match[1]));\n        }\n        PARAM_REGEX.lastIndex = 0;\n    }\n    return params;\n}\n/**\n * @param {?} value\n * @param {?} params\n * @param {?} errors\n * @return {?}\n */\nfunction interpolateParams(value, params, errors) {\n    var /** @type {?} */ original = value.toString();\n    var /** @type {?} */ str = original.replace(PARAM_REGEX, function (_, varName) {\n        var /** @type {?} */ localVal = params[varName];\n        // this means that the value was never overidden by the data passed in by the user\n        if (!params.hasOwnProperty(varName)) {\n            errors.push(\"Please provide a value for the animation param \" + varName);\n            localVal = '';\n        }\n        return localVal.toString();\n    });\n    // we do this to assert that numeric values stay as they are\n    return str == original ? value : str;\n}\n/**\n * @param {?} iterator\n * @return {?}\n */\nfunction iteratorToArray(iterator) {\n    var /** @type {?} */ arr = [];\n    var /** @type {?} */ item = iterator.next();\n    while (!item.done) {\n        arr.push(item.value);\n        item = iterator.next();\n    }\n    return arr;\n}\n/**\n * @param {?} source\n * @param {?} destination\n * @return {?}\n */\n\nvar DASH_CASE_REGEXP = /-+([a-z0-9])/g;\n/**\n * @param {?} input\n * @return {?}\n */\nfunction dashCaseToCamelCase(input) {\n    return input.replace(DASH_CASE_REGEXP, function () {\n        var m = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            m[_i] = arguments[_i];\n        }\n        return m[1].toUpperCase();\n    });\n}\n/**\n * @param {?} duration\n * @param {?} delay\n * @return {?}\n */\nfunction allowPreviousPlayerStylesMerge(duration, delay) {\n    return duration === 0 || delay === 0;\n}\n/**\n * @param {?} element\n * @param {?} keyframes\n * @param {?} previousStyles\n * @return {?}\n */\nfunction balancePreviousStylesIntoKeyframes(element, keyframes, previousStyles) {\n    var /** @type {?} */ previousStyleProps = Object.keys(previousStyles);\n    if (previousStyleProps.length && keyframes.length) {\n        var /** @type {?} */ startingKeyframe_1 = keyframes[0];\n        var /** @type {?} */ missingStyleProps_1 = [];\n        previousStyleProps.forEach(function (prop) {\n            if (!startingKeyframe_1.hasOwnProperty(prop)) {\n                missingStyleProps_1.push(prop);\n            }\n            startingKeyframe_1[prop] = previousStyles[prop];\n        });\n        if (missingStyleProps_1.length) {\n            var _loop_1 = function () {\n                var /** @type {?} */ kf = keyframes[i];\n                missingStyleProps_1.forEach(function (prop) { kf[prop] = computeStyle(element, prop); });\n            };\n            // tslint:disable-next-line\n            for (var /** @type {?} */ i = 1; i < keyframes.length; i++) {\n                _loop_1();\n            }\n        }\n    }\n    return keyframes;\n}\n/**\n * @param {?} visitor\n * @param {?} node\n * @param {?} context\n * @return {?}\n */\nfunction visitDslNode(visitor, node, context) {\n    switch (node.type) {\n        case 7 /* Trigger */:\n            return visitor.visitTrigger(node, context);\n        case 0 /* State */:\n            return visitor.visitState(node, context);\n        case 1 /* Transition */:\n            return visitor.visitTransition(node, context);\n        case 2 /* Sequence */:\n            return visitor.visitSequence(node, context);\n        case 3 /* Group */:\n            return visitor.visitGroup(node, context);\n        case 4 /* Animate */:\n            return visitor.visitAnimate(node, context);\n        case 5 /* Keyframes */:\n            return visitor.visitKeyframes(node, context);\n        case 6 /* Style */:\n            return visitor.visitStyle(node, context);\n        case 8 /* Reference */:\n            return visitor.visitReference(node, context);\n        case 9 /* AnimateChild */:\n            return visitor.visitAnimateChild(node, context);\n        case 10 /* AnimateRef */:\n            return visitor.visitAnimateRef(node, context);\n        case 11 /* Query */:\n            return visitor.visitQuery(node, context);\n        case 12 /* Stagger */:\n            return visitor.visitStagger(node, context);\n        default:\n            throw new Error(\"Unable to resolve animation metadata node #\" + node.type);\n    }\n}\n/**\n * @param {?} element\n * @param {?} prop\n * @return {?}\n */\nfunction computeStyle(element, prop) {\n    return (/** @type {?} */ (window.getComputedStyle(element)))[prop];\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar ANY_STATE = '*';\n/**\n * @param {?} transitionValue\n * @param {?} errors\n * @return {?}\n */\nfunction parseTransitionExpr(transitionValue, errors) {\n    var /** @type {?} */ expressions = [];\n    if (typeof transitionValue == 'string') {\n        (/** @type {?} */ (transitionValue))\n            .split(/\\s*,\\s*/)\n            .forEach(function (str) { return parseInnerTransitionStr(str, expressions, errors); });\n    }\n    else {\n        expressions.push(/** @type {?} */ (transitionValue));\n    }\n    return expressions;\n}\n/**\n * @param {?} eventStr\n * @param {?} expressions\n * @param {?} errors\n * @return {?}\n */\nfunction parseInnerTransitionStr(eventStr, expressions, errors) {\n    if (eventStr[0] == ':') {\n        var /** @type {?} */ result = parseAnimationAlias(eventStr, errors);\n        if (typeof result == 'function') {\n            expressions.push(result);\n            return;\n        }\n        eventStr = /** @type {?} */ (result);\n    }\n    var /** @type {?} */ match = eventStr.match(/^(\\*|[-\\w]+)\\s*(<?[=-]>)\\s*(\\*|[-\\w]+)$/);\n    if (match == null || match.length < 4) {\n        errors.push(\"The provided transition expression \\\"\" + eventStr + \"\\\" is not supported\");\n        return expressions;\n    }\n    var /** @type {?} */ fromState = match[1];\n    var /** @type {?} */ separator = match[2];\n    var /** @type {?} */ toState = match[3];\n    expressions.push(makeLambdaFromStates(fromState, toState));\n    var /** @type {?} */ isFullAnyStateExpr = fromState == ANY_STATE && toState == ANY_STATE;\n    if (separator[0] == '<' && !isFullAnyStateExpr) {\n        expressions.push(makeLambdaFromStates(toState, fromState));\n    }\n}\n/**\n * @param {?} alias\n * @param {?} errors\n * @return {?}\n */\nfunction parseAnimationAlias(alias, errors) {\n    switch (alias) {\n        case ':enter':\n            return 'void => *';\n        case ':leave':\n            return '* => void';\n        case ':increment':\n            return function (fromState, toState) { return parseFloat(toState) > parseFloat(fromState); };\n        case ':decrement':\n            return function (fromState, toState) { return parseFloat(toState) < parseFloat(fromState); };\n        default:\n            errors.push(\"The transition alias value \\\"\" + alias + \"\\\" is not supported\");\n            return '* => *';\n    }\n}\n// DO NOT REFACTOR ... keep the follow set instantiations\n// with the values intact (closure compiler for some reason\n// removes follow-up lines that add the values outside of\n// the constructor...\nvar TRUE_BOOLEAN_VALUES = new Set(['true', '1']);\nvar FALSE_BOOLEAN_VALUES = new Set(['false', '0']);\n/**\n * @param {?} lhs\n * @param {?} rhs\n * @return {?}\n */\nfunction makeLambdaFromStates(lhs, rhs) {\n    var /** @type {?} */ LHS_MATCH_BOOLEAN = TRUE_BOOLEAN_VALUES.has(lhs) || FALSE_BOOLEAN_VALUES.has(lhs);\n    var /** @type {?} */ RHS_MATCH_BOOLEAN = TRUE_BOOLEAN_VALUES.has(rhs) || FALSE_BOOLEAN_VALUES.has(rhs);\n    return function (fromState, toState) {\n        var /** @type {?} */ lhsMatch = lhs == ANY_STATE || lhs == fromState;\n        var /** @type {?} */ rhsMatch = rhs == ANY_STATE || rhs == toState;\n        if (!lhsMatch && LHS_MATCH_BOOLEAN && typeof fromState === 'boolean') {\n            lhsMatch = fromState ? TRUE_BOOLEAN_VALUES.has(lhs) : FALSE_BOOLEAN_VALUES.has(lhs);\n        }\n        if (!rhsMatch && RHS_MATCH_BOOLEAN && typeof toState === 'boolean') {\n            rhsMatch = toState ? TRUE_BOOLEAN_VALUES.has(rhs) : FALSE_BOOLEAN_VALUES.has(rhs);\n        }\n        return lhsMatch && rhsMatch;\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar SELF_TOKEN = ':self';\nvar SELF_TOKEN_REGEX = new RegExp(\"s*\" + SELF_TOKEN + \"s*,?\", 'g');\n/**\n * @param {?} driver\n * @param {?} metadata\n * @param {?} errors\n * @return {?}\n */\nfunction buildAnimationAst(driver, metadata, errors) {\n    return new AnimationAstBuilderVisitor(driver).build(metadata, errors);\n}\nvar ROOT_SELECTOR = '';\nvar AnimationAstBuilderVisitor = /** @class */ (function () {\n    function AnimationAstBuilderVisitor(_driver) {\n        this._driver = _driver;\n    }\n    /**\n     * @param {?} metadata\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.build = /**\n     * @param {?} metadata\n     * @param {?} errors\n     * @return {?}\n     */\n    function (metadata, errors) {\n        var /** @type {?} */ context = new AnimationAstBuilderContext(errors);\n        this._resetContextStyleTimingState(context);\n        return /** @type {?} */ (visitDslNode(this, normalizeAnimationEntry(metadata), context));\n    };\n    /**\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype._resetContextStyleTimingState = /**\n     * @param {?} context\n     * @return {?}\n     */\n    function (context) {\n        context.currentQuerySelector = ROOT_SELECTOR;\n        context.collectedStyles = {};\n        context.collectedStyles[ROOT_SELECTOR] = {};\n        context.currentTime = 0;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitTrigger = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var _this = this;\n        var /** @type {?} */ queryCount = context.queryCount = 0;\n        var /** @type {?} */ depCount = context.depCount = 0;\n        var /** @type {?} */ states = [];\n        var /** @type {?} */ transitions = [];\n        if (metadata.name.charAt(0) == '@') {\n            context.errors.push('animation triggers cannot be prefixed with an `@` sign (e.g. trigger(\\'@foo\\', [...]))');\n        }\n        metadata.definitions.forEach(function (def) {\n            _this._resetContextStyleTimingState(context);\n            if (def.type == 0 /* State */) {\n                var /** @type {?} */ stateDef_1 = /** @type {?} */ (def);\n                var /** @type {?} */ name_1 = stateDef_1.name;\n                name_1.split(/\\s*,\\s*/).forEach(function (n) {\n                    stateDef_1.name = n;\n                    states.push(_this.visitState(stateDef_1, context));\n                });\n                stateDef_1.name = name_1;\n            }\n            else if (def.type == 1 /* Transition */) {\n                var /** @type {?} */ transition = _this.visitTransition(/** @type {?} */ (def), context);\n                queryCount += transition.queryCount;\n                depCount += transition.depCount;\n                transitions.push(transition);\n            }\n            else {\n                context.errors.push('only state() and transition() definitions can sit inside of a trigger()');\n            }\n        });\n        return {\n            type: 7 /* Trigger */,\n            name: metadata.name, states: states, transitions: transitions, queryCount: queryCount, depCount: depCount,\n            options: null\n        };\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitState = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ styleAst = this.visitStyle(metadata.styles, context);\n        var /** @type {?} */ astParams = (metadata.options && metadata.options.params) || null;\n        if (styleAst.containsDynamicStyles) {\n            var /** @type {?} */ missingSubs_1 = new Set();\n            var /** @type {?} */ params_1 = astParams || {};\n            styleAst.styles.forEach(function (value) {\n                if (isObject(value)) {\n                    var /** @type {?} */ stylesObj_1 = /** @type {?} */ (value);\n                    Object.keys(stylesObj_1).forEach(function (prop) {\n                        extractStyleParams(stylesObj_1[prop]).forEach(function (sub) {\n                            if (!params_1.hasOwnProperty(sub)) {\n                                missingSubs_1.add(sub);\n                            }\n                        });\n                    });\n                }\n            });\n            if (missingSubs_1.size) {\n                var /** @type {?} */ missingSubsArr = iteratorToArray(missingSubs_1.values());\n                context.errors.push(\"state(\\\"\" + metadata.name + \"\\\", ...) must define default values for all the following style substitutions: \" + missingSubsArr.join(', '));\n            }\n        }\n        return {\n            type: 0 /* State */,\n            name: metadata.name,\n            style: styleAst,\n            options: astParams ? { params: astParams } : null\n        };\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitTransition = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        context.queryCount = 0;\n        context.depCount = 0;\n        var /** @type {?} */ animation = visitDslNode(this, normalizeAnimationEntry(metadata.animation), context);\n        var /** @type {?} */ matchers = parseTransitionExpr(metadata.expr, context.errors);\n        return {\n            type: 1 /* Transition */,\n            matchers: matchers,\n            animation: animation,\n            queryCount: context.queryCount,\n            depCount: context.depCount,\n            options: normalizeAnimationOptions(metadata.options)\n        };\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitSequence = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var _this = this;\n        return {\n            type: 2 /* Sequence */,\n            steps: metadata.steps.map(function (s) { return visitDslNode(_this, s, context); }),\n            options: normalizeAnimationOptions(metadata.options)\n        };\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitGroup = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var _this = this;\n        var /** @type {?} */ currentTime = context.currentTime;\n        var /** @type {?} */ furthestTime = 0;\n        var /** @type {?} */ steps = metadata.steps.map(function (step) {\n            context.currentTime = currentTime;\n            var /** @type {?} */ innerAst = visitDslNode(_this, step, context);\n            furthestTime = Math.max(furthestTime, context.currentTime);\n            return innerAst;\n        });\n        context.currentTime = furthestTime;\n        return {\n            type: 3 /* Group */,\n            steps: steps,\n            options: normalizeAnimationOptions(metadata.options)\n        };\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitAnimate = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ timingAst = constructTimingAst(metadata.timings, context.errors);\n        context.currentAnimateTimings = timingAst;\n        var /** @type {?} */ styleAst;\n        var /** @type {?} */ styleMetadata = metadata.styles ? metadata.styles : _angular_animations.style({});\n        if (styleMetadata.type == 5 /* Keyframes */) {\n            styleAst = this.visitKeyframes(/** @type {?} */ (styleMetadata), context);\n        }\n        else {\n            var /** @type {?} */ styleMetadata_1 = /** @type {?} */ (metadata.styles);\n            var /** @type {?} */ isEmpty = false;\n            if (!styleMetadata_1) {\n                isEmpty = true;\n                var /** @type {?} */ newStyleData = {};\n                if (timingAst.easing) {\n                    newStyleData['easing'] = timingAst.easing;\n                }\n                styleMetadata_1 = _angular_animations.style(newStyleData);\n            }\n            context.currentTime += timingAst.duration + timingAst.delay;\n            var /** @type {?} */ _styleAst = this.visitStyle(styleMetadata_1, context);\n            _styleAst.isEmptyStep = isEmpty;\n            styleAst = _styleAst;\n        }\n        context.currentAnimateTimings = null;\n        return {\n            type: 4 /* Animate */,\n            timings: timingAst,\n            style: styleAst,\n            options: null\n        };\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitStyle = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ ast = this._makeStyleAst(metadata, context);\n        this._validateStyleAst(ast, context);\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype._makeStyleAst = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ styles = [];\n        if (Array.isArray(metadata.styles)) {\n            (/** @type {?} */ (metadata.styles)).forEach(function (styleTuple) {\n                if (typeof styleTuple == 'string') {\n                    if (styleTuple == _angular_animations.AUTO_STYLE) {\n                        styles.push(/** @type {?} */ (styleTuple));\n                    }\n                    else {\n                        context.errors.push(\"The provided style string value \" + styleTuple + \" is not allowed.\");\n                    }\n                }\n                else {\n                    styles.push(/** @type {?} */ (styleTuple));\n                }\n            });\n        }\n        else {\n            styles.push(metadata.styles);\n        }\n        var /** @type {?} */ containsDynamicStyles = false;\n        var /** @type {?} */ collectedEasing = null;\n        styles.forEach(function (styleData) {\n            if (isObject(styleData)) {\n                var /** @type {?} */ styleMap = /** @type {?} */ (styleData);\n                var /** @type {?} */ easing = styleMap['easing'];\n                if (easing) {\n                    collectedEasing = /** @type {?} */ (easing);\n                    delete styleMap['easing'];\n                }\n                if (!containsDynamicStyles) {\n                    for (var /** @type {?} */ prop in styleMap) {\n                        var /** @type {?} */ value = styleMap[prop];\n                        if (value.toString().indexOf(SUBSTITUTION_EXPR_START) >= 0) {\n                            containsDynamicStyles = true;\n                            break;\n                        }\n                    }\n                }\n            }\n        });\n        return {\n            type: 6 /* Style */,\n            styles: styles,\n            easing: collectedEasing,\n            offset: metadata.offset, containsDynamicStyles: containsDynamicStyles,\n            options: null\n        };\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype._validateStyleAst = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var _this = this;\n        var /** @type {?} */ timings = context.currentAnimateTimings;\n        var /** @type {?} */ endTime = context.currentTime;\n        var /** @type {?} */ startTime = context.currentTime;\n        if (timings && startTime > 0) {\n            startTime -= timings.duration + timings.delay;\n        }\n        ast.styles.forEach(function (tuple) {\n            if (typeof tuple == 'string')\n                return;\n            Object.keys(tuple).forEach(function (prop) {\n                if (!_this._driver.validateStyleProperty(prop)) {\n                    context.errors.push(\"The provided animation property \\\"\" + prop + \"\\\" is not a supported CSS property for animations\");\n                    return;\n                }\n                var /** @type {?} */ collectedStyles = context.collectedStyles[/** @type {?} */ ((context.currentQuerySelector))];\n                var /** @type {?} */ collectedEntry = collectedStyles[prop];\n                var /** @type {?} */ updateCollectedStyle = true;\n                if (collectedEntry) {\n                    if (startTime != endTime && startTime >= collectedEntry.startTime &&\n                        endTime <= collectedEntry.endTime) {\n                        context.errors.push(\"The CSS property \\\"\" + prop + \"\\\" that exists between the times of \\\"\" + collectedEntry.startTime + \"ms\\\" and \\\"\" + collectedEntry.endTime + \"ms\\\" is also being animated in a parallel animation between the times of \\\"\" + startTime + \"ms\\\" and \\\"\" + endTime + \"ms\\\"\");\n                        updateCollectedStyle = false;\n                    }\n                    // we always choose the smaller start time value since we\n                    // want to have a record of the entire animation window where\n                    // the style property is being animated in between\n                    startTime = collectedEntry.startTime;\n                }\n                if (updateCollectedStyle) {\n                    collectedStyles[prop] = { startTime: startTime, endTime: endTime };\n                }\n                if (context.options) {\n                    validateStyleParams(tuple[prop], context.options, context.errors);\n                }\n            });\n        });\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitKeyframes = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var _this = this;\n        var /** @type {?} */ ast = { type: 5 /* Keyframes */, styles: [], options: null };\n        if (!context.currentAnimateTimings) {\n            context.errors.push(\"keyframes() must be placed inside of a call to animate()\");\n            return ast;\n        }\n        var /** @type {?} */ MAX_KEYFRAME_OFFSET = 1;\n        var /** @type {?} */ totalKeyframesWithOffsets = 0;\n        var /** @type {?} */ offsets = [];\n        var /** @type {?} */ offsetsOutOfOrder = false;\n        var /** @type {?} */ keyframesOutOfRange = false;\n        var /** @type {?} */ previousOffset = 0;\n        var /** @type {?} */ keyframes = metadata.steps.map(function (styles) {\n            var /** @type {?} */ style$$1 = _this._makeStyleAst(styles, context);\n            var /** @type {?} */ offsetVal = style$$1.offset != null ? style$$1.offset : consumeOffset(style$$1.styles);\n            var /** @type {?} */ offset = 0;\n            if (offsetVal != null) {\n                totalKeyframesWithOffsets++;\n                offset = style$$1.offset = offsetVal;\n            }\n            keyframesOutOfRange = keyframesOutOfRange || offset < 0 || offset > 1;\n            offsetsOutOfOrder = offsetsOutOfOrder || offset < previousOffset;\n            previousOffset = offset;\n            offsets.push(offset);\n            return style$$1;\n        });\n        if (keyframesOutOfRange) {\n            context.errors.push(\"Please ensure that all keyframe offsets are between 0 and 1\");\n        }\n        if (offsetsOutOfOrder) {\n            context.errors.push(\"Please ensure that all keyframe offsets are in order\");\n        }\n        var /** @type {?} */ length = metadata.steps.length;\n        var /** @type {?} */ generatedOffset = 0;\n        if (totalKeyframesWithOffsets > 0 && totalKeyframesWithOffsets < length) {\n            context.errors.push(\"Not all style() steps within the declared keyframes() contain offsets\");\n        }\n        else if (totalKeyframesWithOffsets == 0) {\n            generatedOffset = MAX_KEYFRAME_OFFSET / (length - 1);\n        }\n        var /** @type {?} */ limit = length - 1;\n        var /** @type {?} */ currentTime = context.currentTime;\n        var /** @type {?} */ currentAnimateTimings = /** @type {?} */ ((context.currentAnimateTimings));\n        var /** @type {?} */ animateDuration = currentAnimateTimings.duration;\n        keyframes.forEach(function (kf, i) {\n            var /** @type {?} */ offset = generatedOffset > 0 ? (i == limit ? 1 : (generatedOffset * i)) : offsets[i];\n            var /** @type {?} */ durationUpToThisFrame = offset * animateDuration;\n            context.currentTime = currentTime + currentAnimateTimings.delay + durationUpToThisFrame;\n            currentAnimateTimings.duration = durationUpToThisFrame;\n            _this._validateStyleAst(kf, context);\n            kf.offset = offset;\n            ast.styles.push(kf);\n        });\n        return ast;\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitReference = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        return {\n            type: 8 /* Reference */,\n            animation: visitDslNode(this, normalizeAnimationEntry(metadata.animation), context),\n            options: normalizeAnimationOptions(metadata.options)\n        };\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitAnimateChild = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        context.depCount++;\n        return {\n            type: 9 /* AnimateChild */,\n            options: normalizeAnimationOptions(metadata.options)\n        };\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitAnimateRef = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        return {\n            type: 10 /* AnimateRef */,\n            animation: this.visitReference(metadata.animation, context),\n            options: normalizeAnimationOptions(metadata.options)\n        };\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitQuery = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        var /** @type {?} */ parentSelector = /** @type {?} */ ((context.currentQuerySelector));\n        var /** @type {?} */ options = /** @type {?} */ ((metadata.options || {}));\n        context.queryCount++;\n        context.currentQuery = metadata;\n        var _a = normalizeSelector(metadata.selector), selector = _a[0], includeSelf = _a[1];\n        context.currentQuerySelector =\n            parentSelector.length ? (parentSelector + ' ' + selector) : selector;\n        getOrSetAsInMap(context.collectedStyles, context.currentQuerySelector, {});\n        var /** @type {?} */ animation = visitDslNode(this, normalizeAnimationEntry(metadata.animation), context);\n        context.currentQuery = null;\n        context.currentQuerySelector = parentSelector;\n        return {\n            type: 11 /* Query */,\n            selector: selector,\n            limit: options.limit || 0,\n            optional: !!options.optional, includeSelf: includeSelf, animation: animation,\n            originalSelector: metadata.selector,\n            options: normalizeAnimationOptions(metadata.options)\n        };\n    };\n    /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationAstBuilderVisitor.prototype.visitStagger = /**\n     * @param {?} metadata\n     * @param {?} context\n     * @return {?}\n     */\n    function (metadata, context) {\n        if (!context.currentQuery) {\n            context.errors.push(\"stagger() can only be used inside of query()\");\n        }\n        var /** @type {?} */ timings = metadata.timings === 'full' ?\n            { duration: 0, delay: 0, easing: 'full' } :\n            resolveTiming(metadata.timings, context.errors, true);\n        return {\n            type: 12 /* Stagger */,\n            animation: visitDslNode(this, normalizeAnimationEntry(metadata.animation), context), timings: timings,\n            options: null\n        };\n    };\n    return AnimationAstBuilderVisitor;\n}());\n/**\n * @param {?} selector\n * @return {?}\n */\nfunction normalizeSelector(selector) {\n    var /** @type {?} */ hasAmpersand = selector.split(/\\s*,\\s*/).find(function (token) { return token == SELF_TOKEN; }) ? true : false;\n    if (hasAmpersand) {\n        selector = selector.replace(SELF_TOKEN_REGEX, '');\n    }\n    // the :enter and :leave selectors are filled in at runtime during timeline building\n    selector = selector.replace(/@\\*/g, NG_TRIGGER_SELECTOR)\n        .replace(/@\\w+/g, function (match) { return NG_TRIGGER_SELECTOR + '-' + match.substr(1); })\n        .replace(/:animating/g, NG_ANIMATING_SELECTOR);\n    return [selector, hasAmpersand];\n}\n/**\n * @param {?} obj\n * @return {?}\n */\nfunction normalizeParams(obj) {\n    return obj ? copyObj(obj) : null;\n}\nvar AnimationAstBuilderContext = /** @class */ (function () {\n    function AnimationAstBuilderContext(errors) {\n        this.errors = errors;\n        this.queryCount = 0;\n        this.depCount = 0;\n        this.currentTransition = null;\n        this.currentQuery = null;\n        this.currentQuerySelector = null;\n        this.currentAnimateTimings = null;\n        this.currentTime = 0;\n        this.collectedStyles = {};\n        this.options = null;\n    }\n    return AnimationAstBuilderContext;\n}());\n/**\n * @param {?} styles\n * @return {?}\n */\nfunction consumeOffset(styles) {\n    if (typeof styles == 'string')\n        return null;\n    var /** @type {?} */ offset = null;\n    if (Array.isArray(styles)) {\n        styles.forEach(function (styleTuple) {\n            if (isObject(styleTuple) && styleTuple.hasOwnProperty('offset')) {\n                var /** @type {?} */ obj = /** @type {?} */ (styleTuple);\n                offset = parseFloat(/** @type {?} */ (obj['offset']));\n                delete obj['offset'];\n            }\n        });\n    }\n    else if (isObject(styles) && styles.hasOwnProperty('offset')) {\n        var /** @type {?} */ obj = /** @type {?} */ (styles);\n        offset = parseFloat(/** @type {?} */ (obj['offset']));\n        delete obj['offset'];\n    }\n    return offset;\n}\n/**\n * @param {?} value\n * @return {?}\n */\nfunction isObject(value) {\n    return !Array.isArray(value) && typeof value == 'object';\n}\n/**\n * @param {?} value\n * @param {?} errors\n * @return {?}\n */\nfunction constructTimingAst(value, errors) {\n    var /** @type {?} */ timings = null;\n    if (value.hasOwnProperty('duration')) {\n        timings = /** @type {?} */ (value);\n    }\n    else if (typeof value == 'number') {\n        var /** @type {?} */ duration = resolveTiming(/** @type {?} */ (value), errors).duration;\n        return makeTimingAst(/** @type {?} */ (duration), 0, '');\n    }\n    var /** @type {?} */ strValue = /** @type {?} */ (value);\n    var /** @type {?} */ isDynamic = strValue.split(/\\s+/).some(function (v) { return v.charAt(0) == '{' && v.charAt(1) == '{'; });\n    if (isDynamic) {\n        var /** @type {?} */ ast = /** @type {?} */ (makeTimingAst(0, 0, ''));\n        ast.dynamic = true;\n        ast.strValue = strValue;\n        return /** @type {?} */ (ast);\n    }\n    timings = timings || resolveTiming(strValue, errors);\n    return makeTimingAst(timings.duration, timings.delay, timings.easing);\n}\n/**\n * @param {?} options\n * @return {?}\n */\nfunction normalizeAnimationOptions(options) {\n    if (options) {\n        options = copyObj(options);\n        if (options['params']) {\n            options['params'] = /** @type {?} */ ((normalizeParams(options['params'])));\n        }\n    }\n    else {\n        options = {};\n    }\n    return options;\n}\n/**\n * @param {?} duration\n * @param {?} delay\n * @param {?} easing\n * @return {?}\n */\nfunction makeTimingAst(duration, delay, easing) {\n    return { duration: duration, delay: delay, easing: easing };\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @record\n */\n\n/**\n * @param {?} element\n * @param {?} keyframes\n * @param {?} preStyleProps\n * @param {?} postStyleProps\n * @param {?} duration\n * @param {?} delay\n * @param {?=} easing\n * @param {?=} subTimeline\n * @return {?}\n */\nfunction createTimelineInstruction(element, keyframes, preStyleProps, postStyleProps, duration, delay, easing, subTimeline) {\n    if (easing === void 0) { easing = null; }\n    if (subTimeline === void 0) { subTimeline = false; }\n    return {\n        type: 1 /* TimelineAnimation */,\n        element: element,\n        keyframes: keyframes,\n        preStyleProps: preStyleProps,\n        postStyleProps: postStyleProps,\n        duration: duration,\n        delay: delay,\n        totalTime: duration + delay, easing: easing, subTimeline: subTimeline\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar ElementInstructionMap = /** @class */ (function () {\n    function ElementInstructionMap() {\n        this._map = new Map();\n    }\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.consume = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        var /** @type {?} */ instructions = this._map.get(element);\n        if (instructions) {\n            this._map.delete(element);\n        }\n        else {\n            instructions = [];\n        }\n        return instructions;\n    };\n    /**\n     * @param {?} element\n     * @param {?} instructions\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.append = /**\n     * @param {?} element\n     * @param {?} instructions\n     * @return {?}\n     */\n    function (element, instructions) {\n        var /** @type {?} */ existingInstructions = this._map.get(element);\n        if (!existingInstructions) {\n            this._map.set(element, existingInstructions = []);\n        }\n        existingInstructions.push.apply(existingInstructions, instructions);\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.has = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) { return this._map.has(element); };\n    /**\n     * @return {?}\n     */\n    ElementInstructionMap.prototype.clear = /**\n     * @return {?}\n     */\n    function () { this._map.clear(); };\n    return ElementInstructionMap;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar ONE_FRAME_IN_MILLISECONDS = 1;\nvar ENTER_TOKEN = ':enter';\nvar ENTER_TOKEN_REGEX = new RegExp(ENTER_TOKEN, 'g');\nvar LEAVE_TOKEN = ':leave';\nvar LEAVE_TOKEN_REGEX = new RegExp(LEAVE_TOKEN, 'g');\n/**\n * @param {?} driver\n * @param {?} rootElement\n * @param {?} ast\n * @param {?} enterClassName\n * @param {?} leaveClassName\n * @param {?=} startingStyles\n * @param {?=} finalStyles\n * @param {?=} options\n * @param {?=} subInstructions\n * @param {?=} errors\n * @return {?}\n */\nfunction buildAnimationTimelines(driver, rootElement, ast, enterClassName, leaveClassName, startingStyles, finalStyles, options, subInstructions, errors) {\n    if (startingStyles === void 0) { startingStyles = {}; }\n    if (finalStyles === void 0) { finalStyles = {}; }\n    if (errors === void 0) { errors = []; }\n    return new AnimationTimelineBuilderVisitor().buildKeyframes(driver, rootElement, ast, enterClassName, leaveClassName, startingStyles, finalStyles, options, subInstructions, errors);\n}\nvar AnimationTimelineBuilderVisitor = /** @class */ (function () {\n    function AnimationTimelineBuilderVisitor() {\n    }\n    /**\n     * @param {?} driver\n     * @param {?} rootElement\n     * @param {?} ast\n     * @param {?} enterClassName\n     * @param {?} leaveClassName\n     * @param {?} startingStyles\n     * @param {?} finalStyles\n     * @param {?} options\n     * @param {?=} subInstructions\n     * @param {?=} errors\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.buildKeyframes = /**\n     * @param {?} driver\n     * @param {?} rootElement\n     * @param {?} ast\n     * @param {?} enterClassName\n     * @param {?} leaveClassName\n     * @param {?} startingStyles\n     * @param {?} finalStyles\n     * @param {?} options\n     * @param {?=} subInstructions\n     * @param {?=} errors\n     * @return {?}\n     */\n    function (driver, rootElement, ast, enterClassName, leaveClassName, startingStyles, finalStyles, options, subInstructions, errors) {\n        if (errors === void 0) { errors = []; }\n        subInstructions = subInstructions || new ElementInstructionMap();\n        var /** @type {?} */ context = new AnimationTimelineContext(driver, rootElement, subInstructions, enterClassName, leaveClassName, errors, []);\n        context.options = options;\n        context.currentTimeline.setStyles([startingStyles], null, context.errors, options);\n        visitDslNode(this, ast, context);\n        // this checks to see if an actual animation happened\n        var /** @type {?} */ timelines = context.timelines.filter(function (timeline) { return timeline.containsAnimation(); });\n        if (timelines.length && Object.keys(finalStyles).length) {\n            var /** @type {?} */ tl = timelines[timelines.length - 1];\n            if (!tl.allowOnlyTimelineStyles()) {\n                tl.setStyles([finalStyles], null, context.errors, options);\n            }\n        }\n        return timelines.length ? timelines.map(function (timeline) { return timeline.buildKeyframes(); }) :\n            [createTimelineInstruction(rootElement, [], [], [], 0, 0, '', false)];\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitTrigger = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        // these values are not visited in this AST\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitState = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        // these values are not visited in this AST\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitTransition = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        // these values are not visited in this AST\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitAnimateChild = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ elementInstructions = context.subInstructions.consume(context.element);\n        if (elementInstructions) {\n            var /** @type {?} */ innerContext = context.createSubContext(ast.options);\n            var /** @type {?} */ startTime = context.currentTimeline.currentTime;\n            var /** @type {?} */ endTime = this._visitSubInstructions(elementInstructions, innerContext, /** @type {?} */ (innerContext.options));\n            if (startTime != endTime) {\n                // we do this on the upper context because we created a sub context for\n                // the sub child animations\n                context.transformIntoNewTimeline(endTime);\n            }\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitAnimateRef = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ innerContext = context.createSubContext(ast.options);\n        innerContext.transformIntoNewTimeline();\n        this.visitReference(ast.animation, innerContext);\n        context.transformIntoNewTimeline(innerContext.currentTimeline.currentTime);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} instructions\n     * @param {?} context\n     * @param {?} options\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype._visitSubInstructions = /**\n     * @param {?} instructions\n     * @param {?} context\n     * @param {?} options\n     * @return {?}\n     */\n    function (instructions, context, options) {\n        var /** @type {?} */ startTime = context.currentTimeline.currentTime;\n        var /** @type {?} */ furthestTime = startTime;\n        // this is a special-case for when a user wants to skip a sub\n        // animation from being fired entirely.\n        var /** @type {?} */ duration = options.duration != null ? resolveTimingValue(options.duration) : null;\n        var /** @type {?} */ delay = options.delay != null ? resolveTimingValue(options.delay) : null;\n        if (duration !== 0) {\n            instructions.forEach(function (instruction) {\n                var /** @type {?} */ instructionTimings = context.appendInstructionToTimeline(instruction, duration, delay);\n                furthestTime =\n                    Math.max(furthestTime, instructionTimings.duration + instructionTimings.delay);\n            });\n        }\n        return furthestTime;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitReference = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        context.updateOptions(ast.options, true);\n        visitDslNode(this, ast.animation, context);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitSequence = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var _this = this;\n        var /** @type {?} */ subContextCount = context.subContextCount;\n        var /** @type {?} */ ctx = context;\n        var /** @type {?} */ options = ast.options;\n        if (options && (options.params || options.delay)) {\n            ctx = context.createSubContext(options);\n            ctx.transformIntoNewTimeline();\n            if (options.delay != null) {\n                if (ctx.previousNode.type == 6 /* Style */) {\n                    ctx.currentTimeline.snapshotCurrentStyles();\n                    ctx.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n                }\n                var /** @type {?} */ delay = resolveTimingValue(options.delay);\n                ctx.delayNextStep(delay);\n            }\n        }\n        if (ast.steps.length) {\n            ast.steps.forEach(function (s) { return visitDslNode(_this, s, ctx); });\n            // this is here just incase the inner steps only contain or end with a style() call\n            ctx.currentTimeline.applyStylesToKeyframe();\n            // this means that some animation function within the sequence\n            // ended up creating a sub timeline (which means the current\n            // timeline cannot overlap with the contents of the sequence)\n            if (ctx.subContextCount > subContextCount) {\n                ctx.transformIntoNewTimeline();\n            }\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitGroup = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var _this = this;\n        var /** @type {?} */ innerTimelines = [];\n        var /** @type {?} */ furthestTime = context.currentTimeline.currentTime;\n        var /** @type {?} */ delay = ast.options && ast.options.delay ? resolveTimingValue(ast.options.delay) : 0;\n        ast.steps.forEach(function (s) {\n            var /** @type {?} */ innerContext = context.createSubContext(ast.options);\n            if (delay) {\n                innerContext.delayNextStep(delay);\n            }\n            visitDslNode(_this, s, innerContext);\n            furthestTime = Math.max(furthestTime, innerContext.currentTimeline.currentTime);\n            innerTimelines.push(innerContext.currentTimeline);\n        });\n        // this operation is run after the AST loop because otherwise\n        // if the parent timeline's collected styles were updated then\n        // it would pass in invalid data into the new-to-be forked items\n        innerTimelines.forEach(function (timeline) { return context.currentTimeline.mergeTimelineCollectedStyles(timeline); });\n        context.transformIntoNewTimeline(furthestTime);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype._visitTiming = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        if ((/** @type {?} */ (ast)).dynamic) {\n            var /** @type {?} */ strValue = (/** @type {?} */ (ast)).strValue;\n            var /** @type {?} */ timingValue = context.params ? interpolateParams(strValue, context.params, context.errors) : strValue;\n            return resolveTiming(timingValue, context.errors);\n        }\n        else {\n            return { duration: ast.duration, delay: ast.delay, easing: ast.easing };\n        }\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitAnimate = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ timings = context.currentAnimateTimings = this._visitTiming(ast.timings, context);\n        var /** @type {?} */ timeline = context.currentTimeline;\n        if (timings.delay) {\n            context.incrementTime(timings.delay);\n            timeline.snapshotCurrentStyles();\n        }\n        var /** @type {?} */ style$$1 = ast.style;\n        if (style$$1.type == 5 /* Keyframes */) {\n            this.visitKeyframes(style$$1, context);\n        }\n        else {\n            context.incrementTime(timings.duration);\n            this.visitStyle(/** @type {?} */ (style$$1), context);\n            timeline.applyStylesToKeyframe();\n        }\n        context.currentAnimateTimings = null;\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitStyle = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ timeline = context.currentTimeline;\n        var /** @type {?} */ timings = /** @type {?} */ ((context.currentAnimateTimings));\n        // this is a special case for when a style() call\n        // directly follows  an animate() call (but not inside of an animate() call)\n        if (!timings && timeline.getCurrentStyleProperties().length) {\n            timeline.forwardFrame();\n        }\n        var /** @type {?} */ easing = (timings && timings.easing) || ast.easing;\n        if (ast.isEmptyStep) {\n            timeline.applyEmptyStep(easing);\n        }\n        else {\n            timeline.setStyles(ast.styles, easing, context.errors, context.options);\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitKeyframes = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ currentAnimateTimings = /** @type {?} */ ((context.currentAnimateTimings));\n        var /** @type {?} */ startTime = (/** @type {?} */ ((context.currentTimeline))).duration;\n        var /** @type {?} */ duration = currentAnimateTimings.duration;\n        var /** @type {?} */ innerContext = context.createSubContext();\n        var /** @type {?} */ innerTimeline = innerContext.currentTimeline;\n        innerTimeline.easing = currentAnimateTimings.easing;\n        ast.styles.forEach(function (step) {\n            var /** @type {?} */ offset = step.offset || 0;\n            innerTimeline.forwardTime(offset * duration);\n            innerTimeline.setStyles(step.styles, step.easing, context.errors, context.options);\n            innerTimeline.applyStylesToKeyframe();\n        });\n        // this will ensure that the parent timeline gets all the styles from\n        // the child even if the new timeline below is not used\n        context.currentTimeline.mergeTimelineCollectedStyles(innerTimeline);\n        // we do this because the window between this timeline and the sub timeline\n        // should ensure that the styles within are exactly the same as they were before\n        context.transformIntoNewTimeline(startTime + duration);\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitQuery = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var _this = this;\n        // in the event that the first step before this is a style step we need\n        // to ensure the styles are applied before the children are animated\n        var /** @type {?} */ startTime = context.currentTimeline.currentTime;\n        var /** @type {?} */ options = /** @type {?} */ ((ast.options || {}));\n        var /** @type {?} */ delay = options.delay ? resolveTimingValue(options.delay) : 0;\n        if (delay && (context.previousNode.type === 6 /* Style */ ||\n            (startTime == 0 && context.currentTimeline.getCurrentStyleProperties().length))) {\n            context.currentTimeline.snapshotCurrentStyles();\n            context.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n        }\n        var /** @type {?} */ furthestTime = startTime;\n        var /** @type {?} */ elms = context.invokeQuery(ast.selector, ast.originalSelector, ast.limit, ast.includeSelf, options.optional ? true : false, context.errors);\n        context.currentQueryTotal = elms.length;\n        var /** @type {?} */ sameElementTimeline = null;\n        elms.forEach(function (element, i) {\n            context.currentQueryIndex = i;\n            var /** @type {?} */ innerContext = context.createSubContext(ast.options, element);\n            if (delay) {\n                innerContext.delayNextStep(delay);\n            }\n            if (element === context.element) {\n                sameElementTimeline = innerContext.currentTimeline;\n            }\n            visitDslNode(_this, ast.animation, innerContext);\n            // this is here just incase the inner steps only contain or end\n            // with a style() call (which is here to signal that this is a preparatory\n            // call to style an element before it is animated again)\n            innerContext.currentTimeline.applyStylesToKeyframe();\n            var /** @type {?} */ endTime = innerContext.currentTimeline.currentTime;\n            furthestTime = Math.max(furthestTime, endTime);\n        });\n        context.currentQueryIndex = 0;\n        context.currentQueryTotal = 0;\n        context.transformIntoNewTimeline(furthestTime);\n        if (sameElementTimeline) {\n            context.currentTimeline.mergeTimelineCollectedStyles(sameElementTimeline);\n            context.currentTimeline.snapshotCurrentStyles();\n        }\n        context.previousNode = ast;\n    };\n    /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTimelineBuilderVisitor.prototype.visitStagger = /**\n     * @param {?} ast\n     * @param {?} context\n     * @return {?}\n     */\n    function (ast, context) {\n        var /** @type {?} */ parentContext = /** @type {?} */ ((context.parentContext));\n        var /** @type {?} */ tl = context.currentTimeline;\n        var /** @type {?} */ timings = ast.timings;\n        var /** @type {?} */ duration = Math.abs(timings.duration);\n        var /** @type {?} */ maxTime = duration * (context.currentQueryTotal - 1);\n        var /** @type {?} */ delay = duration * context.currentQueryIndex;\n        var /** @type {?} */ staggerTransformer = timings.duration < 0 ? 'reverse' : timings.easing;\n        switch (staggerTransformer) {\n            case 'reverse':\n                delay = maxTime - delay;\n                break;\n            case 'full':\n                delay = parentContext.currentStaggerTime;\n                break;\n        }\n        var /** @type {?} */ timeline = context.currentTimeline;\n        if (delay) {\n            timeline.delayNextStep(delay);\n        }\n        var /** @type {?} */ startingTime = timeline.currentTime;\n        visitDslNode(this, ast.animation, context);\n        context.previousNode = ast;\n        // time = duration + delay\n        // the reason why this computation is so complex is because\n        // the inner timeline may either have a delay value or a stretched\n        // keyframe depending on if a subtimeline is not used or is used.\n        parentContext.currentStaggerTime =\n            (tl.currentTime - startingTime) + (tl.startTime - parentContext.currentTimeline.startTime);\n    };\n    return AnimationTimelineBuilderVisitor;\n}());\nvar DEFAULT_NOOP_PREVIOUS_NODE = /** @type {?} */ ({});\nvar AnimationTimelineContext = /** @class */ (function () {\n    function AnimationTimelineContext(_driver, element, subInstructions, _enterClassName, _leaveClassName, errors, timelines, initialTimeline) {\n        this._driver = _driver;\n        this.element = element;\n        this.subInstructions = subInstructions;\n        this._enterClassName = _enterClassName;\n        this._leaveClassName = _leaveClassName;\n        this.errors = errors;\n        this.timelines = timelines;\n        this.parentContext = null;\n        this.currentAnimateTimings = null;\n        this.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n        this.subContextCount = 0;\n        this.options = {};\n        this.currentQueryIndex = 0;\n        this.currentQueryTotal = 0;\n        this.currentStaggerTime = 0;\n        this.currentTimeline = initialTimeline || new TimelineBuilder(this._driver, element, 0);\n        timelines.push(this.currentTimeline);\n    }\n    Object.defineProperty(AnimationTimelineContext.prototype, \"params\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return this.options.params; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} options\n     * @param {?=} skipIfExists\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.updateOptions = /**\n     * @param {?} options\n     * @param {?=} skipIfExists\n     * @return {?}\n     */\n    function (options, skipIfExists) {\n        var _this = this;\n        if (!options)\n            return;\n        var /** @type {?} */ newOptions = /** @type {?} */ (options);\n        var /** @type {?} */ optionsToUpdate = this.options;\n        // NOTE: this will get patched up when other animation methods support duration overrides\n        if (newOptions.duration != null) {\n            (/** @type {?} */ (optionsToUpdate)).duration = resolveTimingValue(newOptions.duration);\n        }\n        if (newOptions.delay != null) {\n            optionsToUpdate.delay = resolveTimingValue(newOptions.delay);\n        }\n        var /** @type {?} */ newParams = newOptions.params;\n        if (newParams) {\n            var /** @type {?} */ paramsToUpdate_1 = /** @type {?} */ ((optionsToUpdate.params));\n            if (!paramsToUpdate_1) {\n                paramsToUpdate_1 = this.options.params = {};\n            }\n            Object.keys(newParams).forEach(function (name) {\n                if (!skipIfExists || !paramsToUpdate_1.hasOwnProperty(name)) {\n                    paramsToUpdate_1[name] = interpolateParams(newParams[name], paramsToUpdate_1, _this.errors);\n                }\n            });\n        }\n    };\n    /**\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype._copyOptions = /**\n     * @return {?}\n     */\n    function () {\n        var /** @type {?} */ options = {};\n        if (this.options) {\n            var /** @type {?} */ oldParams_1 = this.options.params;\n            if (oldParams_1) {\n                var /** @type {?} */ params_1 = options['params'] = {};\n                Object.keys(oldParams_1).forEach(function (name) { params_1[name] = oldParams_1[name]; });\n            }\n        }\n        return options;\n    };\n    /**\n     * @param {?=} options\n     * @param {?=} element\n     * @param {?=} newTime\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.createSubContext = /**\n     * @param {?=} options\n     * @param {?=} element\n     * @param {?=} newTime\n     * @return {?}\n     */\n    function (options, element, newTime) {\n        if (options === void 0) { options = null; }\n        var /** @type {?} */ target = element || this.element;\n        var /** @type {?} */ context = new AnimationTimelineContext(this._driver, target, this.subInstructions, this._enterClassName, this._leaveClassName, this.errors, this.timelines, this.currentTimeline.fork(target, newTime || 0));\n        context.previousNode = this.previousNode;\n        context.currentAnimateTimings = this.currentAnimateTimings;\n        context.options = this._copyOptions();\n        context.updateOptions(options);\n        context.currentQueryIndex = this.currentQueryIndex;\n        context.currentQueryTotal = this.currentQueryTotal;\n        context.parentContext = this;\n        this.subContextCount++;\n        return context;\n    };\n    /**\n     * @param {?=} newTime\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.transformIntoNewTimeline = /**\n     * @param {?=} newTime\n     * @return {?}\n     */\n    function (newTime) {\n        this.previousNode = DEFAULT_NOOP_PREVIOUS_NODE;\n        this.currentTimeline = this.currentTimeline.fork(this.element, newTime);\n        this.timelines.push(this.currentTimeline);\n        return this.currentTimeline;\n    };\n    /**\n     * @param {?} instruction\n     * @param {?} duration\n     * @param {?} delay\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.appendInstructionToTimeline = /**\n     * @param {?} instruction\n     * @param {?} duration\n     * @param {?} delay\n     * @return {?}\n     */\n    function (instruction, duration, delay) {\n        var /** @type {?} */ updatedTimings = {\n            duration: duration != null ? duration : instruction.duration,\n            delay: this.currentTimeline.currentTime + (delay != null ? delay : 0) + instruction.delay,\n            easing: ''\n        };\n        var /** @type {?} */ builder = new SubTimelineBuilder(this._driver, instruction.element, instruction.keyframes, instruction.preStyleProps, instruction.postStyleProps, updatedTimings, instruction.stretchStartingKeyframe);\n        this.timelines.push(builder);\n        return updatedTimings;\n    };\n    /**\n     * @param {?} time\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.incrementTime = /**\n     * @param {?} time\n     * @return {?}\n     */\n    function (time) {\n        this.currentTimeline.forwardTime(this.currentTimeline.duration + time);\n    };\n    /**\n     * @param {?} delay\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.delayNextStep = /**\n     * @param {?} delay\n     * @return {?}\n     */\n    function (delay) {\n        // negative delays are not yet supported\n        if (delay > 0) {\n            this.currentTimeline.delayNextStep(delay);\n        }\n    };\n    /**\n     * @param {?} selector\n     * @param {?} originalSelector\n     * @param {?} limit\n     * @param {?} includeSelf\n     * @param {?} optional\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationTimelineContext.prototype.invokeQuery = /**\n     * @param {?} selector\n     * @param {?} originalSelector\n     * @param {?} limit\n     * @param {?} includeSelf\n     * @param {?} optional\n     * @param {?} errors\n     * @return {?}\n     */\n    function (selector, originalSelector, limit, includeSelf, optional, errors) {\n        var /** @type {?} */ results = [];\n        if (includeSelf) {\n            results.push(this.element);\n        }\n        if (selector.length > 0) {\n            // if :self is only used then the selector is empty\n            selector = selector.replace(ENTER_TOKEN_REGEX, '.' + this._enterClassName);\n            selector = selector.replace(LEAVE_TOKEN_REGEX, '.' + this._leaveClassName);\n            var /** @type {?} */ multi = limit != 1;\n            var /** @type {?} */ elements = this._driver.query(this.element, selector, multi);\n            if (limit !== 0) {\n                elements = limit < 0 ? elements.slice(elements.length + limit, elements.length) :\n                    elements.slice(0, limit);\n            }\n            results.push.apply(results, elements);\n        }\n        if (!optional && results.length == 0) {\n            errors.push(\"`query(\\\"\" + originalSelector + \"\\\")` returned zero elements. (Use `query(\\\"\" + originalSelector + \"\\\", { optional: true })` if you wish to allow this.)\");\n        }\n        return results;\n    };\n    return AnimationTimelineContext;\n}());\nvar TimelineBuilder = /** @class */ (function () {\n    function TimelineBuilder(_driver, element, startTime, _elementTimelineStylesLookup) {\n        this._driver = _driver;\n        this.element = element;\n        this.startTime = startTime;\n        this._elementTimelineStylesLookup = _elementTimelineStylesLookup;\n        this.duration = 0;\n        this._previousKeyframe = {};\n        this._currentKeyframe = {};\n        this._keyframes = new Map();\n        this._styleSummary = {};\n        this._pendingStyles = {};\n        this._backFill = {};\n        this._currentEmptyStepKeyframe = null;\n        if (!this._elementTimelineStylesLookup) {\n            this._elementTimelineStylesLookup = new Map();\n        }\n        this._localTimelineStyles = Object.create(this._backFill, {});\n        this._globalTimelineStyles = /** @type {?} */ ((this._elementTimelineStylesLookup.get(element)));\n        if (!this._globalTimelineStyles) {\n            this._globalTimelineStyles = this._localTimelineStyles;\n            this._elementTimelineStylesLookup.set(element, this._localTimelineStyles);\n        }\n        this._loadKeyframe();\n    }\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.containsAnimation = /**\n     * @return {?}\n     */\n    function () {\n        switch (this._keyframes.size) {\n            case 0:\n                return false;\n            case 1:\n                return this.getCurrentStyleProperties().length > 0;\n            default:\n                return true;\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.getCurrentStyleProperties = /**\n     * @return {?}\n     */\n    function () { return Object.keys(this._currentKeyframe); };\n    Object.defineProperty(TimelineBuilder.prototype, \"currentTime\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return this.startTime + this.duration; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} delay\n     * @return {?}\n     */\n    TimelineBuilder.prototype.delayNextStep = /**\n     * @param {?} delay\n     * @return {?}\n     */\n    function (delay) {\n        // in the event that a style() step is placed right before a stagger()\n        // and that style() step is the very first style() value in the animation\n        // then we need to make a copy of the keyframe [0, copy, 1] so that the delay\n        // properly applies the style() values to work with the stagger...\n        var /** @type {?} */ hasPreStyleStep = this._keyframes.size == 1 && Object.keys(this._pendingStyles).length;\n        if (this.duration || hasPreStyleStep) {\n            this.forwardTime(this.currentTime + delay);\n            if (hasPreStyleStep) {\n                this.snapshotCurrentStyles();\n            }\n        }\n        else {\n            this.startTime += delay;\n        }\n    };\n    /**\n     * @param {?} element\n     * @param {?=} currentTime\n     * @return {?}\n     */\n    TimelineBuilder.prototype.fork = /**\n     * @param {?} element\n     * @param {?=} currentTime\n     * @return {?}\n     */\n    function (element, currentTime) {\n        this.applyStylesToKeyframe();\n        return new TimelineBuilder(this._driver, element, currentTime || this.currentTime, this._elementTimelineStylesLookup);\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype._loadKeyframe = /**\n     * @return {?}\n     */\n    function () {\n        if (this._currentKeyframe) {\n            this._previousKeyframe = this._currentKeyframe;\n        }\n        this._currentKeyframe = /** @type {?} */ ((this._keyframes.get(this.duration)));\n        if (!this._currentKeyframe) {\n            this._currentKeyframe = Object.create(this._backFill, {});\n            this._keyframes.set(this.duration, this._currentKeyframe);\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.forwardFrame = /**\n     * @return {?}\n     */\n    function () {\n        this.duration += ONE_FRAME_IN_MILLISECONDS;\n        this._loadKeyframe();\n    };\n    /**\n     * @param {?} time\n     * @return {?}\n     */\n    TimelineBuilder.prototype.forwardTime = /**\n     * @param {?} time\n     * @return {?}\n     */\n    function (time) {\n        this.applyStylesToKeyframe();\n        this.duration = time;\n        this._loadKeyframe();\n    };\n    /**\n     * @param {?} prop\n     * @param {?} value\n     * @return {?}\n     */\n    TimelineBuilder.prototype._updateStyle = /**\n     * @param {?} prop\n     * @param {?} value\n     * @return {?}\n     */\n    function (prop, value) {\n        this._localTimelineStyles[prop] = value;\n        this._globalTimelineStyles[prop] = value;\n        this._styleSummary[prop] = { time: this.currentTime, value: value };\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.allowOnlyTimelineStyles = /**\n     * @return {?}\n     */\n    function () { return this._currentEmptyStepKeyframe !== this._currentKeyframe; };\n    /**\n     * @param {?} easing\n     * @return {?}\n     */\n    TimelineBuilder.prototype.applyEmptyStep = /**\n     * @param {?} easing\n     * @return {?}\n     */\n    function (easing) {\n        var _this = this;\n        if (easing) {\n            this._previousKeyframe['easing'] = easing;\n        }\n        // special case for animate(duration):\n        // all missing styles are filled with a `*` value then\n        // if any destination styles are filled in later on the same\n        // keyframe then they will override the overridden styles\n        // We use `_globalTimelineStyles` here because there may be\n        // styles in previous keyframes that are not present in this timeline\n        Object.keys(this._globalTimelineStyles).forEach(function (prop) {\n            _this._backFill[prop] = _this._globalTimelineStyles[prop] || _angular_animations.AUTO_STYLE;\n            _this._currentKeyframe[prop] = _angular_animations.AUTO_STYLE;\n        });\n        this._currentEmptyStepKeyframe = this._currentKeyframe;\n    };\n    /**\n     * @param {?} input\n     * @param {?} easing\n     * @param {?} errors\n     * @param {?=} options\n     * @return {?}\n     */\n    TimelineBuilder.prototype.setStyles = /**\n     * @param {?} input\n     * @param {?} easing\n     * @param {?} errors\n     * @param {?=} options\n     * @return {?}\n     */\n    function (input, easing, errors, options) {\n        var _this = this;\n        if (easing) {\n            this._previousKeyframe['easing'] = easing;\n        }\n        var /** @type {?} */ params = (options && options.params) || {};\n        var /** @type {?} */ styles = flattenStyles(input, this._globalTimelineStyles);\n        Object.keys(styles).forEach(function (prop) {\n            var /** @type {?} */ val = interpolateParams(styles[prop], params, errors);\n            _this._pendingStyles[prop] = val;\n            if (!_this._localTimelineStyles.hasOwnProperty(prop)) {\n                _this._backFill[prop] = _this._globalTimelineStyles.hasOwnProperty(prop) ?\n                    _this._globalTimelineStyles[prop] :\n                    _angular_animations.AUTO_STYLE;\n            }\n            _this._updateStyle(prop, val);\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.applyStylesToKeyframe = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        var /** @type {?} */ styles = this._pendingStyles;\n        var /** @type {?} */ props = Object.keys(styles);\n        if (props.length == 0)\n            return;\n        this._pendingStyles = {};\n        props.forEach(function (prop) {\n            var /** @type {?} */ val = styles[prop];\n            _this._currentKeyframe[prop] = val;\n        });\n        Object.keys(this._localTimelineStyles).forEach(function (prop) {\n            if (!_this._currentKeyframe.hasOwnProperty(prop)) {\n                _this._currentKeyframe[prop] = _this._localTimelineStyles[prop];\n            }\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.snapshotCurrentStyles = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        Object.keys(this._localTimelineStyles).forEach(function (prop) {\n            var /** @type {?} */ val = _this._localTimelineStyles[prop];\n            _this._pendingStyles[prop] = val;\n            _this._updateStyle(prop, val);\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.getFinalKeyframe = /**\n     * @return {?}\n     */\n    function () { return this._keyframes.get(this.duration); };\n    Object.defineProperty(TimelineBuilder.prototype, \"properties\", {\n        get: /**\n         * @return {?}\n         */\n        function () {\n            var /** @type {?} */ properties = [];\n            for (var /** @type {?} */ prop in this._currentKeyframe) {\n                properties.push(prop);\n            }\n            return properties;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} timeline\n     * @return {?}\n     */\n    TimelineBuilder.prototype.mergeTimelineCollectedStyles = /**\n     * @param {?} timeline\n     * @return {?}\n     */\n    function (timeline) {\n        var _this = this;\n        Object.keys(timeline._styleSummary).forEach(function (prop) {\n            var /** @type {?} */ details0 = _this._styleSummary[prop];\n            var /** @type {?} */ details1 = timeline._styleSummary[prop];\n            if (!details0 || details1.time > details0.time) {\n                _this._updateStyle(prop, details1.value);\n            }\n        });\n    };\n    /**\n     * @return {?}\n     */\n    TimelineBuilder.prototype.buildKeyframes = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        this.applyStylesToKeyframe();\n        var /** @type {?} */ preStyleProps = new Set();\n        var /** @type {?} */ postStyleProps = new Set();\n        var /** @type {?} */ isEmpty = this._keyframes.size === 1 && this.duration === 0;\n        var /** @type {?} */ finalKeyframes = [];\n        this._keyframes.forEach(function (keyframe, time) {\n            var /** @type {?} */ finalKeyframe = copyStyles(keyframe, true);\n            Object.keys(finalKeyframe).forEach(function (prop) {\n                var /** @type {?} */ value = finalKeyframe[prop];\n                if (value == _angular_animations.ɵPRE_STYLE) {\n                    preStyleProps.add(prop);\n                }\n                else if (value == _angular_animations.AUTO_STYLE) {\n                    postStyleProps.add(prop);\n                }\n            });\n            if (!isEmpty) {\n                finalKeyframe['offset'] = time / _this.duration;\n            }\n            finalKeyframes.push(finalKeyframe);\n        });\n        var /** @type {?} */ preProps = preStyleProps.size ? iteratorToArray(preStyleProps.values()) : [];\n        var /** @type {?} */ postProps = postStyleProps.size ? iteratorToArray(postStyleProps.values()) : [];\n        // special case for a 0-second animation (which is designed just to place styles onscreen)\n        if (isEmpty) {\n            var /** @type {?} */ kf0 = finalKeyframes[0];\n            var /** @type {?} */ kf1 = copyObj(kf0);\n            kf0['offset'] = 0;\n            kf1['offset'] = 1;\n            finalKeyframes = [kf0, kf1];\n        }\n        return createTimelineInstruction(this.element, finalKeyframes, preProps, postProps, this.duration, this.startTime, this.easing, false);\n    };\n    return TimelineBuilder;\n}());\nvar SubTimelineBuilder = /** @class */ (function (_super) {\n    __extends(SubTimelineBuilder, _super);\n    function SubTimelineBuilder(driver, element, keyframes, preStyleProps, postStyleProps, timings, _stretchStartingKeyframe) {\n        if (_stretchStartingKeyframe === void 0) { _stretchStartingKeyframe = false; }\n        var _this = _super.call(this, driver, element, timings.delay) || this;\n        _this.element = element;\n        _this.keyframes = keyframes;\n        _this.preStyleProps = preStyleProps;\n        _this.postStyleProps = postStyleProps;\n        _this._stretchStartingKeyframe = _stretchStartingKeyframe;\n        _this.timings = { duration: timings.duration, delay: timings.delay, easing: timings.easing };\n        return _this;\n    }\n    /**\n     * @return {?}\n     */\n    SubTimelineBuilder.prototype.containsAnimation = /**\n     * @return {?}\n     */\n    function () { return this.keyframes.length > 1; };\n    /**\n     * @return {?}\n     */\n    SubTimelineBuilder.prototype.buildKeyframes = /**\n     * @return {?}\n     */\n    function () {\n        var /** @type {?} */ keyframes = this.keyframes;\n        var _a = this.timings, delay = _a.delay, duration = _a.duration, easing = _a.easing;\n        if (this._stretchStartingKeyframe && delay) {\n            var /** @type {?} */ newKeyframes = [];\n            var /** @type {?} */ totalTime = duration + delay;\n            var /** @type {?} */ startingGap = delay / totalTime;\n            // the original starting keyframe now starts once the delay is done\n            var /** @type {?} */ newFirstKeyframe = copyStyles(keyframes[0], false);\n            newFirstKeyframe['offset'] = 0;\n            newKeyframes.push(newFirstKeyframe);\n            var /** @type {?} */ oldFirstKeyframe = copyStyles(keyframes[0], false);\n            oldFirstKeyframe['offset'] = roundOffset(startingGap);\n            newKeyframes.push(oldFirstKeyframe);\n            /*\n                    When the keyframe is stretched then it means that the delay before the animation\n                    starts is gone. Instead the first keyframe is placed at the start of the animation\n                    and it is then copied to where it starts when the original delay is over. This basically\n                    means nothing animates during that delay, but the styles are still renderered. For this\n                    to work the original offset values that exist in the original keyframes must be \"warped\"\n                    so that they can take the new keyframe + delay into account.\n            \n                    delay=1000, duration=1000, keyframes = 0 .5 1\n            \n                    turns into\n            \n                    delay=0, duration=2000, keyframes = 0 .33 .66 1\n                   */\n            // offsets between 1 ... n -1 are all warped by the keyframe stretch\n            var /** @type {?} */ limit = keyframes.length - 1;\n            for (var /** @type {?} */ i = 1; i <= limit; i++) {\n                var /** @type {?} */ kf = copyStyles(keyframes[i], false);\n                var /** @type {?} */ oldOffset = /** @type {?} */ (kf['offset']);\n                var /** @type {?} */ timeAtKeyframe = delay + oldOffset * duration;\n                kf['offset'] = roundOffset(timeAtKeyframe / totalTime);\n                newKeyframes.push(kf);\n            }\n            // the new starting keyframe should be added at the start\n            duration = totalTime;\n            delay = 0;\n            easing = '';\n            keyframes = newKeyframes;\n        }\n        return createTimelineInstruction(this.element, keyframes, this.preStyleProps, this.postStyleProps, duration, delay, easing, true);\n    };\n    return SubTimelineBuilder;\n}(TimelineBuilder));\n/**\n * @param {?} offset\n * @param {?=} decimalPoints\n * @return {?}\n */\nfunction roundOffset(offset, decimalPoints) {\n    if (decimalPoints === void 0) { decimalPoints = 3; }\n    var /** @type {?} */ mult = Math.pow(10, decimalPoints - 1);\n    return Math.round(offset * mult) / mult;\n}\n/**\n * @param {?} input\n * @param {?} allStyles\n * @return {?}\n */\nfunction flattenStyles(input, allStyles) {\n    var /** @type {?} */ styles = {};\n    var /** @type {?} */ allProperties;\n    input.forEach(function (token) {\n        if (token === '*') {\n            allProperties = allProperties || Object.keys(allStyles);\n            allProperties.forEach(function (prop) { styles[prop] = _angular_animations.AUTO_STYLE; });\n        }\n        else {\n            copyStyles(/** @type {?} */ (token), false, styles);\n        }\n    });\n    return styles;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar Animation = /** @class */ (function () {\n    function Animation(_driver, input) {\n        this._driver = _driver;\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ ast = buildAnimationAst(_driver, input, errors);\n        if (errors.length) {\n            var /** @type {?} */ errorMessage = \"animation validation failed:\\n\" + errors.join(\"\\n\");\n            throw new Error(errorMessage);\n        }\n        this._animationAst = ast;\n    }\n    /**\n     * @param {?} element\n     * @param {?} startingStyles\n     * @param {?} destinationStyles\n     * @param {?} options\n     * @param {?=} subInstructions\n     * @return {?}\n     */\n    Animation.prototype.buildTimelines = /**\n     * @param {?} element\n     * @param {?} startingStyles\n     * @param {?} destinationStyles\n     * @param {?} options\n     * @param {?=} subInstructions\n     * @return {?}\n     */\n    function (element, startingStyles, destinationStyles, options, subInstructions) {\n        var /** @type {?} */ start = Array.isArray(startingStyles) ? normalizeStyles(startingStyles) : /** @type {?} */ (startingStyles);\n        var /** @type {?} */ dest = Array.isArray(destinationStyles) ? normalizeStyles(destinationStyles) : /** @type {?} */ (destinationStyles);\n        var /** @type {?} */ errors = [];\n        subInstructions = subInstructions || new ElementInstructionMap();\n        var /** @type {?} */ result = buildAnimationTimelines(this._driver, element, this._animationAst, ENTER_CLASSNAME, LEAVE_CLASSNAME, start, dest, options, subInstructions, errors);\n        if (errors.length) {\n            var /** @type {?} */ errorMessage = \"animation building failed:\\n\" + errors.join(\"\\n\");\n            throw new Error(errorMessage);\n        }\n        return result;\n    };\n    return Animation;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\n/**\n * \\@experimental Animation support is experimental.\n * @abstract\n */\nvar AnimationStyleNormalizer = /** @class */ (function () {\n    function AnimationStyleNormalizer() {\n    }\n    return AnimationStyleNormalizer;\n}());\n/**\n * \\@experimental Animation support is experimental.\n */\nvar NoopAnimationStyleNormalizer = /** @class */ (function () {\n    function NoopAnimationStyleNormalizer() {\n    }\n    /**\n     * @param {?} propertyName\n     * @param {?} errors\n     * @return {?}\n     */\n    NoopAnimationStyleNormalizer.prototype.normalizePropertyName = /**\n     * @param {?} propertyName\n     * @param {?} errors\n     * @return {?}\n     */\n    function (propertyName, errors) { return propertyName; };\n    /**\n     * @param {?} userProvidedProperty\n     * @param {?} normalizedProperty\n     * @param {?} value\n     * @param {?} errors\n     * @return {?}\n     */\n    NoopAnimationStyleNormalizer.prototype.normalizeStyleValue = /**\n     * @param {?} userProvidedProperty\n     * @param {?} normalizedProperty\n     * @param {?} value\n     * @param {?} errors\n     * @return {?}\n     */\n    function (userProvidedProperty, normalizedProperty, value, errors) {\n        return /** @type {?} */ (value);\n    };\n    return NoopAnimationStyleNormalizer;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar WebAnimationsStyleNormalizer = /** @class */ (function (_super) {\n    __extends(WebAnimationsStyleNormalizer, _super);\n    function WebAnimationsStyleNormalizer() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    /**\n     * @param {?} propertyName\n     * @param {?} errors\n     * @return {?}\n     */\n    WebAnimationsStyleNormalizer.prototype.normalizePropertyName = /**\n     * @param {?} propertyName\n     * @param {?} errors\n     * @return {?}\n     */\n    function (propertyName, errors) {\n        return dashCaseToCamelCase(propertyName);\n    };\n    /**\n     * @param {?} userProvidedProperty\n     * @param {?} normalizedProperty\n     * @param {?} value\n     * @param {?} errors\n     * @return {?}\n     */\n    WebAnimationsStyleNormalizer.prototype.normalizeStyleValue = /**\n     * @param {?} userProvidedProperty\n     * @param {?} normalizedProperty\n     * @param {?} value\n     * @param {?} errors\n     * @return {?}\n     */\n    function (userProvidedProperty, normalizedProperty, value, errors) {\n        var /** @type {?} */ unit = '';\n        var /** @type {?} */ strVal = value.toString().trim();\n        if (DIMENSIONAL_PROP_MAP[normalizedProperty] && value !== 0 && value !== '0') {\n            if (typeof value === 'number') {\n                unit = 'px';\n            }\n            else {\n                var /** @type {?} */ valAndSuffixMatch = value.match(/^[+-]?[\\d\\.]+([a-z]*)$/);\n                if (valAndSuffixMatch && valAndSuffixMatch[1].length == 0) {\n                    errors.push(\"Please provide a CSS unit value for \" + userProvidedProperty + \":\" + value);\n                }\n            }\n        }\n        return strVal + unit;\n    };\n    return WebAnimationsStyleNormalizer;\n}(AnimationStyleNormalizer));\nvar DIMENSIONAL_PROP_MAP = makeBooleanMap('width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective'\n    .split(','));\n/**\n * @param {?} keys\n * @return {?}\n */\nfunction makeBooleanMap(keys) {\n    var /** @type {?} */ map = {};\n    keys.forEach(function (key) { return map[key] = true; });\n    return map;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @record\n */\n\n/**\n * @param {?} element\n * @param {?} triggerName\n * @param {?} fromState\n * @param {?} toState\n * @param {?} isRemovalTransition\n * @param {?} fromStyles\n * @param {?} toStyles\n * @param {?} timelines\n * @param {?} queriedElements\n * @param {?} preStyleProps\n * @param {?} postStyleProps\n * @param {?} totalTime\n * @param {?=} errors\n * @return {?}\n */\nfunction createTransitionInstruction(element, triggerName, fromState, toState, isRemovalTransition, fromStyles, toStyles, timelines, queriedElements, preStyleProps, postStyleProps, totalTime, errors) {\n    return {\n        type: 0 /* TransitionAnimation */,\n        element: element,\n        triggerName: triggerName,\n        isRemovalTransition: isRemovalTransition,\n        fromState: fromState,\n        fromStyles: fromStyles,\n        toState: toState,\n        toStyles: toStyles,\n        timelines: timelines,\n        queriedElements: queriedElements,\n        preStyleProps: preStyleProps,\n        postStyleProps: postStyleProps,\n        totalTime: totalTime,\n        errors: errors\n    };\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar EMPTY_OBJECT = {};\nvar AnimationTransitionFactory = /** @class */ (function () {\n    function AnimationTransitionFactory(_triggerName, ast, _stateStyles) {\n        this._triggerName = _triggerName;\n        this.ast = ast;\n        this._stateStyles = _stateStyles;\n    }\n    /**\n     * @param {?} currentState\n     * @param {?} nextState\n     * @return {?}\n     */\n    AnimationTransitionFactory.prototype.match = /**\n     * @param {?} currentState\n     * @param {?} nextState\n     * @return {?}\n     */\n    function (currentState, nextState) {\n        return oneOrMoreTransitionsMatch(this.ast.matchers, currentState, nextState);\n    };\n    /**\n     * @param {?} stateName\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationTransitionFactory.prototype.buildStyles = /**\n     * @param {?} stateName\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    function (stateName, params, errors) {\n        var /** @type {?} */ backupStateStyler = this._stateStyles['*'];\n        var /** @type {?} */ stateStyler = this._stateStyles[stateName];\n        var /** @type {?} */ backupStyles = backupStateStyler ? backupStateStyler.buildStyles(params, errors) : {};\n        return stateStyler ? stateStyler.buildStyles(params, errors) : backupStyles;\n    };\n    /**\n     * @param {?} driver\n     * @param {?} element\n     * @param {?} currentState\n     * @param {?} nextState\n     * @param {?} enterClassName\n     * @param {?} leaveClassName\n     * @param {?=} currentOptions\n     * @param {?=} nextOptions\n     * @param {?=} subInstructions\n     * @return {?}\n     */\n    AnimationTransitionFactory.prototype.build = /**\n     * @param {?} driver\n     * @param {?} element\n     * @param {?} currentState\n     * @param {?} nextState\n     * @param {?} enterClassName\n     * @param {?} leaveClassName\n     * @param {?=} currentOptions\n     * @param {?=} nextOptions\n     * @param {?=} subInstructions\n     * @return {?}\n     */\n    function (driver, element, currentState, nextState, enterClassName, leaveClassName, currentOptions, nextOptions, subInstructions) {\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ transitionAnimationParams = this.ast.options && this.ast.options.params || EMPTY_OBJECT;\n        var /** @type {?} */ currentAnimationParams = currentOptions && currentOptions.params || EMPTY_OBJECT;\n        var /** @type {?} */ currentStateStyles = this.buildStyles(currentState, currentAnimationParams, errors);\n        var /** @type {?} */ nextAnimationParams = nextOptions && nextOptions.params || EMPTY_OBJECT;\n        var /** @type {?} */ nextStateStyles = this.buildStyles(nextState, nextAnimationParams, errors);\n        var /** @type {?} */ queriedElements = new Set();\n        var /** @type {?} */ preStyleMap = new Map();\n        var /** @type {?} */ postStyleMap = new Map();\n        var /** @type {?} */ isRemoval = nextState === 'void';\n        var /** @type {?} */ animationOptions = { params: __assign({}, transitionAnimationParams, nextAnimationParams) };\n        var /** @type {?} */ timelines = buildAnimationTimelines(driver, element, this.ast.animation, enterClassName, leaveClassName, currentStateStyles, nextStateStyles, animationOptions, subInstructions, errors);\n        var /** @type {?} */ totalTime = 0;\n        timelines.forEach(function (tl) { totalTime = Math.max(tl.duration + tl.delay, totalTime); });\n        if (errors.length) {\n            return createTransitionInstruction(element, this._triggerName, currentState, nextState, isRemoval, currentStateStyles, nextStateStyles, [], [], preStyleMap, postStyleMap, totalTime, errors);\n        }\n        timelines.forEach(function (tl) {\n            var /** @type {?} */ elm = tl.element;\n            var /** @type {?} */ preProps = getOrSetAsInMap(preStyleMap, elm, {});\n            tl.preStyleProps.forEach(function (prop) { return preProps[prop] = true; });\n            var /** @type {?} */ postProps = getOrSetAsInMap(postStyleMap, elm, {});\n            tl.postStyleProps.forEach(function (prop) { return postProps[prop] = true; });\n            if (elm !== element) {\n                queriedElements.add(elm);\n            }\n        });\n        var /** @type {?} */ queriedElementsList = iteratorToArray(queriedElements.values());\n        return createTransitionInstruction(element, this._triggerName, currentState, nextState, isRemoval, currentStateStyles, nextStateStyles, timelines, queriedElementsList, preStyleMap, postStyleMap, totalTime);\n    };\n    return AnimationTransitionFactory;\n}());\n/**\n * @param {?} matchFns\n * @param {?} currentState\n * @param {?} nextState\n * @return {?}\n */\nfunction oneOrMoreTransitionsMatch(matchFns, currentState, nextState) {\n    return matchFns.some(function (fn) { return fn(currentState, nextState); });\n}\nvar AnimationStateStyles = /** @class */ (function () {\n    function AnimationStateStyles(styles, defaultParams) {\n        this.styles = styles;\n        this.defaultParams = defaultParams;\n    }\n    /**\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationStateStyles.prototype.buildStyles = /**\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    function (params, errors) {\n        var /** @type {?} */ finalStyles = {};\n        var /** @type {?} */ combinedParams = copyObj(this.defaultParams);\n        Object.keys(params).forEach(function (key) {\n            var /** @type {?} */ value = params[key];\n            if (value != null) {\n                combinedParams[key] = value;\n            }\n        });\n        this.styles.styles.forEach(function (value) {\n            if (typeof value !== 'string') {\n                var /** @type {?} */ styleObj_1 = /** @type {?} */ (value);\n                Object.keys(styleObj_1).forEach(function (prop) {\n                    var /** @type {?} */ val = styleObj_1[prop];\n                    if (val.length > 1) {\n                        val = interpolateParams(val, combinedParams, errors);\n                    }\n                    finalStyles[prop] = val;\n                });\n            }\n        });\n        return finalStyles;\n    };\n    return AnimationStateStyles;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * \\@experimental Animation support is experimental.\n * @param {?} name\n * @param {?} ast\n * @return {?}\n */\nfunction buildTrigger(name, ast) {\n    return new AnimationTrigger(name, ast);\n}\n/**\n * \\@experimental Animation support is experimental.\n */\nvar AnimationTrigger = /** @class */ (function () {\n    function AnimationTrigger(name, ast) {\n        var _this = this;\n        this.name = name;\n        this.ast = ast;\n        this.transitionFactories = [];\n        this.states = {};\n        ast.states.forEach(function (ast) {\n            var /** @type {?} */ defaultParams = (ast.options && ast.options.params) || {};\n            _this.states[ast.name] = new AnimationStateStyles(ast.style, defaultParams);\n        });\n        balanceProperties(this.states, 'true', '1');\n        balanceProperties(this.states, 'false', '0');\n        ast.transitions.forEach(function (ast) {\n            _this.transitionFactories.push(new AnimationTransitionFactory(name, ast, _this.states));\n        });\n        this.fallbackTransition = createFallbackTransition(name, this.states);\n    }\n    Object.defineProperty(AnimationTrigger.prototype, \"containsQueries\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return this.ast.queryCount > 0; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} currentState\n     * @param {?} nextState\n     * @return {?}\n     */\n    AnimationTrigger.prototype.matchTransition = /**\n     * @param {?} currentState\n     * @param {?} nextState\n     * @return {?}\n     */\n    function (currentState, nextState) {\n        var /** @type {?} */ entry = this.transitionFactories.find(function (f) { return f.match(currentState, nextState); });\n        return entry || null;\n    };\n    /**\n     * @param {?} currentState\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    AnimationTrigger.prototype.matchStyles = /**\n     * @param {?} currentState\n     * @param {?} params\n     * @param {?} errors\n     * @return {?}\n     */\n    function (currentState, params, errors) {\n        return this.fallbackTransition.buildStyles(currentState, params, errors);\n    };\n    return AnimationTrigger;\n}());\n/**\n * @param {?} triggerName\n * @param {?} states\n * @return {?}\n */\nfunction createFallbackTransition(triggerName, states) {\n    var /** @type {?} */ matchers = [function (fromState, toState) { return true; }];\n    var /** @type {?} */ animation = { type: 2 /* Sequence */, steps: [], options: null };\n    var /** @type {?} */ transition = {\n        type: 1 /* Transition */,\n        animation: animation,\n        matchers: matchers,\n        options: null,\n        queryCount: 0,\n        depCount: 0\n    };\n    return new AnimationTransitionFactory(triggerName, transition, states);\n}\n/**\n * @param {?} obj\n * @param {?} key1\n * @param {?} key2\n * @return {?}\n */\nfunction balanceProperties(obj, key1, key2) {\n    if (obj.hasOwnProperty(key1)) {\n        if (!obj.hasOwnProperty(key2)) {\n            obj[key2] = obj[key1];\n        }\n    }\n    else if (obj.hasOwnProperty(key2)) {\n        obj[key1] = obj[key2];\n    }\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar EMPTY_INSTRUCTION_MAP = new ElementInstructionMap();\nvar TimelineAnimationEngine = /** @class */ (function () {\n    function TimelineAnimationEngine(_driver, _normalizer) {\n        this._driver = _driver;\n        this._normalizer = _normalizer;\n        this._animations = {};\n        this._playersById = {};\n        this.players = [];\n    }\n    /**\n     * @param {?} id\n     * @param {?} metadata\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.register = /**\n     * @param {?} id\n     * @param {?} metadata\n     * @return {?}\n     */\n    function (id, metadata) {\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ ast = buildAnimationAst(this._driver, metadata, errors);\n        if (errors.length) {\n            throw new Error(\"Unable to build the animation due to the following errors: \" + errors.join(\"\\n\"));\n        }\n        else {\n            this._animations[id] = ast;\n        }\n    };\n    /**\n     * @param {?} i\n     * @param {?} preStyles\n     * @param {?=} postStyles\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype._buildPlayer = /**\n     * @param {?} i\n     * @param {?} preStyles\n     * @param {?=} postStyles\n     * @return {?}\n     */\n    function (i, preStyles, postStyles) {\n        var /** @type {?} */ element = i.element;\n        var /** @type {?} */ keyframes = normalizeKeyframes(this._driver, this._normalizer, element, i.keyframes, preStyles, postStyles);\n        return this._driver.animate(element, keyframes, i.duration, i.delay, i.easing, [], true);\n    };\n    /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?=} options\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.create = /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?=} options\n     * @return {?}\n     */\n    function (id, element, options) {\n        var _this = this;\n        if (options === void 0) { options = {}; }\n        var /** @type {?} */ errors = [];\n        var /** @type {?} */ ast = this._animations[id];\n        var /** @type {?} */ instructions;\n        var /** @type {?} */ autoStylesMap = new Map();\n        if (ast) {\n            instructions = buildAnimationTimelines(this._driver, element, ast, ENTER_CLASSNAME, LEAVE_CLASSNAME, {}, {}, options, EMPTY_INSTRUCTION_MAP, errors);\n            instructions.forEach(function (inst) {\n                var /** @type {?} */ styles = getOrSetAsInMap(autoStylesMap, inst.element, {});\n                inst.postStyleProps.forEach(function (prop) { return styles[prop] = null; });\n            });\n        }\n        else {\n            errors.push('The requested animation doesn\\'t exist or has already been destroyed');\n            instructions = [];\n        }\n        if (errors.length) {\n            throw new Error(\"Unable to create the animation due to the following errors: \" + errors.join(\"\\n\"));\n        }\n        autoStylesMap.forEach(function (styles, element) {\n            Object.keys(styles).forEach(function (prop) { styles[prop] = _this._driver.computeStyle(element, prop, _angular_animations.AUTO_STYLE); });\n        });\n        var /** @type {?} */ players = instructions.map(function (i) {\n            var /** @type {?} */ styles = autoStylesMap.get(i.element);\n            return _this._buildPlayer(i, {}, styles);\n        });\n        var /** @type {?} */ player = optimizeGroupPlayer(players);\n        this._playersById[id] = player;\n        player.onDestroy(function () { return _this.destroy(id); });\n        this.players.push(player);\n        return player;\n    };\n    /**\n     * @param {?} id\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.destroy = /**\n     * @param {?} id\n     * @return {?}\n     */\n    function (id) {\n        var /** @type {?} */ player = this._getPlayer(id);\n        player.destroy();\n        delete this._playersById[id];\n        var /** @type {?} */ index = this.players.indexOf(player);\n        if (index >= 0) {\n            this.players.splice(index, 1);\n        }\n    };\n    /**\n     * @param {?} id\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype._getPlayer = /**\n     * @param {?} id\n     * @return {?}\n     */\n    function (id) {\n        var /** @type {?} */ player = this._playersById[id];\n        if (!player) {\n            throw new Error(\"Unable to find the timeline player referenced by \" + id);\n        }\n        return player;\n    };\n    /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?} eventName\n     * @param {?} callback\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.listen = /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?} eventName\n     * @param {?} callback\n     * @return {?}\n     */\n    function (id, element, eventName, callback) {\n        // triggerName, fromState, toState are all ignored for timeline animations\n        var /** @type {?} */ baseEvent = makeAnimationEvent(element, '', '', '');\n        listenOnPlayer(this._getPlayer(id), eventName, baseEvent, callback);\n        return function () { };\n    };\n    /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?} command\n     * @param {?} args\n     * @return {?}\n     */\n    TimelineAnimationEngine.prototype.command = /**\n     * @param {?} id\n     * @param {?} element\n     * @param {?} command\n     * @param {?} args\n     * @return {?}\n     */\n    function (id, element, command, args) {\n        if (command == 'register') {\n            this.register(id, /** @type {?} */ (args[0]));\n            return;\n        }\n        if (command == 'create') {\n            var /** @type {?} */ options = /** @type {?} */ ((args[0] || {}));\n            this.create(id, element, options);\n            return;\n        }\n        var /** @type {?} */ player = this._getPlayer(id);\n        switch (command) {\n            case 'play':\n                player.play();\n                break;\n            case 'pause':\n                player.pause();\n                break;\n            case 'reset':\n                player.reset();\n                break;\n            case 'restart':\n                player.restart();\n                break;\n            case 'finish':\n                player.finish();\n                break;\n            case 'init':\n                player.init();\n                break;\n            case 'setPosition':\n                player.setPosition(parseFloat(/** @type {?} */ (args[0])));\n                break;\n            case 'destroy':\n                this.destroy(id);\n                break;\n        }\n    };\n    return TimelineAnimationEngine;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar QUEUED_CLASSNAME = 'ng-animate-queued';\nvar QUEUED_SELECTOR = '.ng-animate-queued';\nvar DISABLED_CLASSNAME = 'ng-animate-disabled';\nvar DISABLED_SELECTOR = '.ng-animate-disabled';\nvar STAR_CLASSNAME = 'ng-star-inserted';\nvar STAR_SELECTOR = '.ng-star-inserted';\nvar EMPTY_PLAYER_ARRAY = [];\nvar NULL_REMOVAL_STATE = {\n    namespaceId: '',\n    setForRemoval: null,\n    hasAnimation: false,\n    removedBeforeQueried: false\n};\nvar NULL_REMOVED_QUERIED_STATE = {\n    namespaceId: '',\n    setForRemoval: null,\n    hasAnimation: false,\n    removedBeforeQueried: true\n};\n/**\n * @record\n */\n\nvar REMOVAL_FLAG = '__ng_removed';\n/**\n * @record\n */\n\nvar StateValue = /** @class */ (function () {\n    function StateValue(input, namespaceId) {\n        if (namespaceId === void 0) { namespaceId = ''; }\n        this.namespaceId = namespaceId;\n        var /** @type {?} */ isObj = input && input.hasOwnProperty('value');\n        var /** @type {?} */ value = isObj ? input['value'] : input;\n        this.value = normalizeTriggerValue(value);\n        if (isObj) {\n            var /** @type {?} */ options = copyObj(/** @type {?} */ (input));\n            delete options['value'];\n            this.options = /** @type {?} */ (options);\n        }\n        else {\n            this.options = {};\n        }\n        if (!this.options.params) {\n            this.options.params = {};\n        }\n    }\n    Object.defineProperty(StateValue.prototype, \"params\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return /** @type {?} */ (this.options.params); },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} options\n     * @return {?}\n     */\n    StateValue.prototype.absorbOptions = /**\n     * @param {?} options\n     * @return {?}\n     */\n    function (options) {\n        var /** @type {?} */ newParams = options.params;\n        if (newParams) {\n            var /** @type {?} */ oldParams_1 = /** @type {?} */ ((this.options.params));\n            Object.keys(newParams).forEach(function (prop) {\n                if (oldParams_1[prop] == null) {\n                    oldParams_1[prop] = newParams[prop];\n                }\n            });\n        }\n    };\n    return StateValue;\n}());\nvar VOID_VALUE = 'void';\nvar DEFAULT_STATE_VALUE = new StateValue(VOID_VALUE);\nvar DELETED_STATE_VALUE = new StateValue('DELETED');\nvar AnimationTransitionNamespace = /** @class */ (function () {\n    function AnimationTransitionNamespace(id, hostElement, _engine) {\n        this.id = id;\n        this.hostElement = hostElement;\n        this._engine = _engine;\n        this.players = [];\n        this._triggers = {};\n        this._queue = [];\n        this._elementListeners = new Map();\n        this._hostClassName = 'ng-tns-' + id;\n        addClass(hostElement, this._hostClassName);\n    }\n    /**\n     * @param {?} element\n     * @param {?} name\n     * @param {?} phase\n     * @param {?} callback\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.listen = /**\n     * @param {?} element\n     * @param {?} name\n     * @param {?} phase\n     * @param {?} callback\n     * @return {?}\n     */\n    function (element, name, phase, callback) {\n        var _this = this;\n        if (!this._triggers.hasOwnProperty(name)) {\n            throw new Error(\"Unable to listen on the animation trigger event \\\"\" + phase + \"\\\" because the animation trigger \\\"\" + name + \"\\\" doesn't exist!\");\n        }\n        if (phase == null || phase.length == 0) {\n            throw new Error(\"Unable to listen on the animation trigger \\\"\" + name + \"\\\" because the provided event is undefined!\");\n        }\n        if (!isTriggerEventValid(phase)) {\n            throw new Error(\"The provided animation trigger event \\\"\" + phase + \"\\\" for the animation trigger \\\"\" + name + \"\\\" is not supported!\");\n        }\n        var /** @type {?} */ listeners = getOrSetAsInMap(this._elementListeners, element, []);\n        var /** @type {?} */ data = { name: name, phase: phase, callback: callback };\n        listeners.push(data);\n        var /** @type {?} */ triggersWithStates = getOrSetAsInMap(this._engine.statesByElement, element, {});\n        if (!triggersWithStates.hasOwnProperty(name)) {\n            addClass(element, NG_TRIGGER_CLASSNAME);\n            addClass(element, NG_TRIGGER_CLASSNAME + '-' + name);\n            triggersWithStates[name] = DEFAULT_STATE_VALUE;\n        }\n        return function () {\n            // the event listener is removed AFTER the flush has occurred such\n            // that leave animations callbacks can fire (otherwise if the node\n            // is removed in between then the listeners would be deregistered)\n            // the event listener is removed AFTER the flush has occurred such\n            // that leave animations callbacks can fire (otherwise if the node\n            // is removed in between then the listeners would be deregistered)\n            _this._engine.afterFlush(function () {\n                var /** @type {?} */ index = listeners.indexOf(data);\n                if (index >= 0) {\n                    listeners.splice(index, 1);\n                }\n                if (!_this._triggers[name]) {\n                    delete triggersWithStates[name];\n                }\n            });\n        };\n    };\n    /**\n     * @param {?} name\n     * @param {?} ast\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.register = /**\n     * @param {?} name\n     * @param {?} ast\n     * @return {?}\n     */\n    function (name, ast) {\n        if (this._triggers[name]) {\n            // throw\n            return false;\n        }\n        else {\n            this._triggers[name] = ast;\n            return true;\n        }\n    };\n    /**\n     * @param {?} name\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype._getTrigger = /**\n     * @param {?} name\n     * @return {?}\n     */\n    function (name) {\n        var /** @type {?} */ trigger = this._triggers[name];\n        if (!trigger) {\n            throw new Error(\"The provided animation trigger \\\"\" + name + \"\\\" has not been registered!\");\n        }\n        return trigger;\n    };\n    /**\n     * @param {?} element\n     * @param {?} triggerName\n     * @param {?} value\n     * @param {?=} defaultToFallback\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.trigger = /**\n     * @param {?} element\n     * @param {?} triggerName\n     * @param {?} value\n     * @param {?=} defaultToFallback\n     * @return {?}\n     */\n    function (element, triggerName, value, defaultToFallback) {\n        var _this = this;\n        if (defaultToFallback === void 0) { defaultToFallback = true; }\n        var /** @type {?} */ trigger = this._getTrigger(triggerName);\n        var /** @type {?} */ player = new TransitionAnimationPlayer(this.id, triggerName, element);\n        var /** @type {?} */ triggersWithStates = this._engine.statesByElement.get(element);\n        if (!triggersWithStates) {\n            addClass(element, NG_TRIGGER_CLASSNAME);\n            addClass(element, NG_TRIGGER_CLASSNAME + '-' + triggerName);\n            this._engine.statesByElement.set(element, triggersWithStates = {});\n        }\n        var /** @type {?} */ fromState = triggersWithStates[triggerName];\n        var /** @type {?} */ toState = new StateValue(value, this.id);\n        var /** @type {?} */ isObj = value && value.hasOwnProperty('value');\n        if (!isObj && fromState) {\n            toState.absorbOptions(fromState.options);\n        }\n        triggersWithStates[triggerName] = toState;\n        if (!fromState) {\n            fromState = DEFAULT_STATE_VALUE;\n        }\n        else if (fromState === DELETED_STATE_VALUE) {\n            return player;\n        }\n        var /** @type {?} */ isRemoval = toState.value === VOID_VALUE;\n        // normally this isn't reached by here, however, if an object expression\n        // is passed in then it may be a new object each time. Comparing the value\n        // is important since that will stay the same despite there being a new object.\n        // The removal arc here is special cased because the same element is triggered\n        // twice in the event that it contains animations on the outer/inner portions\n        // of the host container\n        if (!isRemoval && fromState.value === toState.value) {\n            // this means that despite the value not changing, some inner params\n            // have changed which means that the animation final styles need to be applied\n            if (!objEquals(fromState.params, toState.params)) {\n                var /** @type {?} */ errors = [];\n                var /** @type {?} */ fromStyles_1 = trigger.matchStyles(fromState.value, fromState.params, errors);\n                var /** @type {?} */ toStyles_1 = trigger.matchStyles(toState.value, toState.params, errors);\n                if (errors.length) {\n                    this._engine.reportError(errors);\n                }\n                else {\n                    this._engine.afterFlush(function () {\n                        eraseStyles(element, fromStyles_1);\n                        setStyles(element, toStyles_1);\n                    });\n                }\n            }\n            return;\n        }\n        var /** @type {?} */ playersOnElement = getOrSetAsInMap(this._engine.playersByElement, element, []);\n        playersOnElement.forEach(function (player) {\n            // only remove the player if it is queued on the EXACT same trigger/namespace\n            // we only also deal with queued players here because if the animation has\n            // started then we want to keep the player alive until the flush happens\n            // (which is where the previousPlayers are passed into the new palyer)\n            if (player.namespaceId == _this.id && player.triggerName == triggerName && player.queued) {\n                player.destroy();\n            }\n        });\n        var /** @type {?} */ transition = trigger.matchTransition(fromState.value, toState.value);\n        var /** @type {?} */ isFallbackTransition = false;\n        if (!transition) {\n            if (!defaultToFallback)\n                return;\n            transition = trigger.fallbackTransition;\n            isFallbackTransition = true;\n        }\n        this._engine.totalQueuedPlayers++;\n        this._queue.push({ element: element, triggerName: triggerName, transition: transition, fromState: fromState, toState: toState, player: player, isFallbackTransition: isFallbackTransition });\n        if (!isFallbackTransition) {\n            addClass(element, QUEUED_CLASSNAME);\n            player.onStart(function () { removeClass(element, QUEUED_CLASSNAME); });\n        }\n        player.onDone(function () {\n            var /** @type {?} */ index = _this.players.indexOf(player);\n            if (index >= 0) {\n                _this.players.splice(index, 1);\n            }\n            var /** @type {?} */ players = _this._engine.playersByElement.get(element);\n            if (players) {\n                var /** @type {?} */ index_1 = players.indexOf(player);\n                if (index_1 >= 0) {\n                    players.splice(index_1, 1);\n                }\n            }\n        });\n        this.players.push(player);\n        playersOnElement.push(player);\n        return player;\n    };\n    /**\n     * @param {?} name\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.deregister = /**\n     * @param {?} name\n     * @return {?}\n     */\n    function (name) {\n        var _this = this;\n        delete this._triggers[name];\n        this._engine.statesByElement.forEach(function (stateMap, element) { delete stateMap[name]; });\n        this._elementListeners.forEach(function (listeners, element) {\n            _this._elementListeners.set(element, listeners.filter(function (entry) { return entry.name != name; }));\n        });\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.clearElementCache = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        this._engine.statesByElement.delete(element);\n        this._elementListeners.delete(element);\n        var /** @type {?} */ elementPlayers = this._engine.playersByElement.get(element);\n        if (elementPlayers) {\n            elementPlayers.forEach(function (player) { return player.destroy(); });\n            this._engine.playersByElement.delete(element);\n        }\n    };\n    /**\n     * @param {?} rootElement\n     * @param {?} context\n     * @param {?=} animate\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype._signalRemovalForInnerTriggers = /**\n     * @param {?} rootElement\n     * @param {?} context\n     * @param {?=} animate\n     * @return {?}\n     */\n    function (rootElement, context, animate) {\n        var _this = this;\n        if (animate === void 0) { animate = false; }\n        // emulate a leave animation for all inner nodes within this node.\n        // If there are no animations found for any of the nodes then clear the cache\n        // for the element.\n        this._engine.driver.query(rootElement, NG_TRIGGER_SELECTOR, true).forEach(function (elm) {\n            // this means that an inner remove() operation has already kicked off\n            // the animation on this element...\n            if (elm[REMOVAL_FLAG])\n                return;\n            var /** @type {?} */ namespaces = _this._engine.fetchNamespacesByElement(elm);\n            if (namespaces.size) {\n                namespaces.forEach(function (ns) { return ns.triggerLeaveAnimation(elm, context, false, true); });\n            }\n            else {\n                _this.clearElementCache(elm);\n            }\n        });\n    };\n    /**\n     * @param {?} element\n     * @param {?} context\n     * @param {?=} destroyAfterComplete\n     * @param {?=} defaultToFallback\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.triggerLeaveAnimation = /**\n     * @param {?} element\n     * @param {?} context\n     * @param {?=} destroyAfterComplete\n     * @param {?=} defaultToFallback\n     * @return {?}\n     */\n    function (element, context, destroyAfterComplete, defaultToFallback) {\n        var _this = this;\n        var /** @type {?} */ triggerStates = this._engine.statesByElement.get(element);\n        if (triggerStates) {\n            var /** @type {?} */ players_1 = [];\n            Object.keys(triggerStates).forEach(function (triggerName) {\n                // this check is here in the event that an element is removed\n                // twice (both on the host level and the component level)\n                if (_this._triggers[triggerName]) {\n                    var /** @type {?} */ player = _this.trigger(element, triggerName, VOID_VALUE, defaultToFallback);\n                    if (player) {\n                        players_1.push(player);\n                    }\n                }\n            });\n            if (players_1.length) {\n                this._engine.markElementAsRemoved(this.id, element, true, context);\n                if (destroyAfterComplete) {\n                    optimizeGroupPlayer(players_1).onDone(function () { return _this._engine.processLeaveNode(element); });\n                }\n                return true;\n            }\n        }\n        return false;\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.prepareLeaveAnimationListeners = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        var _this = this;\n        var /** @type {?} */ listeners = this._elementListeners.get(element);\n        if (listeners) {\n            var /** @type {?} */ visitedTriggers_1 = new Set();\n            listeners.forEach(function (listener) {\n                var /** @type {?} */ triggerName = listener.name;\n                if (visitedTriggers_1.has(triggerName))\n                    return;\n                visitedTriggers_1.add(triggerName);\n                var /** @type {?} */ trigger = _this._triggers[triggerName];\n                var /** @type {?} */ transition = trigger.fallbackTransition;\n                var /** @type {?} */ elementStates = /** @type {?} */ ((_this._engine.statesByElement.get(element)));\n                var /** @type {?} */ fromState = elementStates[triggerName] || DEFAULT_STATE_VALUE;\n                var /** @type {?} */ toState = new StateValue(VOID_VALUE);\n                var /** @type {?} */ player = new TransitionAnimationPlayer(_this.id, triggerName, element);\n                _this._engine.totalQueuedPlayers++;\n                _this._queue.push({\n                    element: element,\n                    triggerName: triggerName,\n                    transition: transition,\n                    fromState: fromState,\n                    toState: toState,\n                    player: player,\n                    isFallbackTransition: true\n                });\n            });\n        }\n    };\n    /**\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.removeNode = /**\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    function (element, context) {\n        var _this = this;\n        var /** @type {?} */ engine = this._engine;\n        if (element.childElementCount) {\n            this._signalRemovalForInnerTriggers(element, context, true);\n        }\n        // this means that a * => VOID animation was detected and kicked off\n        if (this.triggerLeaveAnimation(element, context, true))\n            return;\n        // find the player that is animating and make sure that the\n        // removal is delayed until that player has completed\n        var /** @type {?} */ containsPotentialParentTransition = false;\n        if (engine.totalAnimations) {\n            var /** @type {?} */ currentPlayers = engine.players.length ? engine.playersByQueriedElement.get(element) : [];\n            // when this `if statement` does not continue forward it means that\n            // a previous animation query has selected the current element and\n            // is animating it. In this situation want to continue fowards and\n            // allow the element to be queued up for animation later.\n            if (currentPlayers && currentPlayers.length) {\n                containsPotentialParentTransition = true;\n            }\n            else {\n                var /** @type {?} */ parent_1 = element;\n                while (parent_1 = parent_1.parentNode) {\n                    var /** @type {?} */ triggers = engine.statesByElement.get(parent_1);\n                    if (triggers) {\n                        containsPotentialParentTransition = true;\n                        break;\n                    }\n                }\n            }\n        }\n        // at this stage we know that the element will either get removed\n        // during flush or will be picked up by a parent query. Either way\n        // we need to fire the listeners for this element when it DOES get\n        // removed (once the query parent animation is done or after flush)\n        this.prepareLeaveAnimationListeners(element);\n        // whether or not a parent has an animation we need to delay the deferral of the leave\n        // operation until we have more information (which we do after flush() has been called)\n        if (containsPotentialParentTransition) {\n            engine.markElementAsRemoved(this.id, element, false, context);\n        }\n        else {\n            // we do this after the flush has occurred such\n            // that the callbacks can be fired\n            engine.afterFlush(function () { return _this.clearElementCache(element); });\n            engine.destroyInnerAnimations(element);\n            engine._onRemovalComplete(element, context);\n        }\n    };\n    /**\n     * @param {?} element\n     * @param {?} parent\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.insertNode = /**\n     * @param {?} element\n     * @param {?} parent\n     * @return {?}\n     */\n    function (element, parent) { addClass(element, this._hostClassName); };\n    /**\n     * @param {?} microtaskId\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.drainQueuedTransitions = /**\n     * @param {?} microtaskId\n     * @return {?}\n     */\n    function (microtaskId) {\n        var _this = this;\n        var /** @type {?} */ instructions = [];\n        this._queue.forEach(function (entry) {\n            var /** @type {?} */ player = entry.player;\n            if (player.destroyed)\n                return;\n            var /** @type {?} */ element = entry.element;\n            var /** @type {?} */ listeners = _this._elementListeners.get(element);\n            if (listeners) {\n                listeners.forEach(function (listener) {\n                    if (listener.name == entry.triggerName) {\n                        var /** @type {?} */ baseEvent = makeAnimationEvent(element, entry.triggerName, entry.fromState.value, entry.toState.value);\n                        (/** @type {?} */ (baseEvent))['_data'] = microtaskId;\n                        listenOnPlayer(entry.player, listener.phase, baseEvent, listener.callback);\n                    }\n                });\n            }\n            if (player.markedForDestroy) {\n                _this._engine.afterFlush(function () {\n                    // now we can destroy the element properly since the event listeners have\n                    // been bound to the player\n                    player.destroy();\n                });\n            }\n            else {\n                instructions.push(entry);\n            }\n        });\n        this._queue = [];\n        return instructions.sort(function (a, b) {\n            // if depCount == 0 them move to front\n            // otherwise if a contains b then move back\n            var /** @type {?} */ d0 = a.transition.ast.depCount;\n            var /** @type {?} */ d1 = b.transition.ast.depCount;\n            if (d0 == 0 || d1 == 0) {\n                return d0 - d1;\n            }\n            return _this._engine.driver.containsElement(a.element, b.element) ? 1 : -1;\n        });\n    };\n    /**\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.destroy = /**\n     * @param {?} context\n     * @return {?}\n     */\n    function (context) {\n        this.players.forEach(function (p) { return p.destroy(); });\n        this._signalRemovalForInnerTriggers(this.hostElement, context);\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    AnimationTransitionNamespace.prototype.elementContainsData = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        var /** @type {?} */ containsData = false;\n        if (this._elementListeners.has(element))\n            containsData = true;\n        containsData =\n            (this._queue.find(function (entry) { return entry.element === element; }) ? true : false) || containsData;\n        return containsData;\n    };\n    return AnimationTransitionNamespace;\n}());\n/**\n * @record\n */\n\nvar TransitionAnimationEngine = /** @class */ (function () {\n    function TransitionAnimationEngine(driver, _normalizer) {\n        this.driver = driver;\n        this._normalizer = _normalizer;\n        this.players = [];\n        this.newHostElements = new Map();\n        this.playersByElement = new Map();\n        this.playersByQueriedElement = new Map();\n        this.statesByElement = new Map();\n        this.disabledNodes = new Set();\n        this.totalAnimations = 0;\n        this.totalQueuedPlayers = 0;\n        this._namespaceLookup = {};\n        this._namespaceList = [];\n        this._flushFns = [];\n        this._whenQuietFns = [];\n        this.namespacesByHostElement = new Map();\n        this.collectedEnterElements = [];\n        this.collectedLeaveElements = [];\n        this.onRemovalComplete = function (element, context) { };\n    }\n    /** @internal */\n    /**\n     * \\@internal\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._onRemovalComplete = /**\n     * \\@internal\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    function (element, context) { this.onRemovalComplete(element, context); };\n    Object.defineProperty(TransitionAnimationEngine.prototype, \"queuedPlayers\", {\n        get: /**\n         * @return {?}\n         */\n        function () {\n            var /** @type {?} */ players = [];\n            this._namespaceList.forEach(function (ns) {\n                ns.players.forEach(function (player) {\n                    if (player.queued) {\n                        players.push(player);\n                    }\n                });\n            });\n            return players;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.createNamespace = /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    function (namespaceId, hostElement) {\n        var /** @type {?} */ ns = new AnimationTransitionNamespace(namespaceId, hostElement, this);\n        if (hostElement.parentNode) {\n            this._balanceNamespaceList(ns, hostElement);\n        }\n        else {\n            // defer this later until flush during when the host element has\n            // been inserted so that we know exactly where to place it in\n            // the namespace list\n            this.newHostElements.set(hostElement, ns);\n            // given that this host element is apart of the animation code, it\n            // may or may not be inserted by a parent node that is an of an\n            // animation renderer type. If this happens then we can still have\n            // access to this item when we query for :enter nodes. If the parent\n            // is a renderer then the set data-structure will normalize the entry\n            this.collectEnterElement(hostElement);\n        }\n        return this._namespaceLookup[namespaceId] = ns;\n    };\n    /**\n     * @param {?} ns\n     * @param {?} hostElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._balanceNamespaceList = /**\n     * @param {?} ns\n     * @param {?} hostElement\n     * @return {?}\n     */\n    function (ns, hostElement) {\n        var /** @type {?} */ limit = this._namespaceList.length - 1;\n        if (limit >= 0) {\n            var /** @type {?} */ found = false;\n            for (var /** @type {?} */ i = limit; i >= 0; i--) {\n                var /** @type {?} */ nextNamespace = this._namespaceList[i];\n                if (this.driver.containsElement(nextNamespace.hostElement, hostElement)) {\n                    this._namespaceList.splice(i + 1, 0, ns);\n                    found = true;\n                    break;\n                }\n            }\n            if (!found) {\n                this._namespaceList.splice(0, 0, ns);\n            }\n        }\n        else {\n            this._namespaceList.push(ns);\n        }\n        this.namespacesByHostElement.set(hostElement, ns);\n        return ns;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.register = /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    function (namespaceId, hostElement) {\n        var /** @type {?} */ ns = this._namespaceLookup[namespaceId];\n        if (!ns) {\n            ns = this.createNamespace(namespaceId, hostElement);\n        }\n        return ns;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} name\n     * @param {?} trigger\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.registerTrigger = /**\n     * @param {?} namespaceId\n     * @param {?} name\n     * @param {?} trigger\n     * @return {?}\n     */\n    function (namespaceId, name, trigger) {\n        var /** @type {?} */ ns = this._namespaceLookup[namespaceId];\n        if (ns && ns.register(name, trigger)) {\n            this.totalAnimations++;\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} context\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.destroy = /**\n     * @param {?} namespaceId\n     * @param {?} context\n     * @return {?}\n     */\n    function (namespaceId, context) {\n        var _this = this;\n        if (!namespaceId)\n            return;\n        var /** @type {?} */ ns = this._fetchNamespace(namespaceId);\n        this.afterFlush(function () {\n            _this.namespacesByHostElement.delete(ns.hostElement);\n            delete _this._namespaceLookup[namespaceId];\n            var /** @type {?} */ index = _this._namespaceList.indexOf(ns);\n            if (index >= 0) {\n                _this._namespaceList.splice(index, 1);\n            }\n        });\n        this.afterFlushAnimationsDone(function () { return ns.destroy(context); });\n    };\n    /**\n     * @param {?} id\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._fetchNamespace = /**\n     * @param {?} id\n     * @return {?}\n     */\n    function (id) { return this._namespaceLookup[id]; };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.fetchNamespacesByElement = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        // normally there should only be one namespace per element, however\n        // if @triggers are placed on both the component element and then\n        // its host element (within the component code) then there will be\n        // two namespaces returned. We use a set here to simply the dedupe\n        // of namespaces incase there are multiple triggers both the elm and host\n        var /** @type {?} */ namespaces = new Set();\n        var /** @type {?} */ elementStates = this.statesByElement.get(element);\n        if (elementStates) {\n            var /** @type {?} */ keys = Object.keys(elementStates);\n            for (var /** @type {?} */ i = 0; i < keys.length; i++) {\n                var /** @type {?} */ nsId = elementStates[keys[i]].namespaceId;\n                if (nsId) {\n                    var /** @type {?} */ ns = this._fetchNamespace(nsId);\n                    if (ns) {\n                        namespaces.add(ns);\n                    }\n                }\n            }\n        }\n        return namespaces;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} name\n     * @param {?} value\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.trigger = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} name\n     * @param {?} value\n     * @return {?}\n     */\n    function (namespaceId, element, name, value) {\n        if (isElementNode(element)) {\n            this._fetchNamespace(namespaceId).trigger(element, name, value);\n            return true;\n        }\n        return false;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} parent\n     * @param {?} insertBefore\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.insertNode = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} parent\n     * @param {?} insertBefore\n     * @return {?}\n     */\n    function (namespaceId, element, parent, insertBefore) {\n        if (!isElementNode(element))\n            return;\n        // special case for when an element is removed and reinserted (move operation)\n        // when this occurs we do not want to use the element for deletion later\n        var /** @type {?} */ details = /** @type {?} */ (element[REMOVAL_FLAG]);\n        if (details && details.setForRemoval) {\n            details.setForRemoval = false;\n        }\n        // in the event that the namespaceId is blank then the caller\n        // code does not contain any animation code in it, but it is\n        // just being called so that the node is marked as being inserted\n        if (namespaceId) {\n            this._fetchNamespace(namespaceId).insertNode(element, parent);\n        }\n        // only *directives and host elements are inserted before\n        if (insertBefore) {\n            this.collectEnterElement(element);\n        }\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.collectEnterElement = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) { this.collectedEnterElements.push(element); };\n    /**\n     * @param {?} element\n     * @param {?} value\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.markElementAsDisabled = /**\n     * @param {?} element\n     * @param {?} value\n     * @return {?}\n     */\n    function (element, value) {\n        if (value) {\n            if (!this.disabledNodes.has(element)) {\n                this.disabledNodes.add(element);\n                addClass(element, DISABLED_CLASSNAME);\n            }\n        }\n        else if (this.disabledNodes.has(element)) {\n            this.disabledNodes.delete(element);\n            removeClass(element, DISABLED_CLASSNAME);\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.removeNode = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    function (namespaceId, element, context) {\n        if (!isElementNode(element)) {\n            this._onRemovalComplete(element, context);\n            return;\n        }\n        var /** @type {?} */ ns = namespaceId ? this._fetchNamespace(namespaceId) : null;\n        if (ns) {\n            ns.removeNode(element, context);\n        }\n        else {\n            this.markElementAsRemoved(namespaceId, element, false, context);\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?=} hasAnimation\n     * @param {?=} context\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.markElementAsRemoved = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?=} hasAnimation\n     * @param {?=} context\n     * @return {?}\n     */\n    function (namespaceId, element, hasAnimation, context) {\n        this.collectedLeaveElements.push(element);\n        element[REMOVAL_FLAG] = {\n            namespaceId: namespaceId,\n            setForRemoval: context, hasAnimation: hasAnimation,\n            removedBeforeQueried: false\n        };\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} name\n     * @param {?} phase\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.listen = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} name\n     * @param {?} phase\n     * @param {?} callback\n     * @return {?}\n     */\n    function (namespaceId, element, name, phase, callback) {\n        if (isElementNode(element)) {\n            return this._fetchNamespace(namespaceId).listen(element, name, phase, callback);\n        }\n        return function () { };\n    };\n    /**\n     * @param {?} entry\n     * @param {?} subTimelines\n     * @param {?} enterClassName\n     * @param {?} leaveClassName\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._buildInstruction = /**\n     * @param {?} entry\n     * @param {?} subTimelines\n     * @param {?} enterClassName\n     * @param {?} leaveClassName\n     * @return {?}\n     */\n    function (entry, subTimelines, enterClassName, leaveClassName) {\n        return entry.transition.build(this.driver, entry.element, entry.fromState.value, entry.toState.value, enterClassName, leaveClassName, entry.fromState.options, entry.toState.options, subTimelines);\n    };\n    /**\n     * @param {?} containerElement\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.destroyInnerAnimations = /**\n     * @param {?} containerElement\n     * @return {?}\n     */\n    function (containerElement) {\n        var _this = this;\n        var /** @type {?} */ elements = this.driver.query(containerElement, NG_TRIGGER_SELECTOR, true);\n        elements.forEach(function (element) { return _this.destroyActiveAnimationsForElement(element); });\n        if (this.playersByQueriedElement.size == 0)\n            return;\n        elements = this.driver.query(containerElement, NG_ANIMATING_SELECTOR, true);\n        elements.forEach(function (element) { return _this.finishActiveQueriedAnimationOnElement(element); });\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.destroyActiveAnimationsForElement = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        var /** @type {?} */ players = this.playersByElement.get(element);\n        if (players) {\n            players.forEach(function (player) {\n                // special case for when an element is set for destruction, but hasn't started.\n                // in this situation we want to delay the destruction until the flush occurs\n                // so that any event listeners attached to the player are triggered.\n                if (player.queued) {\n                    player.markedForDestroy = true;\n                }\n                else {\n                    player.destroy();\n                }\n            });\n        }\n        var /** @type {?} */ stateMap = this.statesByElement.get(element);\n        if (stateMap) {\n            Object.keys(stateMap).forEach(function (triggerName) { return stateMap[triggerName] = DELETED_STATE_VALUE; });\n        }\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.finishActiveQueriedAnimationOnElement = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        var /** @type {?} */ players = this.playersByQueriedElement.get(element);\n        if (players) {\n            players.forEach(function (player) { return player.finish(); });\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.whenRenderingDone = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        return new Promise(function (resolve) {\n            if (_this.players.length) {\n                return optimizeGroupPlayer(_this.players).onDone(function () { return resolve(); });\n            }\n            else {\n                resolve();\n            }\n        });\n    };\n    /**\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.processLeaveNode = /**\n     * @param {?} element\n     * @return {?}\n     */\n    function (element) {\n        var _this = this;\n        var /** @type {?} */ details = /** @type {?} */ (element[REMOVAL_FLAG]);\n        if (details && details.setForRemoval) {\n            // this will prevent it from removing it twice\n            element[REMOVAL_FLAG] = NULL_REMOVAL_STATE;\n            if (details.namespaceId) {\n                this.destroyInnerAnimations(element);\n                var /** @type {?} */ ns = this._fetchNamespace(details.namespaceId);\n                if (ns) {\n                    ns.clearElementCache(element);\n                }\n            }\n            this._onRemovalComplete(element, details.setForRemoval);\n        }\n        if (this.driver.matchesElement(element, DISABLED_SELECTOR)) {\n            this.markElementAsDisabled(element, false);\n        }\n        this.driver.query(element, DISABLED_SELECTOR, true).forEach(function (node) {\n            _this.markElementAsDisabled(element, false);\n        });\n    };\n    /**\n     * @param {?=} microtaskId\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.flush = /**\n     * @param {?=} microtaskId\n     * @return {?}\n     */\n    function (microtaskId) {\n        var _this = this;\n        if (microtaskId === void 0) { microtaskId = -1; }\n        var /** @type {?} */ players = [];\n        if (this.newHostElements.size) {\n            this.newHostElements.forEach(function (ns, element) { return _this._balanceNamespaceList(ns, element); });\n            this.newHostElements.clear();\n        }\n        if (this.totalAnimations && this.collectedEnterElements.length) {\n            for (var /** @type {?} */ i = 0; i < this.collectedEnterElements.length; i++) {\n                var /** @type {?} */ elm = this.collectedEnterElements[i];\n                addClass(elm, STAR_CLASSNAME);\n            }\n        }\n        if (this._namespaceList.length &&\n            (this.totalQueuedPlayers || this.collectedLeaveElements.length)) {\n            var /** @type {?} */ cleanupFns = [];\n            try {\n                players = this._flushAnimations(cleanupFns, microtaskId);\n            }\n            finally {\n                for (var /** @type {?} */ i = 0; i < cleanupFns.length; i++) {\n                    cleanupFns[i]();\n                }\n            }\n        }\n        else {\n            for (var /** @type {?} */ i = 0; i < this.collectedLeaveElements.length; i++) {\n                var /** @type {?} */ element = this.collectedLeaveElements[i];\n                this.processLeaveNode(element);\n            }\n        }\n        this.totalQueuedPlayers = 0;\n        this.collectedEnterElements.length = 0;\n        this.collectedLeaveElements.length = 0;\n        this._flushFns.forEach(function (fn) { return fn(); });\n        this._flushFns = [];\n        if (this._whenQuietFns.length) {\n            // we move these over to a variable so that\n            // if any new callbacks are registered in another\n            // flush they do not populate the existing set\n            var /** @type {?} */ quietFns_1 = this._whenQuietFns;\n            this._whenQuietFns = [];\n            if (players.length) {\n                optimizeGroupPlayer(players).onDone(function () { quietFns_1.forEach(function (fn) { return fn(); }); });\n            }\n            else {\n                quietFns_1.forEach(function (fn) { return fn(); });\n            }\n        }\n    };\n    /**\n     * @param {?} errors\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.reportError = /**\n     * @param {?} errors\n     * @return {?}\n     */\n    function (errors) {\n        throw new Error(\"Unable to process animations due to the following failed trigger transitions\\n \" + errors.join('\\n'));\n    };\n    /**\n     * @param {?} cleanupFns\n     * @param {?} microtaskId\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._flushAnimations = /**\n     * @param {?} cleanupFns\n     * @param {?} microtaskId\n     * @return {?}\n     */\n    function (cleanupFns, microtaskId) {\n        var _this = this;\n        var /** @type {?} */ subTimelines = new ElementInstructionMap();\n        var /** @type {?} */ skippedPlayers = [];\n        var /** @type {?} */ skippedPlayersMap = new Map();\n        var /** @type {?} */ queuedInstructions = [];\n        var /** @type {?} */ queriedElements = new Map();\n        var /** @type {?} */ allPreStyleElements = new Map();\n        var /** @type {?} */ allPostStyleElements = new Map();\n        var /** @type {?} */ disabledElementsSet = new Set();\n        this.disabledNodes.forEach(function (node) {\n            disabledElementsSet.add(node);\n            var /** @type {?} */ nodesThatAreDisabled = _this.driver.query(node, QUEUED_SELECTOR, true);\n            for (var /** @type {?} */ i_1 = 0; i_1 < nodesThatAreDisabled.length; i_1++) {\n                disabledElementsSet.add(nodesThatAreDisabled[i_1]);\n            }\n        });\n        var /** @type {?} */ bodyNode = getBodyNode();\n        var /** @type {?} */ allTriggerElements = Array.from(this.statesByElement.keys());\n        var /** @type {?} */ enterNodeMap = buildRootMap(allTriggerElements, this.collectedEnterElements);\n        // this must occur before the instructions are built below such that\n        // the :enter queries match the elements (since the timeline queries\n        // are fired during instruction building).\n        var /** @type {?} */ enterNodeMapIds = new Map();\n        var /** @type {?} */ i = 0;\n        enterNodeMap.forEach(function (nodes, root) {\n            var /** @type {?} */ className = ENTER_CLASSNAME + i++;\n            enterNodeMapIds.set(root, className);\n            nodes.forEach(function (node) { return addClass(node, className); });\n        });\n        var /** @type {?} */ allLeaveNodes = [];\n        var /** @type {?} */ mergedLeaveNodes = new Set();\n        var /** @type {?} */ leaveNodesWithoutAnimations = new Set();\n        for (var /** @type {?} */ i_2 = 0; i_2 < this.collectedLeaveElements.length; i_2++) {\n            var /** @type {?} */ element = this.collectedLeaveElements[i_2];\n            var /** @type {?} */ details = /** @type {?} */ (element[REMOVAL_FLAG]);\n            if (details && details.setForRemoval) {\n                allLeaveNodes.push(element);\n                mergedLeaveNodes.add(element);\n                if (details.hasAnimation) {\n                    this.driver.query(element, STAR_SELECTOR, true).forEach(function (elm) { return mergedLeaveNodes.add(elm); });\n                }\n                else {\n                    leaveNodesWithoutAnimations.add(element);\n                }\n            }\n        }\n        var /** @type {?} */ leaveNodeMapIds = new Map();\n        var /** @type {?} */ leaveNodeMap = buildRootMap(allTriggerElements, Array.from(mergedLeaveNodes));\n        leaveNodeMap.forEach(function (nodes, root) {\n            var /** @type {?} */ className = LEAVE_CLASSNAME + i++;\n            leaveNodeMapIds.set(root, className);\n            nodes.forEach(function (node) { return addClass(node, className); });\n        });\n        cleanupFns.push(function () {\n            enterNodeMap.forEach(function (nodes, root) {\n                var /** @type {?} */ className = /** @type {?} */ ((enterNodeMapIds.get(root)));\n                nodes.forEach(function (node) { return removeClass(node, className); });\n            });\n            leaveNodeMap.forEach(function (nodes, root) {\n                var /** @type {?} */ className = /** @type {?} */ ((leaveNodeMapIds.get(root)));\n                nodes.forEach(function (node) { return removeClass(node, className); });\n            });\n            allLeaveNodes.forEach(function (element) { _this.processLeaveNode(element); });\n        });\n        var /** @type {?} */ allPlayers = [];\n        var /** @type {?} */ erroneousTransitions = [];\n        for (var /** @type {?} */ i_3 = this._namespaceList.length - 1; i_3 >= 0; i_3--) {\n            var /** @type {?} */ ns = this._namespaceList[i_3];\n            ns.drainQueuedTransitions(microtaskId).forEach(function (entry) {\n                var /** @type {?} */ player = entry.player;\n                allPlayers.push(player);\n                var /** @type {?} */ element = entry.element;\n                if (!bodyNode || !_this.driver.containsElement(bodyNode, element)) {\n                    player.destroy();\n                    return;\n                }\n                var /** @type {?} */ leaveClassName = /** @type {?} */ ((leaveNodeMapIds.get(element)));\n                var /** @type {?} */ enterClassName = /** @type {?} */ ((enterNodeMapIds.get(element)));\n                var /** @type {?} */ instruction = /** @type {?} */ ((_this._buildInstruction(entry, subTimelines, enterClassName, leaveClassName)));\n                if (instruction.errors && instruction.errors.length) {\n                    erroneousTransitions.push(instruction);\n                    return;\n                }\n                // if a unmatched transition is queued to go then it SHOULD NOT render\n                // an animation and cancel the previously running animations.\n                if (entry.isFallbackTransition) {\n                    player.onStart(function () { return eraseStyles(element, instruction.fromStyles); });\n                    player.onDestroy(function () { return setStyles(element, instruction.toStyles); });\n                    skippedPlayers.push(player);\n                    return;\n                }\n                // this means that if a parent animation uses this animation as a sub trigger\n                // then it will instruct the timeline builder to not add a player delay, but\n                // instead stretch the first keyframe gap up until the animation starts. The\n                // reason this is important is to prevent extra initialization styles from being\n                // required by the user in the animation.\n                instruction.timelines.forEach(function (tl) { return tl.stretchStartingKeyframe = true; });\n                subTimelines.append(element, instruction.timelines);\n                var /** @type {?} */ tuple = { instruction: instruction, player: player, element: element };\n                queuedInstructions.push(tuple);\n                instruction.queriedElements.forEach(function (element) { return getOrSetAsInMap(queriedElements, element, []).push(player); });\n                instruction.preStyleProps.forEach(function (stringMap, element) {\n                    var /** @type {?} */ props = Object.keys(stringMap);\n                    if (props.length) {\n                        var /** @type {?} */ setVal_1 = /** @type {?} */ ((allPreStyleElements.get(element)));\n                        if (!setVal_1) {\n                            allPreStyleElements.set(element, setVal_1 = new Set());\n                        }\n                        props.forEach(function (prop) { return setVal_1.add(prop); });\n                    }\n                });\n                instruction.postStyleProps.forEach(function (stringMap, element) {\n                    var /** @type {?} */ props = Object.keys(stringMap);\n                    var /** @type {?} */ setVal = /** @type {?} */ ((allPostStyleElements.get(element)));\n                    if (!setVal) {\n                        allPostStyleElements.set(element, setVal = new Set());\n                    }\n                    props.forEach(function (prop) { return setVal.add(prop); });\n                });\n            });\n        }\n        if (erroneousTransitions.length) {\n            var /** @type {?} */ errors_1 = [];\n            erroneousTransitions.forEach(function (instruction) {\n                errors_1.push(\"@\" + instruction.triggerName + \" has failed due to:\\n\"); /** @type {?} */\n                ((instruction.errors)).forEach(function (error) { return errors_1.push(\"- \" + error + \"\\n\"); });\n            });\n            allPlayers.forEach(function (player) { return player.destroy(); });\n            this.reportError(errors_1);\n        }\n        var /** @type {?} */ allPreviousPlayersMap = new Map();\n        // this map works to tell which element in the DOM tree is contained by\n        // which animation. Further down below this map will get populated once\n        // the players are built and in doing so it can efficiently figure out\n        // if a sub player is skipped due to a parent player having priority.\n        var /** @type {?} */ animationElementMap = new Map();\n        queuedInstructions.forEach(function (entry) {\n            var /** @type {?} */ element = entry.element;\n            if (subTimelines.has(element)) {\n                animationElementMap.set(element, element);\n                _this._beforeAnimationBuild(entry.player.namespaceId, entry.instruction, allPreviousPlayersMap);\n            }\n        });\n        skippedPlayers.forEach(function (player) {\n            var /** @type {?} */ element = player.element;\n            var /** @type {?} */ previousPlayers = _this._getPreviousPlayers(element, false, player.namespaceId, player.triggerName, null);\n            previousPlayers.forEach(function (prevPlayer) {\n                getOrSetAsInMap(allPreviousPlayersMap, element, []).push(prevPlayer);\n                prevPlayer.destroy();\n            });\n        });\n        // this is a special case for nodes that will be removed (either by)\n        // having their own leave animations or by being queried in a container\n        // that will be removed once a parent animation is complete. The idea\n        // here is that * styles must be identical to ! styles because of\n        // backwards compatibility (* is also filled in by default in many places).\n        // Otherwise * styles will return an empty value or auto since the element\n        // that is being getComputedStyle'd will not be visible (since * = destination)\n        var /** @type {?} */ replaceNodes = allLeaveNodes.filter(function (node) {\n            return replacePostStylesAsPre(node, allPreStyleElements, allPostStyleElements);\n        });\n        // POST STAGE: fill the * styles\n        var /** @type {?} */ postStylesMap = new Map();\n        var /** @type {?} */ allLeaveQueriedNodes = cloakAndComputeStyles(postStylesMap, this.driver, leaveNodesWithoutAnimations, allPostStyleElements, _angular_animations.AUTO_STYLE);\n        allLeaveQueriedNodes.forEach(function (node) {\n            if (replacePostStylesAsPre(node, allPreStyleElements, allPostStyleElements)) {\n                replaceNodes.push(node);\n            }\n        });\n        // PRE STAGE: fill the ! styles\n        var /** @type {?} */ preStylesMap = new Map();\n        enterNodeMap.forEach(function (nodes, root) {\n            cloakAndComputeStyles(preStylesMap, _this.driver, new Set(nodes), allPreStyleElements, _angular_animations.ɵPRE_STYLE);\n        });\n        replaceNodes.forEach(function (node) {\n            var /** @type {?} */ post = postStylesMap.get(node);\n            var /** @type {?} */ pre = preStylesMap.get(node);\n            postStylesMap.set(node, /** @type {?} */ (__assign({}, post, pre)));\n        });\n        var /** @type {?} */ rootPlayers = [];\n        var /** @type {?} */ subPlayers = [];\n        var /** @type {?} */ NO_PARENT_ANIMATION_ELEMENT_DETECTED = {};\n        queuedInstructions.forEach(function (entry) {\n            var element = entry.element, player = entry.player, instruction = entry.instruction;\n            // this means that it was never consumed by a parent animation which\n            // means that it is independent and therefore should be set for animation\n            if (subTimelines.has(element)) {\n                if (disabledElementsSet.has(element)) {\n                    player.onDestroy(function () { return setStyles(element, instruction.toStyles); });\n                    player.disabled = true;\n                    player.overrideTotalTime(instruction.totalTime);\n                    skippedPlayers.push(player);\n                    return;\n                }\n                // this will flow up the DOM and query the map to figure out\n                // if a parent animation has priority over it. In the situation\n                // that a parent is detected then it will cancel the loop. If\n                // nothing is detected, or it takes a few hops to find a parent,\n                // then it will fill in the missing nodes and signal them as having\n                // a detected parent (or a NO_PARENT value via a special constant).\n                var /** @type {?} */ parentWithAnimation_1 = NO_PARENT_ANIMATION_ELEMENT_DETECTED;\n                if (animationElementMap.size > 1) {\n                    var /** @type {?} */ elm = element;\n                    var /** @type {?} */ parentsToAdd = [];\n                    while (elm = elm.parentNode) {\n                        var /** @type {?} */ detectedParent = animationElementMap.get(elm);\n                        if (detectedParent) {\n                            parentWithAnimation_1 = detectedParent;\n                            break;\n                        }\n                        parentsToAdd.push(elm);\n                    }\n                    parentsToAdd.forEach(function (parent) { return animationElementMap.set(parent, parentWithAnimation_1); });\n                }\n                var /** @type {?} */ innerPlayer = _this._buildAnimation(player.namespaceId, instruction, allPreviousPlayersMap, skippedPlayersMap, preStylesMap, postStylesMap);\n                player.setRealPlayer(innerPlayer);\n                if (parentWithAnimation_1 === NO_PARENT_ANIMATION_ELEMENT_DETECTED) {\n                    rootPlayers.push(player);\n                }\n                else {\n                    var /** @type {?} */ parentPlayers = _this.playersByElement.get(parentWithAnimation_1);\n                    if (parentPlayers && parentPlayers.length) {\n                        player.parentPlayer = optimizeGroupPlayer(parentPlayers);\n                    }\n                    skippedPlayers.push(player);\n                }\n            }\n            else {\n                eraseStyles(element, instruction.fromStyles);\n                player.onDestroy(function () { return setStyles(element, instruction.toStyles); });\n                // there still might be a ancestor player animating this\n                // element therefore we will still add it as a sub player\n                // even if its animation may be disabled\n                subPlayers.push(player);\n                if (disabledElementsSet.has(element)) {\n                    skippedPlayers.push(player);\n                }\n            }\n        });\n        // find all of the sub players' corresponding inner animation player\n        subPlayers.forEach(function (player) {\n            // even if any players are not found for a sub animation then it\n            // will still complete itself after the next tick since it's Noop\n            var /** @type {?} */ playersForElement = skippedPlayersMap.get(player.element);\n            if (playersForElement && playersForElement.length) {\n                var /** @type {?} */ innerPlayer = optimizeGroupPlayer(playersForElement);\n                player.setRealPlayer(innerPlayer);\n            }\n        });\n        // the reason why we don't actually play the animation is\n        // because all that a skipped player is designed to do is to\n        // fire the start/done transition callback events\n        skippedPlayers.forEach(function (player) {\n            if (player.parentPlayer) {\n                player.syncPlayerEvents(player.parentPlayer);\n            }\n            else {\n                player.destroy();\n            }\n        });\n        // run through all of the queued removals and see if they\n        // were picked up by a query. If not then perform the removal\n        // operation right away unless a parent animation is ongoing.\n        for (var /** @type {?} */ i_4 = 0; i_4 < allLeaveNodes.length; i_4++) {\n            var /** @type {?} */ element = allLeaveNodes[i_4];\n            var /** @type {?} */ details = /** @type {?} */ (element[REMOVAL_FLAG]);\n            removeClass(element, LEAVE_CLASSNAME);\n            // this means the element has a removal animation that is being\n            // taken care of and therefore the inner elements will hang around\n            // until that animation is over (or the parent queried animation)\n            if (details && details.hasAnimation)\n                continue;\n            var /** @type {?} */ players = [];\n            // if this element is queried or if it contains queried children\n            // then we want for the element not to be removed from the page\n            // until the queried animations have finished\n            if (queriedElements.size) {\n                var /** @type {?} */ queriedPlayerResults = queriedElements.get(element);\n                if (queriedPlayerResults && queriedPlayerResults.length) {\n                    players.push.apply(players, queriedPlayerResults);\n                }\n                var /** @type {?} */ queriedInnerElements = this.driver.query(element, NG_ANIMATING_SELECTOR, true);\n                for (var /** @type {?} */ j = 0; j < queriedInnerElements.length; j++) {\n                    var /** @type {?} */ queriedPlayers = queriedElements.get(queriedInnerElements[j]);\n                    if (queriedPlayers && queriedPlayers.length) {\n                        players.push.apply(players, queriedPlayers);\n                    }\n                }\n            }\n            var /** @type {?} */ activePlayers = players.filter(function (p) { return !p.destroyed; });\n            if (activePlayers.length) {\n                removeNodesAfterAnimationDone(this, element, activePlayers);\n            }\n            else {\n                this.processLeaveNode(element);\n            }\n        }\n        // this is required so the cleanup method doesn't remove them\n        allLeaveNodes.length = 0;\n        rootPlayers.forEach(function (player) {\n            _this.players.push(player);\n            player.onDone(function () {\n                player.destroy();\n                var /** @type {?} */ index = _this.players.indexOf(player);\n                _this.players.splice(index, 1);\n            });\n            player.play();\n        });\n        return rootPlayers;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.elementContainsData = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @return {?}\n     */\n    function (namespaceId, element) {\n        var /** @type {?} */ containsData = false;\n        var /** @type {?} */ details = /** @type {?} */ (element[REMOVAL_FLAG]);\n        if (details && details.setForRemoval)\n            containsData = true;\n        if (this.playersByElement.has(element))\n            containsData = true;\n        if (this.playersByQueriedElement.has(element))\n            containsData = true;\n        if (this.statesByElement.has(element))\n            containsData = true;\n        return this._fetchNamespace(namespaceId).elementContainsData(element) || containsData;\n    };\n    /**\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.afterFlush = /**\n     * @param {?} callback\n     * @return {?}\n     */\n    function (callback) { this._flushFns.push(callback); };\n    /**\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype.afterFlushAnimationsDone = /**\n     * @param {?} callback\n     * @return {?}\n     */\n    function (callback) { this._whenQuietFns.push(callback); };\n    /**\n     * @param {?} element\n     * @param {?} isQueriedElement\n     * @param {?=} namespaceId\n     * @param {?=} triggerName\n     * @param {?=} toStateValue\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._getPreviousPlayers = /**\n     * @param {?} element\n     * @param {?} isQueriedElement\n     * @param {?=} namespaceId\n     * @param {?=} triggerName\n     * @param {?=} toStateValue\n     * @return {?}\n     */\n    function (element, isQueriedElement, namespaceId, triggerName, toStateValue) {\n        var /** @type {?} */ players = [];\n        if (isQueriedElement) {\n            var /** @type {?} */ queriedElementPlayers = this.playersByQueriedElement.get(element);\n            if (queriedElementPlayers) {\n                players = queriedElementPlayers;\n            }\n        }\n        else {\n            var /** @type {?} */ elementPlayers = this.playersByElement.get(element);\n            if (elementPlayers) {\n                var /** @type {?} */ isRemovalAnimation_1 = !toStateValue || toStateValue == VOID_VALUE;\n                elementPlayers.forEach(function (player) {\n                    if (player.queued)\n                        return;\n                    if (!isRemovalAnimation_1 && player.triggerName != triggerName)\n                        return;\n                    players.push(player);\n                });\n            }\n        }\n        if (namespaceId || triggerName) {\n            players = players.filter(function (player) {\n                if (namespaceId && namespaceId != player.namespaceId)\n                    return false;\n                if (triggerName && triggerName != player.triggerName)\n                    return false;\n                return true;\n            });\n        }\n        return players;\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} instruction\n     * @param {?} allPreviousPlayersMap\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._beforeAnimationBuild = /**\n     * @param {?} namespaceId\n     * @param {?} instruction\n     * @param {?} allPreviousPlayersMap\n     * @return {?}\n     */\n    function (namespaceId, instruction, allPreviousPlayersMap) {\n        var /** @type {?} */ triggerName = instruction.triggerName;\n        var /** @type {?} */ rootElement = instruction.element;\n        // when a removal animation occurs, ALL previous players are collected\n        // and destroyed (even if they are outside of the current namespace)\n        var /** @type {?} */ targetNameSpaceId = instruction.isRemovalTransition ? undefined : namespaceId;\n        var /** @type {?} */ targetTriggerName = instruction.isRemovalTransition ? undefined : triggerName;\n        var _loop_1 = function (timelineInstruction) {\n            var /** @type {?} */ element = timelineInstruction.element;\n            var /** @type {?} */ isQueriedElement = element !== rootElement;\n            var /** @type {?} */ players = getOrSetAsInMap(allPreviousPlayersMap, element, []);\n            var /** @type {?} */ previousPlayers = this_1._getPreviousPlayers(element, isQueriedElement, targetNameSpaceId, targetTriggerName, instruction.toState);\n            previousPlayers.forEach(function (player) {\n                var /** @type {?} */ realPlayer = /** @type {?} */ (player.getRealPlayer());\n                if (realPlayer.beforeDestroy) {\n                    realPlayer.beforeDestroy();\n                }\n                player.destroy();\n                players.push(player);\n            });\n        };\n        var this_1 = this;\n        for (var _i = 0, _a = instruction.timelines; _i < _a.length; _i++) {\n            var timelineInstruction = _a[_i];\n            _loop_1(timelineInstruction);\n        }\n        // this needs to be done so that the PRE/POST styles can be\n        // computed properly without interfering with the previous animation\n        eraseStyles(rootElement, instruction.fromStyles);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} instruction\n     * @param {?} allPreviousPlayersMap\n     * @param {?} skippedPlayersMap\n     * @param {?} preStylesMap\n     * @param {?} postStylesMap\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._buildAnimation = /**\n     * @param {?} namespaceId\n     * @param {?} instruction\n     * @param {?} allPreviousPlayersMap\n     * @param {?} skippedPlayersMap\n     * @param {?} preStylesMap\n     * @param {?} postStylesMap\n     * @return {?}\n     */\n    function (namespaceId, instruction, allPreviousPlayersMap, skippedPlayersMap, preStylesMap, postStylesMap) {\n        var _this = this;\n        var /** @type {?} */ triggerName = instruction.triggerName;\n        var /** @type {?} */ rootElement = instruction.element;\n        // we first run this so that the previous animation player\n        // data can be passed into the successive animation players\n        var /** @type {?} */ allQueriedPlayers = [];\n        var /** @type {?} */ allConsumedElements = new Set();\n        var /** @type {?} */ allSubElements = new Set();\n        var /** @type {?} */ allNewPlayers = instruction.timelines.map(function (timelineInstruction) {\n            var /** @type {?} */ element = timelineInstruction.element;\n            allConsumedElements.add(element);\n            // FIXME (matsko): make sure to-be-removed animations are removed properly\n            var /** @type {?} */ details = element[REMOVAL_FLAG];\n            if (details && details.removedBeforeQueried)\n                return new _angular_animations.NoopAnimationPlayer(timelineInstruction.duration, timelineInstruction.delay);\n            var /** @type {?} */ isQueriedElement = element !== rootElement;\n            var /** @type {?} */ previousPlayers = flattenGroupPlayers((allPreviousPlayersMap.get(element) || EMPTY_PLAYER_ARRAY)\n                .map(function (p) { return p.getRealPlayer(); }))\n                .filter(function (p) {\n                // the `element` is not apart of the AnimationPlayer definition, but\n                // Mock/WebAnimations\n                // use the element within their implementation. This will be added in Angular5 to\n                // AnimationPlayer\n                var /** @type {?} */ pp = /** @type {?} */ (p);\n                return pp.element ? pp.element === element : false;\n            });\n            var /** @type {?} */ preStyles = preStylesMap.get(element);\n            var /** @type {?} */ postStyles = postStylesMap.get(element);\n            var /** @type {?} */ keyframes = normalizeKeyframes(_this.driver, _this._normalizer, element, timelineInstruction.keyframes, preStyles, postStyles);\n            var /** @type {?} */ player = _this._buildPlayer(timelineInstruction, keyframes, previousPlayers);\n            // this means that this particular player belongs to a sub trigger. It is\n            // important that we match this player up with the corresponding (@trigger.listener)\n            if (timelineInstruction.subTimeline && skippedPlayersMap) {\n                allSubElements.add(element);\n            }\n            if (isQueriedElement) {\n                var /** @type {?} */ wrappedPlayer = new TransitionAnimationPlayer(namespaceId, triggerName, element);\n                wrappedPlayer.setRealPlayer(player);\n                allQueriedPlayers.push(wrappedPlayer);\n            }\n            return player;\n        });\n        allQueriedPlayers.forEach(function (player) {\n            getOrSetAsInMap(_this.playersByQueriedElement, player.element, []).push(player);\n            player.onDone(function () { return deleteOrUnsetInMap(_this.playersByQueriedElement, player.element, player); });\n        });\n        allConsumedElements.forEach(function (element) { return addClass(element, NG_ANIMATING_CLASSNAME); });\n        var /** @type {?} */ player = optimizeGroupPlayer(allNewPlayers);\n        player.onDestroy(function () {\n            allConsumedElements.forEach(function (element) { return removeClass(element, NG_ANIMATING_CLASSNAME); });\n            setStyles(rootElement, instruction.toStyles);\n        });\n        // this basically makes all of the callbacks for sub element animations\n        // be dependent on the upper players for when they finish\n        allSubElements.forEach(function (element) { getOrSetAsInMap(skippedPlayersMap, element, []).push(player); });\n        return player;\n    };\n    /**\n     * @param {?} instruction\n     * @param {?} keyframes\n     * @param {?} previousPlayers\n     * @return {?}\n     */\n    TransitionAnimationEngine.prototype._buildPlayer = /**\n     * @param {?} instruction\n     * @param {?} keyframes\n     * @param {?} previousPlayers\n     * @return {?}\n     */\n    function (instruction, keyframes, previousPlayers) {\n        if (keyframes.length > 0) {\n            return this.driver.animate(instruction.element, keyframes, instruction.duration, instruction.delay, instruction.easing, previousPlayers);\n        }\n        // special case for when an empty transition|definition is provided\n        // ... there is no point in rendering an empty animation\n        return new _angular_animations.NoopAnimationPlayer(instruction.duration, instruction.delay);\n    };\n    return TransitionAnimationEngine;\n}());\nvar TransitionAnimationPlayer = /** @class */ (function () {\n    function TransitionAnimationPlayer(namespaceId, triggerName, element) {\n        this.namespaceId = namespaceId;\n        this.triggerName = triggerName;\n        this.element = element;\n        this._player = new _angular_animations.NoopAnimationPlayer();\n        this._containsRealPlayer = false;\n        this._queuedCallbacks = {};\n        this.destroyed = false;\n        this.markedForDestroy = false;\n        this.disabled = false;\n        this.queued = true;\n        this.totalTime = 0;\n    }\n    /**\n     * @param {?} player\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.setRealPlayer = /**\n     * @param {?} player\n     * @return {?}\n     */\n    function (player) {\n        var _this = this;\n        if (this._containsRealPlayer)\n            return;\n        this._player = player;\n        Object.keys(this._queuedCallbacks).forEach(function (phase) {\n            _this._queuedCallbacks[phase].forEach(function (callback) { return listenOnPlayer(player, phase, undefined, callback); });\n        });\n        this._queuedCallbacks = {};\n        this._containsRealPlayer = true;\n        this.overrideTotalTime(player.totalTime);\n        (/** @type {?} */ (this)).queued = false;\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.getRealPlayer = /**\n     * @return {?}\n     */\n    function () { return this._player; };\n    /**\n     * @param {?} totalTime\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.overrideTotalTime = /**\n     * @param {?} totalTime\n     * @return {?}\n     */\n    function (totalTime) { (/** @type {?} */ (this)).totalTime = totalTime; };\n    /**\n     * @param {?} player\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.syncPlayerEvents = /**\n     * @param {?} player\n     * @return {?}\n     */\n    function (player) {\n        var _this = this;\n        var /** @type {?} */ p = /** @type {?} */ (this._player);\n        if (p.triggerCallback) {\n            player.onStart(function () { return ((p.triggerCallback))('start'); });\n        }\n        player.onDone(function () { return _this.finish(); });\n        player.onDestroy(function () { return _this.destroy(); });\n    };\n    /**\n     * @param {?} name\n     * @param {?} callback\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype._queueEvent = /**\n     * @param {?} name\n     * @param {?} callback\n     * @return {?}\n     */\n    function (name, callback) {\n        getOrSetAsInMap(this._queuedCallbacks, name, []).push(callback);\n    };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.onDone = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) {\n        if (this.queued) {\n            this._queueEvent('done', fn);\n        }\n        this._player.onDone(fn);\n    };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.onStart = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) {\n        if (this.queued) {\n            this._queueEvent('start', fn);\n        }\n        this._player.onStart(fn);\n    };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.onDestroy = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) {\n        if (this.queued) {\n            this._queueEvent('destroy', fn);\n        }\n        this._player.onDestroy(fn);\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.init = /**\n     * @return {?}\n     */\n    function () { this._player.init(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.hasStarted = /**\n     * @return {?}\n     */\n    function () { return this.queued ? false : this._player.hasStarted(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.play = /**\n     * @return {?}\n     */\n    function () { !this.queued && this._player.play(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.pause = /**\n     * @return {?}\n     */\n    function () { !this.queued && this._player.pause(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.restart = /**\n     * @return {?}\n     */\n    function () { !this.queued && this._player.restart(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.finish = /**\n     * @return {?}\n     */\n    function () { this._player.finish(); };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.destroy = /**\n     * @return {?}\n     */\n    function () {\n        (/** @type {?} */ (this)).destroyed = true;\n        this._player.destroy();\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.reset = /**\n     * @return {?}\n     */\n    function () { !this.queued && this._player.reset(); };\n    /**\n     * @param {?} p\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.setPosition = /**\n     * @param {?} p\n     * @return {?}\n     */\n    function (p) {\n        if (!this.queued) {\n            this._player.setPosition(p);\n        }\n    };\n    /**\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.getPosition = /**\n     * @return {?}\n     */\n    function () { return this.queued ? 0 : this._player.getPosition(); };\n    /* @internal */\n    /**\n     * @param {?} phaseName\n     * @return {?}\n     */\n    TransitionAnimationPlayer.prototype.triggerCallback = /**\n     * @param {?} phaseName\n     * @return {?}\n     */\n    function (phaseName) {\n        var /** @type {?} */ p = /** @type {?} */ (this._player);\n        if (p.triggerCallback) {\n            p.triggerCallback(phaseName);\n        }\n    };\n    return TransitionAnimationPlayer;\n}());\n/**\n * @param {?} map\n * @param {?} key\n * @param {?} value\n * @return {?}\n */\nfunction deleteOrUnsetInMap(map, key, value) {\n    var /** @type {?} */ currentValues;\n    if (map instanceof Map) {\n        currentValues = map.get(key);\n        if (currentValues) {\n            if (currentValues.length) {\n                var /** @type {?} */ index = currentValues.indexOf(value);\n                currentValues.splice(index, 1);\n            }\n            if (currentValues.length == 0) {\n                map.delete(key);\n            }\n        }\n    }\n    else {\n        currentValues = map[key];\n        if (currentValues) {\n            if (currentValues.length) {\n                var /** @type {?} */ index = currentValues.indexOf(value);\n                currentValues.splice(index, 1);\n            }\n            if (currentValues.length == 0) {\n                delete map[key];\n            }\n        }\n    }\n    return currentValues;\n}\n/**\n * @param {?} value\n * @return {?}\n */\nfunction normalizeTriggerValue(value) {\n    // we use `!= null` here because it's the most simple\n    // way to test against a \"falsy\" value without mixing\n    // in empty strings or a zero value. DO NOT OPTIMIZE.\n    return value != null ? value : null;\n}\n/**\n * @param {?} node\n * @return {?}\n */\nfunction isElementNode(node) {\n    return node && node['nodeType'] === 1;\n}\n/**\n * @param {?} eventName\n * @return {?}\n */\nfunction isTriggerEventValid(eventName) {\n    return eventName == 'start' || eventName == 'done';\n}\n/**\n * @param {?} element\n * @param {?=} value\n * @return {?}\n */\nfunction cloakElement(element, value) {\n    var /** @type {?} */ oldValue = element.style.display;\n    element.style.display = value != null ? value : 'none';\n    return oldValue;\n}\n/**\n * @param {?} valuesMap\n * @param {?} driver\n * @param {?} elements\n * @param {?} elementPropsMap\n * @param {?} defaultStyle\n * @return {?}\n */\nfunction cloakAndComputeStyles(valuesMap, driver, elements, elementPropsMap, defaultStyle) {\n    var /** @type {?} */ cloakVals = [];\n    elements.forEach(function (element) { return cloakVals.push(cloakElement(element)); });\n    var /** @type {?} */ failedElements = [];\n    elementPropsMap.forEach(function (props, element) {\n        var /** @type {?} */ styles = {};\n        props.forEach(function (prop) {\n            var /** @type {?} */ value = styles[prop] = driver.computeStyle(element, prop, defaultStyle);\n            // there is no easy way to detect this because a sub element could be removed\n            // by a parent animation element being detached.\n            if (!value || value.length == 0) {\n                element[REMOVAL_FLAG] = NULL_REMOVED_QUERIED_STATE;\n                failedElements.push(element);\n            }\n        });\n        valuesMap.set(element, styles);\n    });\n    // we use a index variable here since Set.forEach(a, i) does not return\n    // an index value for the closure (but instead just the value)\n    var /** @type {?} */ i = 0;\n    elements.forEach(function (element) { return cloakElement(element, cloakVals[i++]); });\n    return failedElements;\n}\n/**\n * @param {?} roots\n * @param {?} nodes\n * @return {?}\n */\nfunction buildRootMap(roots, nodes) {\n    var /** @type {?} */ rootMap = new Map();\n    roots.forEach(function (root) { return rootMap.set(root, []); });\n    if (nodes.length == 0)\n        return rootMap;\n    var /** @type {?} */ NULL_NODE = 1;\n    var /** @type {?} */ nodeSet = new Set(nodes);\n    var /** @type {?} */ localRootMap = new Map();\n    /**\n     * @param {?} node\n     * @return {?}\n     */\n    function getRoot(node) {\n        if (!node)\n            return NULL_NODE;\n        var /** @type {?} */ root = localRootMap.get(node);\n        if (root)\n            return root;\n        var /** @type {?} */ parent = node.parentNode;\n        if (rootMap.has(parent)) {\n            // ngIf inside @trigger\n            root = parent;\n        }\n        else if (nodeSet.has(parent)) {\n            // ngIf inside ngIf\n            root = NULL_NODE;\n        }\n        else {\n            // recurse upwards\n            root = getRoot(parent);\n        }\n        localRootMap.set(node, root);\n        return root;\n    }\n    nodes.forEach(function (node) {\n        var /** @type {?} */ root = getRoot(node);\n        if (root !== NULL_NODE) {\n            /** @type {?} */ ((rootMap.get(root))).push(node);\n        }\n    });\n    return rootMap;\n}\nvar CLASSES_CACHE_KEY = '$$classes';\n/**\n * @param {?} element\n * @param {?} className\n * @return {?}\n */\nfunction addClass(element, className) {\n    if (element.classList) {\n        element.classList.add(className);\n    }\n    else {\n        var /** @type {?} */ classes = element[CLASSES_CACHE_KEY];\n        if (!classes) {\n            classes = element[CLASSES_CACHE_KEY] = {};\n        }\n        classes[className] = true;\n    }\n}\n/**\n * @param {?} element\n * @param {?} className\n * @return {?}\n */\nfunction removeClass(element, className) {\n    if (element.classList) {\n        element.classList.remove(className);\n    }\n    else {\n        var /** @type {?} */ classes = element[CLASSES_CACHE_KEY];\n        if (classes) {\n            delete classes[className];\n        }\n    }\n}\n/**\n * @param {?} engine\n * @param {?} element\n * @param {?} players\n * @return {?}\n */\nfunction removeNodesAfterAnimationDone(engine, element, players) {\n    optimizeGroupPlayer(players).onDone(function () { return engine.processLeaveNode(element); });\n}\n/**\n * @param {?} players\n * @return {?}\n */\nfunction flattenGroupPlayers(players) {\n    var /** @type {?} */ finalPlayers = [];\n    _flattenGroupPlayersRecur(players, finalPlayers);\n    return finalPlayers;\n}\n/**\n * @param {?} players\n * @param {?} finalPlayers\n * @return {?}\n */\nfunction _flattenGroupPlayersRecur(players, finalPlayers) {\n    for (var /** @type {?} */ i = 0; i < players.length; i++) {\n        var /** @type {?} */ player = players[i];\n        if (player instanceof _angular_animations.ɵAnimationGroupPlayer) {\n            _flattenGroupPlayersRecur(player.players, finalPlayers);\n        }\n        else {\n            finalPlayers.push(/** @type {?} */ (player));\n        }\n    }\n}\n/**\n * @param {?} a\n * @param {?} b\n * @return {?}\n */\nfunction objEquals(a, b) {\n    var /** @type {?} */ k1 = Object.keys(a);\n    var /** @type {?} */ k2 = Object.keys(b);\n    if (k1.length != k2.length)\n        return false;\n    for (var /** @type {?} */ i = 0; i < k1.length; i++) {\n        var /** @type {?} */ prop = k1[i];\n        if (!b.hasOwnProperty(prop) || a[prop] !== b[prop])\n            return false;\n    }\n    return true;\n}\n/**\n * @param {?} element\n * @param {?} allPreStyleElements\n * @param {?} allPostStyleElements\n * @return {?}\n */\nfunction replacePostStylesAsPre(element, allPreStyleElements, allPostStyleElements) {\n    var /** @type {?} */ postEntry = allPostStyleElements.get(element);\n    if (!postEntry)\n        return false;\n    var /** @type {?} */ preEntry = allPreStyleElements.get(element);\n    if (preEntry) {\n        postEntry.forEach(function (data) { return ((preEntry)).add(data); });\n    }\n    else {\n        allPreStyleElements.set(element, postEntry);\n    }\n    allPostStyleElements.delete(element);\n    return true;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar AnimationEngine = /** @class */ (function () {\n    function AnimationEngine(_driver, normalizer) {\n        var _this = this;\n        this._driver = _driver;\n        this._triggerCache = {};\n        this.onRemovalComplete = function (element, context) { };\n        this._transitionEngine = new TransitionAnimationEngine(_driver, normalizer);\n        this._timelineEngine = new TimelineAnimationEngine(_driver, normalizer);\n        this._transitionEngine.onRemovalComplete = function (element, context) {\n            return _this.onRemovalComplete(element, context);\n        };\n    }\n    /**\n     * @param {?} componentId\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @param {?} name\n     * @param {?} metadata\n     * @return {?}\n     */\n    AnimationEngine.prototype.registerTrigger = /**\n     * @param {?} componentId\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @param {?} name\n     * @param {?} metadata\n     * @return {?}\n     */\n    function (componentId, namespaceId, hostElement, name, metadata) {\n        var /** @type {?} */ cacheKey = componentId + '-' + name;\n        var /** @type {?} */ trigger = this._triggerCache[cacheKey];\n        if (!trigger) {\n            var /** @type {?} */ errors = [];\n            var /** @type {?} */ ast = /** @type {?} */ (buildAnimationAst(this._driver, /** @type {?} */ (metadata), errors));\n            if (errors.length) {\n                throw new Error(\"The animation trigger \\\"\" + name + \"\\\" has failed to build due to the following errors:\\n - \" + errors.join(\"\\n - \"));\n            }\n            trigger = buildTrigger(name, ast);\n            this._triggerCache[cacheKey] = trigger;\n        }\n        this._transitionEngine.registerTrigger(namespaceId, name, trigger);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    AnimationEngine.prototype.register = /**\n     * @param {?} namespaceId\n     * @param {?} hostElement\n     * @return {?}\n     */\n    function (namespaceId, hostElement) {\n        this._transitionEngine.register(namespaceId, hostElement);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationEngine.prototype.destroy = /**\n     * @param {?} namespaceId\n     * @param {?} context\n     * @return {?}\n     */\n    function (namespaceId, context) {\n        this._transitionEngine.destroy(namespaceId, context);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} parent\n     * @param {?} insertBefore\n     * @return {?}\n     */\n    AnimationEngine.prototype.onInsert = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} parent\n     * @param {?} insertBefore\n     * @return {?}\n     */\n    function (namespaceId, element, parent, insertBefore) {\n        this._transitionEngine.insertNode(namespaceId, element, parent, insertBefore);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    AnimationEngine.prototype.onRemove = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} context\n     * @return {?}\n     */\n    function (namespaceId, element, context) {\n        this._transitionEngine.removeNode(namespaceId, element, context);\n    };\n    /**\n     * @param {?} element\n     * @param {?} disable\n     * @return {?}\n     */\n    AnimationEngine.prototype.disableAnimations = /**\n     * @param {?} element\n     * @param {?} disable\n     * @return {?}\n     */\n    function (element, disable) {\n        this._transitionEngine.markElementAsDisabled(element, disable);\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} property\n     * @param {?} value\n     * @return {?}\n     */\n    AnimationEngine.prototype.process = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} property\n     * @param {?} value\n     * @return {?}\n     */\n    function (namespaceId, element, property, value) {\n        if (property.charAt(0) == '@') {\n            var _a = parseTimelineCommand(property), id = _a[0], action = _a[1];\n            var /** @type {?} */ args = /** @type {?} */ (value);\n            this._timelineEngine.command(id, element, action, args);\n        }\n        else {\n            this._transitionEngine.trigger(namespaceId, element, property, value);\n        }\n    };\n    /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} eventName\n     * @param {?} eventPhase\n     * @param {?} callback\n     * @return {?}\n     */\n    AnimationEngine.prototype.listen = /**\n     * @param {?} namespaceId\n     * @param {?} element\n     * @param {?} eventName\n     * @param {?} eventPhase\n     * @param {?} callback\n     * @return {?}\n     */\n    function (namespaceId, element, eventName, eventPhase, callback) {\n        // @@listen\n        if (eventName.charAt(0) == '@') {\n            var _a = parseTimelineCommand(eventName), id = _a[0], action = _a[1];\n            return this._timelineEngine.listen(id, element, action, callback);\n        }\n        return this._transitionEngine.listen(namespaceId, element, eventName, eventPhase, callback);\n    };\n    /**\n     * @param {?=} microtaskId\n     * @return {?}\n     */\n    AnimationEngine.prototype.flush = /**\n     * @param {?=} microtaskId\n     * @return {?}\n     */\n    function (microtaskId) {\n        if (microtaskId === void 0) { microtaskId = -1; }\n        this._transitionEngine.flush(microtaskId);\n    };\n    Object.defineProperty(AnimationEngine.prototype, \"players\", {\n        get: /**\n         * @return {?}\n         */\n        function () {\n            return (/** @type {?} */ (this._transitionEngine.players))\n                .concat(/** @type {?} */ (this._timelineEngine.players));\n        },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @return {?}\n     */\n    AnimationEngine.prototype.whenRenderingDone = /**\n     * @return {?}\n     */\n    function () { return this._transitionEngine.whenRenderingDone(); };\n    return AnimationEngine;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\n/**\n * @license\n * Copyright Google Inc. All Rights Reserved.\n *\n * Use of this source code is governed by an MIT-style license that can be\n * found in the LICENSE file at https://angular.io/license\n */\nvar ELAPSED_TIME_MAX_DECIMAL_PLACES = 3;\nvar ANIMATION_PROP = 'animation';\nvar ANIMATIONEND_EVENT = 'animationend';\nvar ONE_SECOND$1 = 1000;\nvar ElementAnimationStyleHandler = /** @class */ (function () {\n    function ElementAnimationStyleHandler(_element, _name, _duration, _delay, _easing, _fillMode, _onDoneFn) {\n        var _this = this;\n        this._element = _element;\n        this._name = _name;\n        this._duration = _duration;\n        this._delay = _delay;\n        this._easing = _easing;\n        this._fillMode = _fillMode;\n        this._onDoneFn = _onDoneFn;\n        this._finished = false;\n        this._destroyed = false;\n        this._startTime = 0;\n        this._position = 0;\n        this._eventFn = function (e) { return _this._handleCallback(e); };\n    }\n    /**\n     * @return {?}\n     */\n    ElementAnimationStyleHandler.prototype.apply = /**\n     * @return {?}\n     */\n    function () {\n        applyKeyframeAnimation(this._element, this._duration + \"ms \" + this._easing + \" \" + this._delay + \"ms 1 normal \" + this._fillMode + \" \" + this._name);\n        addRemoveAnimationEvent(this._element, this._eventFn, false);\n        this._startTime = Date.now();\n    };\n    /**\n     * @return {?}\n     */\n    ElementAnimationStyleHandler.prototype.pause = /**\n     * @return {?}\n     */\n    function () { playPauseAnimation(this._element, this._name, 'paused'); };\n    /**\n     * @return {?}\n     */\n    ElementAnimationStyleHandler.prototype.resume = /**\n     * @return {?}\n     */\n    function () { playPauseAnimation(this._element, this._name, 'running'); };\n    /**\n     * @param {?} position\n     * @return {?}\n     */\n    ElementAnimationStyleHandler.prototype.setPosition = /**\n     * @param {?} position\n     * @return {?}\n     */\n    function (position) {\n        var /** @type {?} */ index = findIndexForAnimation(this._element, this._name);\n        this._position = position * this._duration;\n        setAnimationStyle(this._element, 'Delay', \"-\" + this._position + \"ms\", index);\n    };\n    /**\n     * @return {?}\n     */\n    ElementAnimationStyleHandler.prototype.getPosition = /**\n     * @return {?}\n     */\n    function () { return this._position; };\n    /**\n     * @param {?} event\n     * @return {?}\n     */\n    ElementAnimationStyleHandler.prototype._handleCallback = /**\n     * @param {?} event\n     * @return {?}\n     */\n    function (event) {\n        var /** @type {?} */ timestamp = event._ngTestManualTimestamp || Date.now();\n        var /** @type {?} */ elapsedTime = parseFloat(event.elapsedTime.toFixed(ELAPSED_TIME_MAX_DECIMAL_PLACES)) * ONE_SECOND$1;\n        if (event.animationName == this._name &&\n            Math.max(timestamp - this._startTime, 0) >= this._delay && elapsedTime >= this._duration) {\n            this.finish();\n        }\n    };\n    /**\n     * @return {?}\n     */\n    ElementAnimationStyleHandler.prototype.finish = /**\n     * @return {?}\n     */\n    function () {\n        if (this._finished)\n            return;\n        this._finished = true;\n        this._onDoneFn();\n        addRemoveAnimationEvent(this._element, this._eventFn, true);\n    };\n    /**\n     * @return {?}\n     */\n    ElementAnimationStyleHandler.prototype.destroy = /**\n     * @return {?}\n     */\n    function () {\n        if (this._destroyed)\n            return;\n        this._destroyed = true;\n        this.finish();\n        removeKeyframeAnimation(this._element, this._name);\n    };\n    return ElementAnimationStyleHandler;\n}());\n/**\n * @param {?} element\n * @param {?} name\n * @param {?} status\n * @return {?}\n */\nfunction playPauseAnimation(element, name, status) {\n    var /** @type {?} */ index = findIndexForAnimation(element, name);\n    setAnimationStyle(element, 'PlayState', status, index);\n}\n/**\n * @param {?} element\n * @param {?} value\n * @return {?}\n */\nfunction applyKeyframeAnimation(element, value) {\n    var /** @type {?} */ anim = getAnimationStyle(element, '').trim();\n    var /** @type {?} */ index = 0;\n    if (anim.length) {\n        index = countChars(anim, ',') + 1;\n        value = anim + \", \" + value;\n    }\n    setAnimationStyle(element, '', value);\n    return index;\n}\n/**\n * @param {?} element\n * @param {?} name\n * @return {?}\n */\nfunction removeKeyframeAnimation(element, name) {\n    var /** @type {?} */ anim = getAnimationStyle(element, '');\n    var /** @type {?} */ tokens = anim.split(',');\n    var /** @type {?} */ index = findMatchingTokenIndex(tokens, name);\n    if (index >= 0) {\n        tokens.splice(index, 1);\n        var /** @type {?} */ newValue = tokens.join(',');\n        setAnimationStyle(element, '', newValue);\n    }\n}\n/**\n * @param {?} element\n * @param {?} value\n * @return {?}\n */\nfunction findIndexForAnimation(element, value) {\n    var /** @type {?} */ anim = getAnimationStyle(element, '');\n    if (anim.indexOf(',') > 0) {\n        var /** @type {?} */ tokens = anim.split(',');\n        return findMatchingTokenIndex(tokens, value);\n    }\n    return findMatchingTokenIndex([anim], value);\n}\n/**\n * @param {?} tokens\n * @param {?} searchToken\n * @return {?}\n */\nfunction findMatchingTokenIndex(tokens, searchToken) {\n    for (var /** @type {?} */ i = 0; i < tokens.length; i++) {\n        if (tokens[i].indexOf(searchToken) >= 0) {\n            return i;\n        }\n    }\n    return -1;\n}\n/**\n * @param {?} element\n * @param {?} fn\n * @param {?} doRemove\n * @return {?}\n */\nfunction addRemoveAnimationEvent(element, fn, doRemove) {\n    doRemove ? element.removeEventListener(ANIMATIONEND_EVENT, fn) :\n        element.addEventListener(ANIMATIONEND_EVENT, fn);\n}\n/**\n * @param {?} element\n * @param {?} name\n * @param {?} value\n * @param {?=} index\n * @return {?}\n */\nfunction setAnimationStyle(element, name, value, index) {\n    var /** @type {?} */ prop = ANIMATION_PROP + name;\n    if (index != null) {\n        var /** @type {?} */ oldValue = element.style[prop];\n        if (oldValue.length) {\n            var /** @type {?} */ tokens = oldValue.split(',');\n            tokens[index] = value;\n            value = tokens.join(',');\n        }\n    }\n    element.style[prop] = value;\n}\n/**\n * @param {?} element\n * @param {?} name\n * @return {?}\n */\nfunction getAnimationStyle(element, name) {\n    return element.style[ANIMATION_PROP + name];\n}\n/**\n * @param {?} value\n * @param {?} char\n * @return {?}\n */\nfunction countChars(value, char) {\n    var /** @type {?} */ count = 0;\n    for (var /** @type {?} */ i = 0; i < value.length; i++) {\n        var /** @type {?} */ c = value.charAt(i);\n        if (c === char)\n            count++;\n    }\n    return count;\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar DEFAULT_FILL_MODE = 'forwards';\nvar DEFAULT_EASING = 'linear';\n/** @enum {number} */\nvar AnimatorControlState = {\n    INITIALIZED: 1,\n    STARTED: 2,\n    FINISHED: 3,\n    DESTROYED: 4,\n};\nAnimatorControlState[AnimatorControlState.INITIALIZED] = \"INITIALIZED\";\nAnimatorControlState[AnimatorControlState.STARTED] = \"STARTED\";\nAnimatorControlState[AnimatorControlState.FINISHED] = \"FINISHED\";\nAnimatorControlState[AnimatorControlState.DESTROYED] = \"DESTROYED\";\nvar CssKeyframesPlayer = /** @class */ (function () {\n    function CssKeyframesPlayer(element, keyframes, animationName, _duration, _delay, easing, _finalStyles) {\n        this.element = element;\n        this.keyframes = keyframes;\n        this.animationName = animationName;\n        this._duration = _duration;\n        this._delay = _delay;\n        this._finalStyles = _finalStyles;\n        this._onDoneFns = [];\n        this._onStartFns = [];\n        this._onDestroyFns = [];\n        this._started = false;\n        this.currentSnapshot = {};\n        this.state = 0;\n        this.easing = easing || DEFAULT_EASING;\n        this.totalTime = _duration + _delay;\n        this._buildStyler();\n    }\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.onStart = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) { this._onStartFns.push(fn); };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.onDone = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) { this._onDoneFns.push(fn); };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.onDestroy = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) { this._onDestroyFns.push(fn); };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.destroy = /**\n     * @return {?}\n     */\n    function () {\n        this.init();\n        if (this.state >= AnimatorControlState.DESTROYED)\n            return;\n        this.state = AnimatorControlState.DESTROYED;\n        this._styler.destroy();\n        this._flushStartFns();\n        this._flushDoneFns();\n        this._onDestroyFns.forEach(function (fn) { return fn(); });\n        this._onDestroyFns = [];\n    };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype._flushDoneFns = /**\n     * @return {?}\n     */\n    function () {\n        this._onDoneFns.forEach(function (fn) { return fn(); });\n        this._onDoneFns = [];\n    };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype._flushStartFns = /**\n     * @return {?}\n     */\n    function () {\n        this._onStartFns.forEach(function (fn) { return fn(); });\n        this._onStartFns = [];\n    };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.finish = /**\n     * @return {?}\n     */\n    function () {\n        this.init();\n        if (this.state >= AnimatorControlState.FINISHED)\n            return;\n        this.state = AnimatorControlState.FINISHED;\n        this._styler.finish();\n        this._flushStartFns();\n        this._flushDoneFns();\n    };\n    /**\n     * @param {?} value\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.setPosition = /**\n     * @param {?} value\n     * @return {?}\n     */\n    function (value) { this._styler.setPosition(value); };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.getPosition = /**\n     * @return {?}\n     */\n    function () { return this._styler.getPosition(); };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.hasStarted = /**\n     * @return {?}\n     */\n    function () { return this.state >= AnimatorControlState.STARTED; };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.init = /**\n     * @return {?}\n     */\n    function () {\n        if (this.state >= AnimatorControlState.INITIALIZED)\n            return;\n        this.state = AnimatorControlState.INITIALIZED;\n        var /** @type {?} */ elm = this.element;\n        this._styler.apply();\n        if (this._delay) {\n            this._styler.pause();\n        }\n    };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.play = /**\n     * @return {?}\n     */\n    function () {\n        this.init();\n        if (!this.hasStarted()) {\n            this._flushStartFns();\n            this.state = AnimatorControlState.STARTED;\n        }\n        this._styler.resume();\n    };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.pause = /**\n     * @return {?}\n     */\n    function () {\n        this.init();\n        this._styler.pause();\n    };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.restart = /**\n     * @return {?}\n     */\n    function () {\n        this.reset();\n        this.play();\n    };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.reset = /**\n     * @return {?}\n     */\n    function () {\n        this._styler.destroy();\n        this._buildStyler();\n        this._styler.apply();\n    };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype._buildStyler = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        this._styler = new ElementAnimationStyleHandler(this.element, this.animationName, this._duration, this._delay, this.easing, DEFAULT_FILL_MODE, function () { return _this.finish(); });\n    };\n    /* @internal */\n    /**\n     * @param {?} phaseName\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.triggerCallback = /**\n     * @param {?} phaseName\n     * @return {?}\n     */\n    function (phaseName) {\n        var /** @type {?} */ methods = phaseName == 'start' ? this._onStartFns : this._onDoneFns;\n        methods.forEach(function (fn) { return fn(); });\n        methods.length = 0;\n    };\n    /**\n     * @return {?}\n     */\n    CssKeyframesPlayer.prototype.beforeDestroy = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        this.init();\n        var /** @type {?} */ styles = {};\n        if (this.hasStarted()) {\n            var /** @type {?} */ finished_1 = this.state >= AnimatorControlState.FINISHED;\n            Object.keys(this._finalStyles).forEach(function (prop) {\n                if (prop != 'offset') {\n                    styles[prop] = finished_1 ? _this._finalStyles[prop] : computeStyle(_this.element, prop);\n                }\n            });\n        }\n        this.currentSnapshot = styles;\n    };\n    return CssKeyframesPlayer;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar DirectStylePlayer = /** @class */ (function (_super) {\n    __extends(DirectStylePlayer, _super);\n    function DirectStylePlayer(element, _styles) {\n        var _this = _super.call(this) || this;\n        _this.element = element;\n        _this._styles = _styles;\n        _this._startingStyles = {};\n        _this.__initialized = false;\n        return _this;\n    }\n    /**\n     * @return {?}\n     */\n    DirectStylePlayer.prototype.init = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        if (this.__initialized || !this._startingStyles)\n            return;\n        this.__initialized = true;\n        Object.keys(this._styles).forEach(function (prop) {\n            /** @type {?} */ ((_this._startingStyles))[prop] = _this.element.style[prop];\n        });\n        _super.prototype.init.call(this);\n    };\n    /**\n     * @return {?}\n     */\n    DirectStylePlayer.prototype.play = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        if (!this._startingStyles)\n            return;\n        this.init();\n        Object.keys(this._styles).forEach(function (prop) { _this.element.style[prop] = _this._styles[prop]; });\n        _super.prototype.play.call(this);\n    };\n    /**\n     * @return {?}\n     */\n    DirectStylePlayer.prototype.destroy = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        if (!this._startingStyles)\n            return;\n        Object.keys(this._startingStyles).forEach(function (prop) {\n            var /** @type {?} */ value = /** @type {?} */ ((_this._startingStyles))[prop];\n            if (value) {\n                _this.element.style[prop] = value;\n            }\n            else {\n                _this.element.style.removeProperty(prop);\n            }\n        });\n        this._startingStyles = null;\n        _super.prototype.destroy.call(this);\n    };\n    return DirectStylePlayer;\n}(_angular_animations.NoopAnimationPlayer));\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar KEYFRAMES_NAME_PREFIX = 'gen_css_kf_';\nvar TAB_SPACE = ' ';\nvar CssKeyframesDriver = /** @class */ (function () {\n    function CssKeyframesDriver() {\n        this._count = 0;\n        this._head = document.querySelector('head');\n        this._warningIssued = false;\n    }\n    /**\n     * @param {?} prop\n     * @return {?}\n     */\n    CssKeyframesDriver.prototype.validateStyleProperty = /**\n     * @param {?} prop\n     * @return {?}\n     */\n    function (prop) { return validateStyleProperty(prop); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    CssKeyframesDriver.prototype.matchesElement = /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    function (element, selector) {\n        return matchesElement(element, selector);\n    };\n    /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    CssKeyframesDriver.prototype.containsElement = /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    function (elm1, elm2) { return containsElement(elm1, elm2); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    CssKeyframesDriver.prototype.query = /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    function (element, selector, multi) {\n        return invokeQuery(element, selector, multi);\n    };\n    /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    CssKeyframesDriver.prototype.computeStyle = /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    function (element, prop, defaultValue) {\n        return /** @type {?} */ ((/** @type {?} */ (window.getComputedStyle(element)))[prop]);\n    };\n    /**\n     * @param {?} element\n     * @param {?} name\n     * @param {?} keyframes\n     * @return {?}\n     */\n    CssKeyframesDriver.prototype.buildKeyframeElement = /**\n     * @param {?} element\n     * @param {?} name\n     * @param {?} keyframes\n     * @return {?}\n     */\n    function (element, name, keyframes) {\n        keyframes = keyframes.map(function (kf) { return hypenatePropsObject(kf); });\n        var /** @type {?} */ keyframeStr = \"@keyframes \" + name + \" {\\n\";\n        var /** @type {?} */ tab = '';\n        keyframes.forEach(function (kf) {\n            tab = TAB_SPACE;\n            var /** @type {?} */ offset = parseFloat(kf[\"offset\"]);\n            keyframeStr += \"\" + tab + offset * 100 + \"% {\\n\";\n            tab += TAB_SPACE;\n            Object.keys(kf).forEach(function (prop) {\n                var /** @type {?} */ value = kf[prop];\n                switch (prop) {\n                    case 'offset':\n                        return;\n                    case 'easing':\n                        if (value) {\n                            keyframeStr += tab + \"animation-timing-function: \" + value + \";\\n\";\n                        }\n                        return;\n                    default:\n                        keyframeStr += \"\" + tab + prop + \": \" + value + \";\\n\";\n                        return;\n                }\n            });\n            keyframeStr += tab + \"}\\n\";\n        });\n        keyframeStr += \"}\\n\";\n        var /** @type {?} */ kfElm = document.createElement('style');\n        kfElm.innerHTML = keyframeStr;\n        return kfElm;\n    };\n    /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @param {?=} scrubberAccessRequested\n     * @return {?}\n     */\n    CssKeyframesDriver.prototype.animate = /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @param {?=} scrubberAccessRequested\n     * @return {?}\n     */\n    function (element, keyframes, duration, delay, easing, previousPlayers, scrubberAccessRequested) {\n        if (previousPlayers === void 0) { previousPlayers = []; }\n        if (scrubberAccessRequested) {\n            this._notifyFaultyScrubber();\n        }\n        var /** @type {?} */ previousCssKeyframePlayers = /** @type {?} */ (previousPlayers.filter(function (player) { return player instanceof CssKeyframesPlayer; }));\n        var /** @type {?} */ previousStyles = {};\n        if (allowPreviousPlayerStylesMerge(duration, delay)) {\n            previousCssKeyframePlayers.forEach(function (player) {\n                var /** @type {?} */ styles = player.currentSnapshot;\n                Object.keys(styles).forEach(function (prop) { return previousStyles[prop] = styles[prop]; });\n            });\n        }\n        keyframes = balancePreviousStylesIntoKeyframes(element, keyframes, previousStyles);\n        var /** @type {?} */ finalStyles = flattenKeyframesIntoStyles(keyframes);\n        // if there is no animation then there is no point in applying\n        // styles and waiting for an event to get fired. This causes lag.\n        // It's better to just directly apply the styles to the element\n        // via the direct styling animation player.\n        if (duration == 0) {\n            return new DirectStylePlayer(element, finalStyles);\n        }\n        var /** @type {?} */ animationName = \"\" + KEYFRAMES_NAME_PREFIX + this._count++;\n        var /** @type {?} */ kfElm = this.buildKeyframeElement(element, animationName, keyframes); /** @type {?} */\n        ((document.querySelector('head'))).appendChild(kfElm);\n        var /** @type {?} */ player = new CssKeyframesPlayer(element, keyframes, animationName, duration, delay, easing, finalStyles);\n        player.onDestroy(function () { return removeElement(kfElm); });\n        return player;\n    };\n    /**\n     * @return {?}\n     */\n    CssKeyframesDriver.prototype._notifyFaultyScrubber = /**\n     * @return {?}\n     */\n    function () {\n        if (!this._warningIssued) {\n            console.warn('@angular/animations: please load the web-animations.js polyfill to allow programmatic access...\\n', '  visit http://bit.ly/IWukam to learn more about using the web-animation-js polyfill.');\n            this._warningIssued = true;\n        }\n    };\n    return CssKeyframesDriver;\n}());\n/**\n * @param {?} keyframes\n * @return {?}\n */\nfunction flattenKeyframesIntoStyles(keyframes) {\n    var /** @type {?} */ flatKeyframes = {};\n    if (keyframes) {\n        var /** @type {?} */ kfs = Array.isArray(keyframes) ? keyframes : [keyframes];\n        kfs.forEach(function (kf) {\n            Object.keys(kf).forEach(function (prop) {\n                if (prop == 'offset' || prop == 'easing')\n                    return;\n                flatKeyframes[prop] = kf[prop];\n            });\n        });\n    }\n    return flatKeyframes;\n}\n/**\n * @param {?} object\n * @return {?}\n */\nfunction hypenatePropsObject(object) {\n    var /** @type {?} */ newObj = {};\n    Object.keys(object).forEach(function (prop) {\n        var /** @type {?} */ newProp = prop.replace(/([a-z])([A-Z])/g, '$1-$2');\n        newObj[newProp] = object[prop];\n    });\n    return newObj;\n}\n/**\n * @param {?} node\n * @return {?}\n */\nfunction removeElement(node) {\n    node.parentNode.removeChild(node);\n}\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar WebAnimationsPlayer = /** @class */ (function () {\n    function WebAnimationsPlayer(element, keyframes, options) {\n        this.element = element;\n        this.keyframes = keyframes;\n        this.options = options;\n        this._onDoneFns = [];\n        this._onStartFns = [];\n        this._onDestroyFns = [];\n        this._initialized = false;\n        this._finished = false;\n        this._started = false;\n        this._destroyed = false;\n        this.time = 0;\n        this.parentPlayer = null;\n        this.currentSnapshot = {};\n        this._duration = /** @type {?} */ (options['duration']);\n        this._delay = /** @type {?} */ (options['delay']) || 0;\n        this.time = this._duration + this._delay;\n    }\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._onFinish = /**\n     * @return {?}\n     */\n    function () {\n        if (!this._finished) {\n            this._finished = true;\n            this._onDoneFns.forEach(function (fn) { return fn(); });\n            this._onDoneFns = [];\n        }\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.init = /**\n     * @return {?}\n     */\n    function () {\n        this._buildPlayer();\n        this._preparePlayerBeforeStart();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._buildPlayer = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        if (this._initialized)\n            return;\n        this._initialized = true;\n        var /** @type {?} */ keyframes = this.keyframes;\n        (/** @type {?} */ (this)).domPlayer =\n            this._triggerWebAnimation(this.element, keyframes, this.options);\n        this._finalKeyframe = keyframes.length ? keyframes[keyframes.length - 1] : {};\n        this.domPlayer.addEventListener('finish', function () { return _this._onFinish(); });\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._preparePlayerBeforeStart = /**\n     * @return {?}\n     */\n    function () {\n        // this is required so that the player doesn't start to animate right away\n        if (this._delay) {\n            this._resetDomPlayerState();\n        }\n        else {\n            this.domPlayer.pause();\n        }\n    };\n    /** @internal */\n    /**\n     * \\@internal\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} options\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._triggerWebAnimation = /**\n     * \\@internal\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} options\n     * @return {?}\n     */\n    function (element, keyframes, options) {\n        // jscompiler doesn't seem to know animate is a native property because it's not fully\n        // supported yet across common browsers (we polyfill it for Edge/Safari) [CL #143630929]\n        return /** @type {?} */ (element['animate'](keyframes, options));\n    };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.onStart = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) { this._onStartFns.push(fn); };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.onDone = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) { this._onDoneFns.push(fn); };\n    /**\n     * @param {?} fn\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.onDestroy = /**\n     * @param {?} fn\n     * @return {?}\n     */\n    function (fn) { this._onDestroyFns.push(fn); };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.play = /**\n     * @return {?}\n     */\n    function () {\n        this._buildPlayer();\n        if (!this.hasStarted()) {\n            this._onStartFns.forEach(function (fn) { return fn(); });\n            this._onStartFns = [];\n            this._started = true;\n        }\n        this.domPlayer.play();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.pause = /**\n     * @return {?}\n     */\n    function () {\n        this.init();\n        this.domPlayer.pause();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.finish = /**\n     * @return {?}\n     */\n    function () {\n        this.init();\n        this._onFinish();\n        this.domPlayer.finish();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.reset = /**\n     * @return {?}\n     */\n    function () {\n        this._resetDomPlayerState();\n        this._destroyed = false;\n        this._finished = false;\n        this._started = false;\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype._resetDomPlayerState = /**\n     * @return {?}\n     */\n    function () {\n        if (this.domPlayer) {\n            this.domPlayer.cancel();\n        }\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.restart = /**\n     * @return {?}\n     */\n    function () {\n        this.reset();\n        this.play();\n    };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.hasStarted = /**\n     * @return {?}\n     */\n    function () { return this._started; };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.destroy = /**\n     * @return {?}\n     */\n    function () {\n        if (!this._destroyed) {\n            this._destroyed = true;\n            this._resetDomPlayerState();\n            this._onFinish();\n            this._onDestroyFns.forEach(function (fn) { return fn(); });\n            this._onDestroyFns = [];\n        }\n    };\n    /**\n     * @param {?} p\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.setPosition = /**\n     * @param {?} p\n     * @return {?}\n     */\n    function (p) { this.domPlayer.currentTime = p * this.time; };\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.getPosition = /**\n     * @return {?}\n     */\n    function () { return this.domPlayer.currentTime / this.time; };\n    Object.defineProperty(WebAnimationsPlayer.prototype, \"totalTime\", {\n        get: /**\n         * @return {?}\n         */\n        function () { return this._delay + this._duration; },\n        enumerable: true,\n        configurable: true\n    });\n    /**\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.beforeDestroy = /**\n     * @return {?}\n     */\n    function () {\n        var _this = this;\n        var /** @type {?} */ styles = {};\n        if (this.hasStarted()) {\n            Object.keys(this._finalKeyframe).forEach(function (prop) {\n                if (prop != 'offset') {\n                    styles[prop] =\n                        _this._finished ? _this._finalKeyframe[prop] : computeStyle(_this.element, prop);\n                }\n            });\n        }\n        this.currentSnapshot = styles;\n    };\n    /* @internal */\n    /**\n     * @param {?} phaseName\n     * @return {?}\n     */\n    WebAnimationsPlayer.prototype.triggerCallback = /**\n     * @param {?} phaseName\n     * @return {?}\n     */\n    function (phaseName) {\n        var /** @type {?} */ methods = phaseName == 'start' ? this._onStartFns : this._onDoneFns;\n        methods.forEach(function (fn) { return fn(); });\n        methods.length = 0;\n    };\n    return WebAnimationsPlayer;\n}());\n\n/**\n * @fileoverview added by tsickle\n * @suppress {checkTypes} checked by tsc\n */\nvar WebAnimationsDriver = /** @class */ (function () {\n    function WebAnimationsDriver() {\n        this._isNativeImpl = /\\{\\s*\\[native\\s+code\\]\\s*\\}/.test(getElementAnimateFn().toString());\n        this._cssKeyframesDriver = new CssKeyframesDriver();\n    }\n    /**\n     * @param {?} prop\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.validateStyleProperty = /**\n     * @param {?} prop\n     * @return {?}\n     */\n    function (prop) { return validateStyleProperty(prop); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.matchesElement = /**\n     * @param {?} element\n     * @param {?} selector\n     * @return {?}\n     */\n    function (element, selector) {\n        return matchesElement(element, selector);\n    };\n    /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.containsElement = /**\n     * @param {?} elm1\n     * @param {?} elm2\n     * @return {?}\n     */\n    function (elm1, elm2) { return containsElement(elm1, elm2); };\n    /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.query = /**\n     * @param {?} element\n     * @param {?} selector\n     * @param {?} multi\n     * @return {?}\n     */\n    function (element, selector, multi) {\n        return invokeQuery(element, selector, multi);\n    };\n    /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.computeStyle = /**\n     * @param {?} element\n     * @param {?} prop\n     * @param {?=} defaultValue\n     * @return {?}\n     */\n    function (element, prop, defaultValue) {\n        return /** @type {?} */ ((/** @type {?} */ (window.getComputedStyle(element)))[prop]);\n    };\n    /**\n     * @param {?} supported\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.overrideWebAnimationsSupport = /**\n     * @param {?} supported\n     * @return {?}\n     */\n    function (supported) { this._isNativeImpl = supported; };\n    /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @param {?=} scrubberAccessRequested\n     * @return {?}\n     */\n    WebAnimationsDriver.prototype.animate = /**\n     * @param {?} element\n     * @param {?} keyframes\n     * @param {?} duration\n     * @param {?} delay\n     * @param {?} easing\n     * @param {?=} previousPlayers\n     * @param {?=} scrubberAccessRequested\n     * @return {?}\n     */\n    function (element, keyframes, duration, delay, easing, previousPlayers, scrubberAccessRequested) {\n        if (previousPlayers === void 0) { previousPlayers = []; }\n        var /** @type {?} */ useKeyframes = !scrubberAccessRequested && !this._isNativeImpl;\n        if (useKeyframes) {\n            return this._cssKeyframesDriver.animate(element, keyframes, duration, delay, easing, previousPlayers);\n        }\n        var /** @type {?} */ fill = delay == 0 ? 'both' : 'forwards';\n        var /** @type {?} */ playerOptions = { duration: duration, delay: delay, fill: fill };\n        // we check for this to avoid having a null|undefined value be present\n        // for the easing (which results in an error for certain browsers #9752)\n        if (easing) {\n            playerOptions['easing'] = easing;\n        }\n        var /** @type {?} */ previousStyles = {};\n        var /** @type {?} */ previousWebAnimationPlayers = /** @type {?} */ (previousPlayers.filter(function (player) { return player instanceof WebAnimationsPlayer; }));\n        if (allowPreviousPlayerStylesMerge(duration, delay)) {\n            previousWebAnimationPlayers.forEach(function (player) {\n                var /** @type {?} */ styles = player.currentSnapshot;\n                Object.keys(styles).forEach(function (prop) { return previousStyles[prop] = styles[prop]; });\n            });\n        }\n        keyframes = keyframes.map(function (styles) { return copyStyles(styles, false); });\n        keyframes = balancePreviousStylesIntoKeyframes(element, keyframes, previousStyles);\n        return new WebAnimationsPlayer(element, keyframes, playerOptions);\n    };\n    return WebAnimationsDriver;\n}());\n/**\n * @return {?}\n */\nfunction supportsWebAnimations() {\n    return typeof getElementAnimateFn() === 'function';\n}\n/**\n * @return {?}\n */\nfunction getElementAnimateFn() {\n    return (typeof Element !== 'undefined' && (/** @type {?} */ (Element)).prototype['animate']) || {};\n}\n\nexports.AnimationDriver = AnimationDriver;\nexports.ɵAnimation = Animation;\nexports.ɵAnimationStyleNormalizer = AnimationStyleNormalizer;\nexports.ɵNoopAnimationStyleNormalizer = NoopAnimationStyleNormalizer;\nexports.ɵWebAnimationsStyleNormalizer = WebAnimationsStyleNormalizer;\nexports.ɵAnimationDriver = AnimationDriver;\nexports.ɵNoopAnimationDriver = NoopAnimationDriver;\nexports.ɵAnimationEngine = AnimationEngine;\nexports.ɵCssKeyframesDriver = CssKeyframesDriver;\nexports.ɵCssKeyframesPlayer = CssKeyframesPlayer;\nexports.ɵcontainsElement = containsElement;\nexports.ɵinvokeQuery = invokeQuery;\nexports.ɵmatchesElement = matchesElement;\nexports.ɵvalidateStyleProperty = validateStyleProperty;\nexports.ɵWebAnimationsDriver = WebAnimationsDriver;\nexports.ɵsupportsWebAnimations = supportsWebAnimations;\nexports.ɵWebAnimationsPlayer = WebAnimationsPlayer;\nexports.ɵallowPreviousPlayerStylesMerge = allowPreviousPlayerStylesMerge;\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n})));\n//# sourceMappingURL=animations-browser.umd.js.map\n"]}